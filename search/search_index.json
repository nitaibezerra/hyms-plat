{"config":{"lang":["pt"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Portal de Hin\u00e1rios do Santo Daime","text":"<p>Bem-vindo \u00e0 documenta\u00e7\u00e3o do Portal de Hin\u00e1rios do Santo Daime, uma plataforma para pesquisa, visualiza\u00e7\u00e3o e compartilhamento de hin\u00e1rios do Santo Daime.</p>"},{"location":"#o-que-e-o-portal","title":"O que \u00e9 o Portal?","text":"<p>O Portal de Hin\u00e1rios \u00e9 uma aplica\u00e7\u00e3o web que permite:</p> <ul> <li> Buscar hinos por t\u00edtulo, letra ou hin\u00e1rio</li> <li> Navegar hin\u00e1rios completos com todos os hinos</li> <li> Visualizar letras formatadas e completas</li> <li> Criar conta e contribuir com conte\u00fado</li> <li> Ouvir \u00e1udios de hinos (em desenvolvimento)</li> <li> Favoritar seus hinos preferidos</li> </ul>"},{"location":"#documentacao","title":"Documenta\u00e7\u00e3o","text":""},{"location":"#para-usuarios","title":"Para Usu\u00e1rios","text":"<p>Se voc\u00ea quer usar o portal para buscar e visualizar hinos:</p> <ul> <li> <p> Primeiros Passos</p> <p>Aprenda a navegar pela interface do portal</p> <p> Come\u00e7ar</p> </li> <li> <p> Buscar Hinos</p> <p>Aprenda a buscar eficientemente por hinos</p> <p> Como buscar</p> </li> <li> <p> Navegar Hin\u00e1rios</p> <p>Explore hin\u00e1rios completos</p> <p> Ver hin\u00e1rios</p> </li> <li> <p> FAQ</p> <p>Perguntas frequentes</p> <p> Ver FAQ</p> </li> </ul>"},{"location":"#para-desenvolvedores","title":"Para Desenvolvedores","text":"<p>Se voc\u00ea quer contribuir com c\u00f3digo ou entender a arquitetura:</p> <ul> <li> <p> Setup Local</p> <p>Configure seu ambiente de desenvolvimento</p> <p> Setup</p> </li> <li> <p> Arquitetura</p> <p>Entenda a estrutura do sistema</p> <p> Arquitetura</p> </li> <li> <p> Contribuindo</p> <p>Como contribuir com o projeto</p> <p> Contribuir</p> </li> <li> <p> Testes</p> <p>Estrat\u00e9gia de testes do projeto</p> <p> Testes</p> </li> </ul>"},{"location":"#status-do-projeto","title":"Status do Projeto","text":"Fase Descri\u00e7\u00e3o Status Fase 0 Setup inicial  Completa Fase 1 MVP Read-Only  Completa Fase 2 Upload &amp; Users  Completa Fase 3 \u00c1udio &amp; Social  Completa Fase 4 Deploy &amp; Prod  Em andamento"},{"location":"#links-rapidos","title":"Links R\u00e1pidos","text":"<ul> <li>GitHub Repository</li> <li>Reportar Bug</li> <li>Changelog</li> <li>Roadmap</li> </ul>"},{"location":"about/","title":"Sobre o Projeto","text":""},{"location":"about/#o-que-e-o-portal-de-hinarios","title":"O que \u00e9 o Portal de Hin\u00e1rios?","text":"<p>O Portal de Hin\u00e1rios do Santo Daime \u00e9 uma plataforma web dedicada \u00e0 preserva\u00e7\u00e3o e compartilhamento dos hin\u00e1rios do Santo Daime, uma tradi\u00e7\u00e3o religiosa brasileira.</p>"},{"location":"about/#missao","title":"Miss\u00e3o","text":"<p>Preservar e tornar acess\u00edvel o rico patrim\u00f4nio musical e espiritual do Santo Daime, facilitando o acesso \u00e0s letras dos hinos para praticantes e pesquisadores.</p>"},{"location":"about/#caracteristicas-principais","title":"Caracter\u00edsticas Principais","text":""},{"location":"about/#busca-inteligente","title":"Busca Inteligente","text":"<p>O portal utiliza TypeSense, um motor de busca moderno que oferece:</p> <ul> <li>Toler\u00e2ncia a erros de digita\u00e7\u00e3o - Encontra resultados mesmo com pequenos erros</li> <li>Busca instant\u00e2nea - Resultados em milissegundos</li> <li>Relev\u00e2ncia - Resultados ordenados por relev\u00e2ncia</li> </ul>"},{"location":"about/#navegacao-intuitiva","title":"Navega\u00e7\u00e3o Intuitiva","text":"<ul> <li>Interface limpa e organizada</li> <li>Navega\u00e7\u00e3o por hin\u00e1rios completos</li> <li>Visualiza\u00e7\u00e3o formatada das letras</li> </ul>"},{"location":"about/#contribuicao-comunitaria","title":"Contribui\u00e7\u00e3o Comunit\u00e1ria","text":"<ul> <li>Upload de hin\u00e1rios em formato YAML</li> <li>Valida\u00e7\u00e3o autom\u00e1tica de duplicatas</li> <li>Sistema de modera\u00e7\u00e3o</li> </ul>"},{"location":"about/#stack-tecnologico","title":"Stack Tecnol\u00f3gico","text":"<p>O projeto \u00e9 desenvolvido com tecnologias modernas e robustas:</p> Componente Tecnologia Backend Django 5.1 + Python 3.11+ CMS Wagtail 6.4 Banco de Dados PostgreSQL 16 Busca TypeSense 27.1 Task Queue Celery + Redis Testes pytest (290+ testes)"},{"location":"about/#codigo-aberto","title":"C\u00f3digo Aberto","text":"<p>Este projeto \u00e9 c\u00f3digo aberto e aceita contribui\u00e7\u00f5es da comunidade. Veja nosso guia de contribui\u00e7\u00e3o.</p>"},{"location":"about/#contato","title":"Contato","text":"<ul> <li>GitHub: hyms-plat</li> <li>Issues: Reportar problema</li> </ul>"},{"location":"about/#licenca","title":"Licen\u00e7a","text":"<p>Este projeto est\u00e1 licenciado sob os termos da licen\u00e7a MIT.</p>"},{"location":"changelog/","title":"Changelog","text":"<p>Todas as mudan\u00e7as not\u00e1veis neste projeto ser\u00e3o documentadas neste arquivo.</p> <p>O formato \u00e9 baseado em Keep a Changelog.</p>"},{"location":"changelog/#unreleased","title":"[Unreleased]","text":""},{"location":"changelog/#adicionado","title":"Adicionado","text":"<ul> <li>Documenta\u00e7\u00e3o completa com MkDocs</li> <li>Guia do usu\u00e1rio em portugu\u00eas</li> <li>Guia do desenvolvedor</li> </ul>"},{"location":"changelog/#030-2026-01-11","title":"[0.3.0] - 2026-01-11","text":""},{"location":"changelog/#adicionado_1","title":"Adicionado","text":"<ul> <li>Testes E2E com Playwright</li> <li>15 testes de navega\u00e7\u00e3o, autentica\u00e7\u00e3o, upload e features sociais</li> <li>CI/CD atualizado para rodar testes E2E</li> <li>Features Sociais (Fase 3)</li> <li>Sistema de favoritos para hinos</li> <li>Coment\u00e1rios em hinos</li> <li>Seguir outros usu\u00e1rios</li> <li>Feed de notifica\u00e7\u00f5es</li> <li>Perfil de usu\u00e1rio p\u00fablico</li> </ul>"},{"location":"changelog/#corrigido","title":"Corrigido","text":"<ul> <li>Bug no upload de YAML sem <code>hymn_book:</code> como raiz</li> <li>Valida\u00e7\u00e3o defensiva em fun\u00e7\u00f5es de desambigua\u00e7\u00e3o</li> </ul>"},{"location":"changelog/#020-2026-01-10","title":"[0.2.0] - 2026-01-10","text":""},{"location":"changelog/#adicionado_2","title":"Adicionado","text":"<ul> <li>Upload de Hin\u00e1rios (Fase 2)</li> <li>Upload de arquivos YAML</li> <li>Valida\u00e7\u00e3o e preview antes de salvar</li> <li>Sistema de desambigua\u00e7\u00e3o de duplicatas</li> <li>Versionamento de hin\u00e1rios (HymnBookVersion)</li> <li>Autentica\u00e7\u00e3o Completa</li> <li>Login com email/senha</li> <li>Login social com Google</li> <li>Recupera\u00e7\u00e3o de senha</li> <li>Perfil de usu\u00e1rio edit\u00e1vel</li> </ul>"},{"location":"changelog/#melhorado","title":"Melhorado","text":"<ul> <li>Cobertura de testes para 83%+</li> <li>Documenta\u00e7\u00e3o inline do c\u00f3digo</li> </ul>"},{"location":"changelog/#010-2026-01-08","title":"[0.1.0] - 2026-01-08","text":""},{"location":"changelog/#adicionado_3","title":"Adicionado","text":"<ul> <li>MVP Read-Only (Fase 1)</li> <li>Models HymnBook e Hymn</li> <li>Importa\u00e7\u00e3o de hin\u00e1rios via YAML (<code>import_yaml</code>)</li> <li>Indexa\u00e7\u00e3o no TypeSense</li> <li>P\u00e1gina inicial com estat\u00edsticas</li> <li>Lista de hin\u00e1rios com pagina\u00e7\u00e3o</li> <li>Detalhes do hin\u00e1rio com lista de hinos</li> <li>P\u00e1gina do hino com letra completa</li> <li>Busca full-text com TypeSense</li> <li>Infraestrutura (Fase 0)</li> <li>Projeto Django 5.1 com Poetry</li> <li>Wagtail CMS 6.4</li> <li>PostgreSQL 16 via Docker</li> <li>Redis 7 via Docker</li> <li>TypeSense 27.1 via Docker</li> <li>django-allauth configurado</li> <li>CI/CD com GitHub Actions</li> <li>98%+ de cobertura de testes</li> </ul>"},{"location":"changelog/#links","title":"Links","text":"<ul> <li>Reposit\u00f3rio GitHub</li> <li>Issues</li> </ul>"},{"location":"roadmap/","title":"Roadmap","text":"<p>Este documento descreve as fases de desenvolvimento do Portal de Hin\u00e1rios.</p>"},{"location":"roadmap/#fases-concluidas","title":"Fases Conclu\u00eddas","text":""},{"location":"roadmap/#fase-0-setup-inicial","title":"Fase 0: Setup Inicial","text":"<p>Objetivo: Configurar infraestrutura base do projeto.</p> <ul> <li>[x] Estrutura Django com Poetry</li> <li>[x] Configura\u00e7\u00e3o PostgreSQL e Redis via Docker</li> <li>[x] Configura\u00e7\u00e3o TypeSense</li> <li>[x] Wagtail CMS</li> <li>[x] django-allauth para autentica\u00e7\u00e3o</li> <li>[x] CI/CD com GitHub Actions</li> </ul>"},{"location":"roadmap/#fase-1-mvp-read-only","title":"Fase 1: MVP Read-Only","text":"<p>Objetivo: Vers\u00e3o inicial apenas leitura.</p> <ul> <li>[x] Models HymnBook e Hymn</li> <li>[x] Import de hin\u00e1rios via YAML</li> <li>[x] Indexa\u00e7\u00e3o no TypeSense</li> <li>[x] P\u00e1gina inicial com estat\u00edsticas</li> <li>[x] Lista de hin\u00e1rios com pagina\u00e7\u00e3o</li> <li>[x] Detalhes do hin\u00e1rio com lista de hinos</li> <li>[x] P\u00e1gina do hino com letra completa</li> <li>[x] Busca full-text</li> <li>[x] Testes unit\u00e1rios (95%+ coverage)</li> </ul>"},{"location":"roadmap/#fase-2-upload-users","title":"Fase 2: Upload &amp; Users","text":"<p>Objetivo: Permitir contribui\u00e7\u00e3o de usu\u00e1rios.</p> <ul> <li>[x] Autentica\u00e7\u00e3o com email/senha e OAuth (Google)</li> <li>[x] Upload de hin\u00e1rios via YAML</li> <li>[x] Valida\u00e7\u00e3o e preview antes de salvar</li> <li>[x] Sistema de desambigua\u00e7\u00e3o de duplicatas</li> <li>[x] Versionamento de hin\u00e1rios</li> <li>[x] Perfil de usu\u00e1rio com hist\u00f3rico</li> </ul>"},{"location":"roadmap/#fase-3-audio-social","title":"Fase 3: \u00c1udio &amp; Social","text":"<p>Objetivo: Features sociais e multim\u00eddia.</p> <ul> <li>[x] Favoritar hinos</li> <li>[x] Coment\u00e1rios em hinos</li> <li>[x] Seguir outros usu\u00e1rios</li> <li>[x] Feed de notifica\u00e7\u00f5es</li> <li>[x] Placeholders para player de \u00e1udio</li> <li>[x] Testes E2E com Playwright</li> </ul>"},{"location":"roadmap/#fase-atual","title":"Fase Atual","text":""},{"location":"roadmap/#fase-4-deploy-producao","title":"Fase 4: Deploy &amp; Produ\u00e7\u00e3o","text":"<p>Objetivo: Preparar para produ\u00e7\u00e3o.</p> <ul> <li>[ ] Documenta\u00e7\u00e3o completa (MkDocs)</li> <li>[ ] Configura\u00e7\u00e3o de produ\u00e7\u00e3o otimizada</li> <li>[ ] Deploy em servidor de produ\u00e7\u00e3o</li> <li>[ ] Monitoramento e logging</li> <li>[ ] Backups automatizados</li> <li>[ ] CDN para assets est\u00e1ticos</li> </ul>"},{"location":"roadmap/#futuro","title":"Futuro","text":""},{"location":"roadmap/#fase-5-audio-completo","title":"Fase 5: \u00c1udio Completo","text":"<p>Objetivo: Player de \u00e1udio funcional.</p> <ul> <li>[ ] Upload de \u00e1udios</li> <li>[ ] Player integrado</li> <li>[ ] Playlists</li> <li>[ ] Download de \u00e1udios</li> </ul>"},{"location":"roadmap/#fase-6-mobile-app","title":"Fase 6: Mobile App","text":"<p>Objetivo: Aplicativo mobile nativo.</p> <ul> <li>[ ] App React Native ou Flutter</li> <li>[ ] Modo offline</li> <li>[ ] Sincroniza\u00e7\u00e3o de favoritos</li> </ul>"},{"location":"roadmap/#fase-7-features-avancadas","title":"Fase 7: Features Avan\u00e7adas","text":"<p>Objetivo: Melhorias cont\u00ednuas.</p> <ul> <li>[ ] Transcri\u00e7\u00e3o autom\u00e1tica de \u00e1udio</li> <li>[ ] Tradu\u00e7\u00e3o de hinos</li> <li>[ ] Compara\u00e7\u00e3o de vers\u00f5es</li> <li>[ ] API p\u00fablica REST</li> </ul>"},{"location":"roadmap/#contribuicao","title":"Contribui\u00e7\u00e3o","text":"<p>Quer ajudar a acelerar o roadmap? Veja nosso guia de contribui\u00e7\u00e3o.</p>"},{"location":"roadmap/#changelog","title":"Changelog","text":"<p>Para ver as mudan\u00e7as j\u00e1 implementadas, consulte o Changelog.</p>"},{"location":"developer-guide/","title":"Guia do Desenvolvedor","text":"<p>Bem-vindo \u00e0 documenta\u00e7\u00e3o t\u00e9cnica do hyms-plat!</p>"},{"location":"developer-guide/#visao-geral","title":"Vis\u00e3o Geral","text":"<p>O hyms-plat \u00e9 um portal Django/Wagtail para hin\u00e1rios do Santo Daime com:</p> <ul> <li> Busca avan\u00e7ada via TypeSense</li> <li> CMS Wagtail para p\u00e1ginas</li> <li> Upload de \u00e1udio (em desenvolvimento)</li> <li> Features sociais</li> <li> Docker para servi\u00e7os externos</li> </ul>"},{"location":"developer-guide/#stack-tecnologico","title":"Stack Tecnol\u00f3gico","text":"Componente Tecnologia Backend Django 5.1 + Python 3.11+ CMS Wagtail 6.4 Banco de Dados PostgreSQL 16 Busca TypeSense 27.1 Task Queue Celery + Redis Testes pytest (290+ testes, 83%+ coverage) <p>Veja detalhes em Technology Stack.</p>"},{"location":"developer-guide/#comecando","title":"Come\u00e7ando","text":"<ul> <li> <p> Setup Local</p> <p>Configure seu ambiente de desenvolvimento</p> </li> <li> <p> Arquitetura</p> <p>Entenda a estrutura do sistema</p> </li> <li> <p> Contribuindo</p> <p>Como contribuir com o projeto</p> </li> <li> <p> Testes</p> <p>Estrat\u00e9gia de testes do projeto</p> </li> </ul>"},{"location":"developer-guide/#links-rapidos","title":"Links R\u00e1pidos","text":""},{"location":"developer-guide/#referencia","title":"Refer\u00eancia","text":"<ul> <li>Models Reference</li> <li>Views Reference</li> <li>Management Commands</li> <li>TypeSense Client</li> </ul>"},{"location":"developer-guide/#guias","title":"Guias","text":"<ul> <li>Importar YAML</li> <li>Reindexar Busca</li> <li>Adicionar Features</li> </ul>"},{"location":"developer-guide/#deploy","title":"Deploy","text":"<ul> <li>Vis\u00e3o Geral</li> <li>CI/CD</li> </ul>"},{"location":"developer-guide/#status-do-projeto","title":"Status do Projeto","text":"Fase Status Cobertura Fase 0: Setup  Completa N/A Fase 1: MVP Read-Only  Completa 98% Fase 2: Upload &amp; Users  Completa 85% Fase 3: \u00c1udio &amp; Social  Completa 83% Fase 4: Deploy &amp; Prod  Em andamento - <p>Veja o Roadmap completo.</p>"},{"location":"developer-guide/#estrutura-do-projeto","title":"Estrutura do Projeto","text":"<pre><code>hyms-plat/\n\u251c\u2500\u2500 apps/                    # Django apps\n\u2502   \u251c\u2500\u2500 core/               # Base e utilidades\n\u2502   \u251c\u2500\u2500 hymns/              # Hin\u00e1rios e hinos\n\u2502   \u251c\u2500\u2500 search/             # TypeSense integration\n\u2502   \u251c\u2500\u2500 users/              # Autentica\u00e7\u00e3o e perfis\n\u2502   \u2514\u2500\u2500 cms/                # Wagtail CMS\n\u251c\u2500\u2500 config/                  # Configura\u00e7\u00f5es Django\n\u2502   \u2514\u2500\u2500 settings/           # Settings por ambiente\n\u251c\u2500\u2500 templates/              # Templates HTML\n\u251c\u2500\u2500 static/                 # Arquivos est\u00e1ticos\n\u251c\u2500\u2500 tests/                  # Testes\n\u2502   \u251c\u2500\u2500 unit/              # Testes unit\u00e1rios\n\u2502   \u2514\u2500\u2500 e2e/               # Testes E2E (Playwright)\n\u2514\u2500\u2500 docs/                   # Esta documenta\u00e7\u00e3o\n</code></pre>"},{"location":"developer-guide/api-reference/management-commands/","title":"Management Commands","text":"<p>Comandos personalizados do Django.</p>"},{"location":"developer-guide/api-reference/management-commands/#visao-geral","title":"Vis\u00e3o Geral","text":"<pre><code>poetry run python manage.py &lt;command&gt;\n</code></pre>"},{"location":"developer-guide/api-reference/management-commands/#appshymns","title":"apps.hymns","text":""},{"location":"developer-guide/api-reference/management-commands/#import_yaml","title":"import_yaml","text":"<p>Importa hin\u00e1rio de arquivo YAML.</p> <pre><code>poetry run python manage.py import_yaml &lt;arquivo.yaml&gt;\n</code></pre> <p>Argumentos:</p> Argumento Tipo Descri\u00e7\u00e3o <code>yaml_file</code> path Caminho do arquivo YAML <p>Op\u00e7\u00f5es:</p> Op\u00e7\u00e3o Descri\u00e7\u00e3o <code>--dry-run</code> Simula sem salvar <code>--force</code> Sobrescreve se existir <p>Exemplo:</p> <pre><code># Import normal\npoetry run python manage.py import_yaml hinarios/cruzeiro.yaml\n\n# Dry run\npoetry run python manage.py import_yaml hinarios/cruzeiro.yaml --dry-run\n\n# For\u00e7ar sobrescrita\npoetry run python manage.py import_yaml hinarios/cruzeiro.yaml --force\n</code></pre> <p>Formato YAML:</p> <pre><code>name: \"O Cruzeiro\"\nowner_name: \"Mestre Irineu\"\nhymns:\n  - number: 1\n    title: \"Lua Branca\"\n    text: \"Lua branca...\"\n</code></pre>"},{"location":"developer-guide/api-reference/management-commands/#appssearch","title":"apps.search","text":""},{"location":"developer-guide/api-reference/management-commands/#reindex_typesense","title":"reindex_typesense","text":"<p>Recria \u00edndice do TypeSense.</p> <pre><code>poetry run python manage.py reindex_typesense\n</code></pre> <p>Op\u00e7\u00f5es:</p> Op\u00e7\u00e3o Descri\u00e7\u00e3o <code>--batch-size</code> Tamanho do batch (default: 100) <code>--no-delete</code> N\u00e3o deleta collection antes <p>Exemplo:</p> <pre><code># Reindex completo\npoetry run python manage.py reindex_typesense\n\n# Com batch maior\npoetry run python manage.py reindex_typesense --batch-size=500\n</code></pre> <p>Output:</p> <pre><code>Deleting existing collection...\nCreating collection with schema...\nIndexing hymns...\nIndexed 1234 hymns in 5.2 seconds\n</code></pre>"},{"location":"developer-guide/api-reference/management-commands/#check_typesense","title":"check_typesense","text":"<p>Verifica conex\u00e3o com TypeSense.</p> <pre><code>poetry run python manage.py check_typesense\n</code></pre> <p>Output:</p> <pre><code>TypeSense connection: OK\nHost: localhost:8108\nCollections: hymns (1234 documents)\n</code></pre>"},{"location":"developer-guide/api-reference/management-commands/#comandos-django-uteis","title":"Comandos Django \u00dateis","text":""},{"location":"developer-guide/api-reference/management-commands/#migrate","title":"migrate","text":"<pre><code># Rodar migrations\npoetry run python manage.py migrate\n\n# Ver migrations pendentes\npoetry run python manage.py showmigrations\n</code></pre>"},{"location":"developer-guide/api-reference/management-commands/#createsuperuser","title":"createsuperuser","text":"<pre><code>poetry run python manage.py createsuperuser\n</code></pre>"},{"location":"developer-guide/api-reference/management-commands/#shell","title":"shell","text":"<pre><code># Shell Python\npoetry run python manage.py shell\n\n# Shell com IPython\npoetry run python manage.py shell -i ipython\n</code></pre>"},{"location":"developer-guide/api-reference/management-commands/#dbshell","title":"dbshell","text":"<pre><code>poetry run python manage.py dbshell\n</code></pre>"},{"location":"developer-guide/api-reference/management-commands/#collectstatic","title":"collectstatic","text":"<pre><code>poetry run python manage.py collectstatic\n</code></pre>"},{"location":"developer-guide/api-reference/management-commands/#check","title":"check","text":"<pre><code># Verificar problemas\npoetry run python manage.py check\n\n# Com deploy checks\npoetry run python manage.py check --deploy\n</code></pre>"},{"location":"developer-guide/api-reference/management-commands/#criando-novos-comandos","title":"Criando Novos Comandos","text":"<pre><code># apps/hymns/management/commands/my_command.py\nfrom django.core.management.base import BaseCommand\n\nclass Command(BaseCommand):\n    help = 'Descri\u00e7\u00e3o do comando'\n\n    def add_arguments(self, parser):\n        parser.add_argument('arg1', type=str)\n        parser.add_argument('--option', action='store_true')\n\n    def handle(self, *args, **options):\n        self.stdout.write('Executando...')\n\n        if options['option']:\n            pass\n\n        self.stdout.write(\n            self.style.SUCCESS('Conclu\u00eddo!')\n        )\n</code></pre> <p>Uso:</p> <pre><code>poetry run python manage.py my_command arg1 --option\n</code></pre>"},{"location":"developer-guide/api-reference/models/","title":"Models Reference","text":"<p>Refer\u00eancia completa dos models Django.</p>"},{"location":"developer-guide/api-reference/models/#appshymns","title":"apps.hymns","text":""},{"location":"developer-guide/api-reference/models/#hymnbook","title":"HymnBook","text":"<pre><code>class HymnBook(models.Model):\n    \"\"\"Hin\u00e1rio - cole\u00e7\u00e3o de hinos.\"\"\"\n\n    id = models.UUIDField(primary_key=True, default=uuid.uuid4)\n    name = models.CharField(max_length=255, unique=True, db_index=True)\n    slug = models.SlugField(unique=True, max_length=255)\n    intro_name = models.CharField(max_length=100, blank=True)\n    owner_name = models.CharField(max_length=255)\n    owner_user = models.ForeignKey('users.User', null=True, blank=True)\n    cover_image = models.ImageField(upload_to='hymn_covers/', blank=True)\n    description = models.TextField(blank=True)\n    created_at = models.DateTimeField(auto_now_add=True)\n    updated_at = models.DateTimeField(auto_now=True)\n</code></pre> <p>Propriedades:</p> Propriedade Tipo Descri\u00e7\u00e3o <code>hymn_count</code> int N\u00famero de hinos no hin\u00e1rio <p>M\u00e9todos:</p> M\u00e9todo Retorno Descri\u00e7\u00e3o <code>save()</code> None Auto-gera slug se n\u00e3o existir <code>__str__()</code> str Retorna <code>name</code>"},{"location":"developer-guide/api-reference/models/#hymn","title":"Hymn","text":"<pre><code>class Hymn(models.Model):\n    \"\"\"Hino individual.\"\"\"\n\n    id = models.UUIDField(primary_key=True, default=uuid.uuid4)\n    hymn_book = models.ForeignKey(HymnBook, related_name='hymns')\n    number = models.PositiveIntegerField()\n    title = models.CharField(max_length=255, db_index=True)\n    text = models.TextField()\n    received_at = models.DateField(null=True, blank=True)\n    offered_to = models.CharField(max_length=255, blank=True)\n    style = models.CharField(max_length=50, blank=True)\n    extra_instructions = models.TextField(blank=True)\n    repetitions = models.CharField(max_length=100, blank=True)\n    created_at = models.DateTimeField(auto_now_add=True)\n    updated_at = models.DateTimeField(auto_now=True)\n</code></pre> <p>Propriedades:</p> Propriedade Tipo Descri\u00e7\u00e3o <code>full_title</code> str \"Hin\u00e1rio - N\u00ba. T\u00edtulo\" <p>Meta:</p> <ul> <li><code>unique_together = [['hymn_book', 'number']]</code></li> <li><code>ordering = ['hymn_book', 'number']</code></li> </ul>"},{"location":"developer-guide/api-reference/models/#hymnbookversion","title":"HymnBookVersion","text":"<pre><code>class HymnBookVersion(models.Model):\n    \"\"\"Vers\u00e3o de um hin\u00e1rio.\"\"\"\n\n    STATUS_CHOICES = [\n        ('pending', 'Pendente'),\n        ('approved', 'Aprovado'),\n        ('rejected', 'Rejeitado'),\n    ]\n\n    id = models.UUIDField(primary_key=True, default=uuid.uuid4)\n    original = models.ForeignKey(HymnBook, related_name='versions')\n    uploaded_by = models.ForeignKey('users.User')\n    version_number = models.PositiveIntegerField()\n    changes = models.JSONField(default=dict)\n    status = models.CharField(max_length=20, choices=STATUS_CHOICES)\n    created_at = models.DateTimeField(auto_now_add=True)\n</code></pre>"},{"location":"developer-guide/api-reference/models/#appsusers","title":"apps.users","text":""},{"location":"developer-guide/api-reference/models/#user","title":"User","text":"<pre><code>class User(AbstractUser):\n    \"\"\"Usu\u00e1rio customizado.\"\"\"\n\n    id = models.UUIDField(primary_key=True, default=uuid.uuid4)\n    bio = models.TextField(blank=True)\n    avatar = models.ImageField(upload_to='avatars/', blank=True)\n</code></pre>"},{"location":"developer-guide/api-reference/models/#favorite","title":"Favorite","text":"<pre><code>class Favorite(models.Model):\n    \"\"\"Hino favoritado.\"\"\"\n\n    id = models.UUIDField(primary_key=True, default=uuid.uuid4)\n    user = models.ForeignKey(User, related_name='favorites')\n    hymn = models.ForeignKey('hymns.Hymn', related_name='favorites')\n    created_at = models.DateTimeField(auto_now_add=True)\n</code></pre> <p>Meta:</p> <ul> <li><code>unique_together = [['user', 'hymn']]</code></li> </ul>"},{"location":"developer-guide/api-reference/models/#comment","title":"Comment","text":"<pre><code>class Comment(models.Model):\n    \"\"\"Coment\u00e1rio em hino.\"\"\"\n\n    id = models.UUIDField(primary_key=True, default=uuid.uuid4)\n    user = models.ForeignKey(User, related_name='comments')\n    hymn = models.ForeignKey('hymns.Hymn', related_name='comments')\n    text = models.TextField()\n    created_at = models.DateTimeField(auto_now_add=True)\n    updated_at = models.DateTimeField(auto_now=True)\n</code></pre>"},{"location":"developer-guide/api-reference/models/#follow","title":"Follow","text":"<pre><code>class Follow(models.Model):\n    \"\"\"Seguir usu\u00e1rio.\"\"\"\n\n    id = models.UUIDField(primary_key=True, default=uuid.uuid4)\n    follower = models.ForeignKey(User, related_name='following')\n    following = models.ForeignKey(User, related_name='followers')\n    created_at = models.DateTimeField(auto_now_add=True)\n</code></pre> <p>Meta:</p> <ul> <li><code>unique_together = [['follower', 'following']]</code></li> </ul>"},{"location":"developer-guide/api-reference/models/#notification","title":"Notification","text":"<pre><code>class Notification(models.Model):\n    \"\"\"Notifica\u00e7\u00e3o para usu\u00e1rio.\"\"\"\n\n    TYPE_CHOICES = [\n        ('favorite', 'Favoritou'),\n        ('comment', 'Coment\u00e1rio'),\n        ('follow', 'Seguiu'),\n        ('upload', 'Upload'),\n    ]\n\n    id = models.UUIDField(primary_key=True, default=uuid.uuid4)\n    user = models.ForeignKey(User, related_name='notifications')\n    notification_type = models.CharField(max_length=20, choices=TYPE_CHOICES)\n    data = models.JSONField(default=dict)\n    read = models.BooleanField(default=False)\n    created_at = models.DateTimeField(auto_now_add=True)\n</code></pre>"},{"location":"developer-guide/api-reference/models/#managers","title":"Managers","text":""},{"location":"developer-guide/api-reference/models/#hymnbookobjects","title":"HymnBook.objects","text":"<pre><code># Todos os hin\u00e1rios\nHymnBook.objects.all()\n\n# Por nome\nHymnBook.objects.get(name=\"O Cruzeiro\")\n\n# Por slug\nHymnBook.objects.get(slug=\"o-cruzeiro\")\n\n# Com prefetch de hinos\nHymnBook.objects.prefetch_related('hymns')\n</code></pre>"},{"location":"developer-guide/api-reference/models/#hymnobjects","title":"Hymn.objects","text":"<pre><code># Todos os hinos\nHymn.objects.all()\n\n# De um hin\u00e1rio\nHymn.objects.filter(hymn_book=hymnbook)\n\n# Com select_related\nHymn.objects.select_related('hymn_book')\n\n# Busca por t\u00edtulo\nHymn.objects.filter(title__icontains=\"lua\")\n</code></pre>"},{"location":"developer-guide/api-reference/models/#signals","title":"Signals","text":"<pre><code># apps/hymns/signals.py\nfrom django.db.models.signals import post_save\nfrom django.dispatch import receiver\n\n@receiver(post_save, sender=Hymn)\ndef index_hymn_on_save(sender, instance, **kwargs):\n    \"\"\"Indexa hino no TypeSense ao salvar.\"\"\"\n    from apps.search.indexer import index_hymn\n    index_hymn(instance)\n</code></pre>"},{"location":"developer-guide/api-reference/typesense-client/","title":"TypeSense Client","text":"<p>API do cliente TypeSense.</p>"},{"location":"developer-guide/api-reference/typesense-client/#configuracao","title":"Configura\u00e7\u00e3o","text":"<pre><code># apps/search/client.py\nimport typesense\n\nclient = typesense.Client({\n    'nodes': [{\n        'host': settings.TYPESENSE_HOST,\n        'port': settings.TYPESENSE_PORT,\n        'protocol': settings.TYPESENSE_PROTOCOL,\n    }],\n    'api_key': settings.TYPESENSE_API_KEY,\n    'connection_timeout_seconds': 2\n})\n</code></pre>"},{"location":"developer-guide/api-reference/typesense-client/#schema","title":"Schema","text":"<pre><code># apps/search/schema.py\nHYMNS_SCHEMA = {\n    'name': 'hymns',\n    'fields': [\n        {'name': 'id', 'type': 'string'},\n        {'name': 'hymn_book_id', 'type': 'string'},\n        {'name': 'hymn_book_name', 'type': 'string', 'facet': True},\n        {'name': 'hymn_book_slug', 'type': 'string'},\n        {'name': 'owner_name', 'type': 'string', 'facet': True},\n        {'name': 'number', 'type': 'int32', 'sort': True},\n        {'name': 'title', 'type': 'string'},\n        {'name': 'text', 'type': 'string'},\n        {'name': 'style', 'type': 'string', 'facet': True, 'optional': True},\n    ],\n    'default_sorting_field': 'number'\n}\n</code></pre>"},{"location":"developer-guide/api-reference/typesense-client/#funcoes","title":"Fun\u00e7\u00f5es","text":""},{"location":"developer-guide/api-reference/typesense-client/#create_collection","title":"create_collection","text":"<pre><code>def create_collection() -&gt; None:\n    \"\"\"Cria collection de hinos.\"\"\"\n    try:\n        client.collections['hymns'].delete()\n    except Exception:\n        pass\n\n    client.collections.create(HYMNS_SCHEMA)\n</code></pre>"},{"location":"developer-guide/api-reference/typesense-client/#index_hymn","title":"index_hymn","text":"<pre><code>def index_hymn(hymn: Hymn) -&gt; None:\n    \"\"\"Indexa um hino.\"\"\"\n    document = {\n        'id': str(hymn.id),\n        'hymn_book_id': str(hymn.hymn_book_id),\n        'hymn_book_name': hymn.hymn_book.name,\n        'hymn_book_slug': hymn.hymn_book.slug,\n        'owner_name': hymn.hymn_book.owner_name,\n        'number': hymn.number,\n        'title': hymn.title,\n        'text': hymn.text,\n        'style': hymn.style or '',\n    }\n\n    client.collections['hymns'].documents.upsert(document)\n</code></pre>"},{"location":"developer-guide/api-reference/typesense-client/#delete_hymn","title":"delete_hymn","text":"<pre><code>def delete_hymn(hymn_id: str) -&gt; None:\n    \"\"\"Remove hino do \u00edndice.\"\"\"\n    client.collections['hymns'].documents[hymn_id].delete()\n</code></pre>"},{"location":"developer-guide/api-reference/typesense-client/#search_hymns","title":"search_hymns","text":"<pre><code>def search_hymns(\n    query: str,\n    per_page: int = 20,\n    page: int = 1,\n    filters: dict = None\n) -&gt; dict:\n    \"\"\"Busca hinos.\n\n    Args:\n        query: Termo de busca\n        per_page: Resultados por p\u00e1gina\n        page: N\u00famero da p\u00e1gina\n        filters: Filtros opcionais\n\n    Returns:\n        Dict com hits e metadados\n    \"\"\"\n    search_parameters = {\n        'q': query,\n        'query_by': 'title,text,hymn_book_name,owner_name',\n        'per_page': per_page,\n        'page': page,\n        'typo_tolerance': True,\n    }\n\n    if filters:\n        filter_parts = []\n        if 'hymn_book_name' in filters:\n            filter_parts.append(f\"hymn_book_name:={filters['hymn_book_name']}\")\n        if 'style' in filters:\n            filter_parts.append(f\"style:={filters['style']}\")\n\n        if filter_parts:\n            search_parameters['filter_by'] = ' &amp;&amp; '.join(filter_parts)\n\n    return client.collections['hymns'].documents.search(search_parameters)\n</code></pre>"},{"location":"developer-guide/api-reference/typesense-client/#reindex_all","title":"reindex_all","text":"<pre><code>def reindex_all(batch_size: int = 100) -&gt; int:\n    \"\"\"Reindexa todos os hinos.\n\n    Returns:\n        N\u00famero de hinos indexados\n    \"\"\"\n    create_collection()\n\n    count = 0\n    hymns = Hymn.objects.select_related('hymn_book')\n\n    for hymn in hymns.iterator():\n        index_hymn(hymn)\n        count += 1\n\n    return count\n</code></pre>"},{"location":"developer-guide/api-reference/typesense-client/#uso","title":"Uso","text":""},{"location":"developer-guide/api-reference/typesense-client/#busca-basica","title":"Busca B\u00e1sica","text":"<pre><code>from apps.search.client import search_hymns\n\nresults = search_hymns(\"lua branca\")\nfor hit in results['hits']:\n    print(hit['document']['title'])\n</code></pre>"},{"location":"developer-guide/api-reference/typesense-client/#busca-com-filtros","title":"Busca com Filtros","text":"<pre><code>results = search_hymns(\n    query=\"lua\",\n    filters={'hymn_book_name': 'O Cruzeiro'}\n)\n</code></pre>"},{"location":"developer-guide/api-reference/typesense-client/#busca-paginada","title":"Busca Paginada","text":"<pre><code>page1 = search_hymns(\"lua\", per_page=10, page=1)\npage2 = search_hymns(\"lua\", per_page=10, page=2)\n</code></pre>"},{"location":"developer-guide/api-reference/typesense-client/#response-format","title":"Response Format","text":"<pre><code>{\n    'found': 42,\n    'hits': [\n        {\n            'document': {\n                'id': 'uuid...',\n                'title': 'Lua Branca',\n                'text': 'Lua branca da luz...',\n                'hymn_book_name': 'O Cruzeiro',\n                'owner_name': 'Mestre Irineu',\n                'number': 1,\n            },\n            'highlight': {\n                'title': {\n                    'matched_tokens': ['Lua'],\n                    'snippet': '&lt;mark&gt;Lua&lt;/mark&gt; Branca'\n                }\n            },\n            'text_match': 130\n        },\n        # ...\n    ],\n    'page': 1,\n    'out_of': 5\n}\n</code></pre>"},{"location":"developer-guide/api-reference/typesense-client/#troubleshooting","title":"Troubleshooting","text":""},{"location":"developer-guide/api-reference/typesense-client/#conexao-recusada","title":"Conex\u00e3o recusada","text":"<pre><code># Verificar health\nimport requests\nresponse = requests.get('http://localhost:8108/health')\nprint(response.json())\n</code></pre>"},{"location":"developer-guide/api-reference/typesense-client/#collection-nao-existe","title":"Collection n\u00e3o existe","text":"<pre><code># Criar collection\nfrom apps.search.client import create_collection\ncreate_collection()\n</code></pre>"},{"location":"developer-guide/api-reference/typesense-client/#dados-desatualizados","title":"Dados desatualizados","text":"<pre><code>poetry run python manage.py reindex_typesense\n</code></pre>"},{"location":"developer-guide/api-reference/utils/","title":"Utilities","text":"<p>Fun\u00e7\u00f5es utilit\u00e1rias do projeto.</p>"},{"location":"developer-guide/api-reference/utils/#appshymnsdisambiguation","title":"apps.hymns.disambiguation","text":"<p>Fun\u00e7\u00f5es para detec\u00e7\u00e3o de duplicatas.</p>"},{"location":"developer-guide/api-reference/utils/#normalize_hymnbook_name","title":"normalize_hymnbook_name","text":"<pre><code>def normalize_hymnbook_name(name: str) -&gt; str:\n    \"\"\"Normaliza nome de hin\u00e1rio para compara\u00e7\u00e3o.\n\n    Args:\n        name: Nome original\n\n    Returns:\n        Nome normalizado (lowercase, sem espa\u00e7os extras)\n    \"\"\"\n    if not name:\n        return \"\"\n    return \" \".join(name.lower().split())\n</code></pre> <p>Exemplo:</p> <pre><code>normalize_hymnbook_name(\"O  Cruzeiro\")  # \"o cruzeiro\"\nnormalize_hymnbook_name(None)  # \"\"\n</code></pre>"},{"location":"developer-guide/api-reference/utils/#calculate_string_similarity","title":"calculate_string_similarity","text":"<pre><code>def calculate_string_similarity(str1: str, str2: str) -&gt; float:\n    \"\"\"Calcula similaridade entre strings.\n\n    Args:\n        str1: Primeira string\n        str2: Segunda string\n\n    Returns:\n        Valor entre 0.0 e 1.0\n    \"\"\"\n    if not str1 or not str2:\n        return 0.0\n    return SequenceMatcher(None, str1.lower(), str2.lower()).ratio()\n</code></pre> <p>Exemplo:</p> <pre><code>calculate_string_similarity(\"O Cruzeiro\", \"O Cruzeiro\")  # 1.0\ncalculate_string_similarity(\"O Cruzeiro\", \"Cruzeiro\")  # 0.85\ncalculate_string_similarity(\"abc\", None)  # 0.0\n</code></pre>"},{"location":"developer-guide/api-reference/utils/#find_similar_hymnbooks","title":"find_similar_hymnbooks","text":"<pre><code>def find_similar_hymnbooks(\n    name: str,\n    threshold: float = 0.8\n) -&gt; List[Tuple[HymnBook, float]]:\n    \"\"\"Encontra hin\u00e1rios similares.\n\n    Args:\n        name: Nome para comparar\n        threshold: Similaridade m\u00ednima (0.0 a 1.0)\n\n    Returns:\n        Lista de tuplas (HymnBook, score)\n    \"\"\"\n</code></pre> <p>Exemplo:</p> <pre><code>similar = find_similar_hymnbooks(\"O Cruzeiro\", threshold=0.7)\nfor hymnbook, score in similar:\n    print(f\"{hymnbook.name}: {score:.2f}\")\n</code></pre>"},{"location":"developer-guide/api-reference/utils/#find_duplicates","title":"find_duplicates","text":"<pre><code>def find_duplicates(\n    name: str,\n    owner_name: str,\n    hymn_count: int\n) -&gt; Optional[HymnBook]:\n    \"\"\"Encontra poss\u00edvel duplicata.\n\n    Args:\n        name: Nome do hin\u00e1rio\n        owner_name: Nome do dono\n        hymn_count: N\u00famero de hinos\n\n    Returns:\n        HymnBook se encontrar duplicata, None caso contr\u00e1rio\n    \"\"\"\n</code></pre>"},{"location":"developer-guide/api-reference/utils/#appshymnsvalidators","title":"apps.hymns.validators","text":""},{"location":"developer-guide/api-reference/utils/#validate_yaml_structure","title":"validate_yaml_structure","text":"<pre><code>def validate_yaml_structure(data: dict) -&gt; Tuple[bool, List[str]]:\n    \"\"\"Valida estrutura do YAML de hin\u00e1rio.\n\n    Args:\n        data: Dict parseado do YAML\n\n    Returns:\n        Tupla (is_valid, list_of_errors)\n    \"\"\"\n</code></pre> <p>Exemplo:</p> <pre><code>import yaml\n\nwith open('hinario.yaml') as f:\n    data = yaml.safe_load(f)\n\nis_valid, errors = validate_yaml_structure(data)\nif not is_valid:\n    for error in errors:\n        print(f\"Erro: {error}\")\n</code></pre>"},{"location":"developer-guide/api-reference/utils/#validate_hymn_numbers","title":"validate_hymn_numbers","text":"<pre><code>def validate_hymn_numbers(hymns: List[dict]) -&gt; Tuple[bool, List[str]]:\n    \"\"\"Verifica se n\u00fameros de hinos s\u00e3o \u00fanicos e sequenciais.\n\n    Args:\n        hymns: Lista de dicts de hinos\n\n    Returns:\n        Tupla (is_valid, list_of_errors)\n    \"\"\"\n</code></pre>"},{"location":"developer-guide/api-reference/utils/#appscoreutils","title":"apps.core.utils","text":""},{"location":"developer-guide/api-reference/utils/#generate_slug","title":"generate_slug","text":"<pre><code>def generate_slug(text: str, max_length: int = 255) -&gt; str:\n    \"\"\"Gera slug a partir de texto.\n\n    Args:\n        text: Texto original\n        max_length: Tamanho m\u00e1ximo\n\n    Returns:\n        Slug gerado\n    \"\"\"\n</code></pre> <p>Exemplo:</p> <pre><code>generate_slug(\"O Cruzeiro\")  # \"o-cruzeiro\"\ngenerate_slug(\"Hin\u00e1rio do Jo\u00e3o\")  # \"hinario-do-joao\"\n</code></pre>"},{"location":"developer-guide/api-reference/utils/#truncate_text","title":"truncate_text","text":"<pre><code>def truncate_text(text: str, max_words: int = 40) -&gt; str:\n    \"\"\"Trunca texto em n\u00famero de palavras.\n\n    Args:\n        text: Texto original\n        max_words: N\u00famero m\u00e1ximo de palavras\n\n    Returns:\n        Texto truncado com \"...\" se necess\u00e1rio\n    \"\"\"\n</code></pre> <p>Exemplo:</p> <pre><code>text = \"Esta \u00e9 uma frase muito longa...\"\ntruncate_text(text, max_words=5)  # \"Esta \u00e9 uma frase muito...\"\n</code></pre>"},{"location":"developer-guide/api-reference/utils/#appsusersutils","title":"apps.users.utils","text":""},{"location":"developer-guide/api-reference/utils/#create_notification","title":"create_notification","text":"<pre><code>def create_notification(\n    user: User,\n    notification_type: str,\n    data: dict\n) -&gt; Notification:\n    \"\"\"Cria notifica\u00e7\u00e3o para usu\u00e1rio.\n\n    Args:\n        user: Usu\u00e1rio destino\n        notification_type: Tipo (favorite, comment, follow, upload)\n        data: Dados adicionais\n\n    Returns:\n        Notifica\u00e7\u00e3o criada\n    \"\"\"\n</code></pre> <p>Exemplo:</p> <pre><code>create_notification(\n    user=some_user,\n    notification_type='comment',\n    data={\n        'hymn_id': str(hymn.id),\n        'hymn_title': hymn.title,\n        'commenter': request.user.username,\n    }\n)\n</code></pre>"},{"location":"developer-guide/api-reference/utils/#get_user_stats","title":"get_user_stats","text":"<pre><code>def get_user_stats(user: User) -&gt; dict:\n    \"\"\"Retorna estat\u00edsticas do usu\u00e1rio.\n\n    Args:\n        user: Usu\u00e1rio\n\n    Returns:\n        Dict com contagens\n    \"\"\"\n</code></pre> <p>Retorno:</p> <pre><code>{\n    'favorites_count': 42,\n    'comments_count': 15,\n    'uploads_count': 3,\n    'followers_count': 28,\n    'following_count': 12,\n}\n</code></pre>"},{"location":"developer-guide/api-reference/views/","title":"Views Reference","text":"<p>Refer\u00eancia das views e URLs.</p>"},{"location":"developer-guide/api-reference/views/#appshymns","title":"apps.hymns","text":""},{"location":"developer-guide/api-reference/views/#urls","title":"URLs","text":"<pre><code># apps/hymns/urls.py\nurlpatterns = [\n    path('', home_view, name='home'),\n    path('hinarios/', hymnbook_list, name='hymnbook_list'),\n    path('hinarios/&lt;slug:slug&gt;/', hymnbook_detail, name='hymnbook_detail'),\n    path('hino/&lt;uuid:pk&gt;/', hymn_detail, name='hymn_detail'),\n    path('busca/', search_view, name='search'),\n]\n</code></pre>"},{"location":"developer-guide/api-reference/views/#home_view","title":"home_view","text":"<pre><code>def home_view(request):\n    \"\"\"P\u00e1gina inicial com estat\u00edsticas.\"\"\"\n</code></pre> <p>URL: <code>/</code> Template: <code>hymns/home.html</code> Context:</p> Vari\u00e1vel Tipo Descri\u00e7\u00e3o <code>hymnbook_count</code> int Total de hin\u00e1rios <code>hymn_count</code> int Total de hinos <code>recent_hymnbooks</code> QuerySet \u00daltimos 6 hin\u00e1rios"},{"location":"developer-guide/api-reference/views/#hymnbook_list","title":"hymnbook_list","text":"<pre><code>def hymnbook_list(request):\n    \"\"\"Lista paginada de hin\u00e1rios.\"\"\"\n</code></pre> <p>URL: <code>/hinarios/</code> Template: <code>hymns/hymnbook_list.html</code> Context:</p> Vari\u00e1vel Tipo Descri\u00e7\u00e3o <code>hymnbooks</code> Page P\u00e1gina de hin\u00e1rios"},{"location":"developer-guide/api-reference/views/#hymnbook_detail","title":"hymnbook_detail","text":"<pre><code>def hymnbook_detail(request, slug):\n    \"\"\"Detalhes de um hin\u00e1rio.\"\"\"\n</code></pre> <p>URL: <code>/hinarios/&lt;slug&gt;/</code> Template: <code>hymns/hymnbook_detail.html</code> Context:</p> Vari\u00e1vel Tipo Descri\u00e7\u00e3o <code>hymnbook</code> HymnBook O hin\u00e1rio <code>hymns</code> QuerySet Hinos do hin\u00e1rio"},{"location":"developer-guide/api-reference/views/#hymn_detail","title":"hymn_detail","text":"<pre><code>def hymn_detail(request, pk):\n    \"\"\"Detalhes de um hino.\"\"\"\n</code></pre> <p>URL: <code>/hino/&lt;uuid&gt;/</code> Template: <code>hymns/hymn_detail.html</code> Context:</p> Vari\u00e1vel Tipo Descri\u00e7\u00e3o <code>hymn</code> Hymn O hino <code>is_favorite</code> bool Se usu\u00e1rio favoritou <code>comments</code> QuerySet Coment\u00e1rios"},{"location":"developer-guide/api-reference/views/#search_view","title":"search_view","text":"<pre><code>def search_view(request):\n    \"\"\"Busca de hinos.\"\"\"\n</code></pre> <p>URL: <code>/busca/</code> Template: <code>hymns/search.html</code> GET params:</p> Param Tipo Descri\u00e7\u00e3o <code>q</code> str Query de busca <p>Context:</p> Vari\u00e1vel Tipo Descri\u00e7\u00e3o <code>results</code> list Hinos encontrados <code>query</code> str Query usada <code>total</code> int Total de resultados"},{"location":"developer-guide/api-reference/views/#appsusers","title":"apps.users","text":""},{"location":"developer-guide/api-reference/views/#urls_1","title":"URLs","text":"<pre><code># apps/users/urls.py\nurlpatterns = [\n    path('contribuir/', upload_view, name='upload'),\n    path('perfil/&lt;str:username&gt;/', profile_view, name='profile'),\n    path('notificacoes/', notifications_view, name='notifications'),\n    path('api/favorite/&lt;uuid:hymn_id&gt;/', toggle_favorite, name='toggle_favorite'),\n    path('api/comment/&lt;uuid:hymn_id&gt;/', add_comment, name='add_comment'),\n    path('api/follow/&lt;str:username&gt;/', toggle_follow, name='toggle_follow'),\n]\n</code></pre>"},{"location":"developer-guide/api-reference/views/#upload_view","title":"upload_view","text":"<pre><code>@login_required\ndef upload_view(request):\n    \"\"\"Upload de hin\u00e1rio YAML.\"\"\"\n</code></pre> <p>URL: <code>/contribuir/</code> Template: <code>users/upload.html</code> Methods: GET, POST Auth: Requer login</p>"},{"location":"developer-guide/api-reference/views/#profile_view","title":"profile_view","text":"<pre><code>def profile_view(request, username):\n    \"\"\"Perfil p\u00fablico de usu\u00e1rio.\"\"\"\n</code></pre> <p>URL: <code>/perfil/&lt;username&gt;/</code> Template: <code>users/profile.html</code> Context:</p> Vari\u00e1vel Tipo Descri\u00e7\u00e3o <code>profile_user</code> User Usu\u00e1rio do perfil <code>is_following</code> bool Se est\u00e1 seguindo <code>followers_count</code> int N\u00famero de seguidores <code>following_count</code> int N\u00famero de seguidos"},{"location":"developer-guide/api-reference/views/#notifications_view","title":"notifications_view","text":"<pre><code>@login_required\ndef notifications_view(request):\n    \"\"\"Lista de notifica\u00e7\u00f5es.\"\"\"\n</code></pre> <p>URL: <code>/notificacoes/</code> Template: <code>users/notifications.html</code> Auth: Requer login</p>"},{"location":"developer-guide/api-reference/views/#api-endpoints","title":"API Endpoints","text":""},{"location":"developer-guide/api-reference/views/#toggle_favorite","title":"toggle_favorite","text":"<pre><code>@login_required\n@require_POST\ndef toggle_favorite(request, hymn_id):\n    \"\"\"Toggle favorito de um hino.\"\"\"\n</code></pre> <p>URL: <code>/api/favorite/&lt;uuid&gt;/</code> Method: POST Response: JSON <code>{\"favorited\": true/false}</code></p>"},{"location":"developer-guide/api-reference/views/#add_comment","title":"add_comment","text":"<pre><code>@login_required\n@require_POST\ndef add_comment(request, hymn_id):\n    \"\"\"Adiciona coment\u00e1rio a um hino.\"\"\"\n</code></pre> <p>URL: <code>/api/comment/&lt;uuid&gt;/</code> Method: POST Body: <code>{\"text\": \"...\"}</code> Response: JSON com dados do coment\u00e1rio</p>"},{"location":"developer-guide/api-reference/views/#toggle_follow","title":"toggle_follow","text":"<pre><code>@login_required\n@require_POST\ndef toggle_follow(request, username):\n    \"\"\"Toggle seguir usu\u00e1rio.\"\"\"\n</code></pre> <p>URL: <code>/api/follow/&lt;username&gt;/</code> Method: POST Response: JSON <code>{\"following\": true/false}</code></p>"},{"location":"developer-guide/api-reference/views/#decorators-comuns","title":"Decorators Comuns","text":"<pre><code>from django.contrib.auth.decorators import login_required\nfrom django.views.decorators.http import require_POST, require_GET\n\n@login_required\ndef protected_view(request):\n    pass\n\n@require_POST\ndef post_only_view(request):\n    pass\n</code></pre>"},{"location":"developer-guide/api-reference/views/#mixins-cbv","title":"Mixins (CBV)","text":"<pre><code>from django.contrib.auth.mixins import LoginRequiredMixin\nfrom django.views.generic import DetailView\n\nclass HymnDetailView(LoginRequiredMixin, DetailView):\n    model = Hymn\n    template_name = 'hymns/detail.html'\n</code></pre>"},{"location":"developer-guide/architecture/data-models/","title":"Models e Schema","text":"<p>Documenta\u00e7\u00e3o dos models do projeto.</p>"},{"location":"developer-guide/architecture/data-models/#erd-entity-relationship-diagram","title":"ERD (Entity Relationship Diagram)","text":"erDiagram     User ||--o{ HymnBook : owns     User ||--o{ HymnBookVersion : uploads     User ||--o{ Favorite : has     User ||--o{ Comment : writes     User ||--o{ Follow : follows     User ||--o{ Notification : receives      HymnBook ||--|{ Hymn : contains     HymnBook ||--o{ HymnBookVersion : versions      Hymn ||--o{ Favorite : has     Hymn ||--o{ Comment : has      User {         uuid id PK         string email UK         string username UK         text bio         image avatar         datetime created_at     }      HymnBook {         uuid id PK         string name UK         string slug UK         string intro_name         string owner_name         uuid owner_user_id FK         image cover_image         text description         datetime created_at     }      Hymn {         uuid id PK         uuid hymn_book_id FK         int number         string title         text text         date received_at         string offered_to         string style         text extra_instructions         string repetitions     }      HymnBookVersion {         uuid id PK         uuid original_id FK         uuid uploaded_by_id FK         int version_number         jsonb changes         string status         datetime created_at     }      Favorite {         uuid id PK         uuid user_id FK         uuid hymn_id FK         datetime created_at     }      Comment {         uuid id PK         uuid user_id FK         uuid hymn_id FK         text text         datetime created_at     }      Follow {         uuid id PK         uuid follower_id FK         uuid following_id FK         datetime created_at     }      Notification {         uuid id PK         uuid user_id FK         string type         jsonb data         bool read         datetime created_at     }"},{"location":"developer-guide/architecture/data-models/#models-detalhados","title":"Models Detalhados","text":""},{"location":"developer-guide/architecture/data-models/#hymnbook","title":"HymnBook","text":"<pre><code>class HymnBook(models.Model):\n    \"\"\"Hin\u00e1rio - cole\u00e7\u00e3o de hinos.\"\"\"\n\n    id = models.UUIDField(primary_key=True, default=uuid.uuid4)\n\n    # Identifica\u00e7\u00e3o\n    name = models.CharField(max_length=255, unique=True, db_index=True)\n    intro_name = models.CharField(max_length=100, blank=True)\n    slug = models.SlugField(unique=True, max_length=255)\n\n    # Propriet\u00e1rio\n    owner_name = models.CharField(max_length=255)\n    owner_user = models.ForeignKey(\n        'users.User',\n        on_delete=models.SET_NULL,\n        null=True, blank=True,\n        related_name='owned_hymnbooks'\n    )\n\n    # M\u00eddia e descri\u00e7\u00e3o\n    cover_image = models.ImageField(upload_to='hymn_covers/', blank=True)\n    description = models.TextField(blank=True)\n\n    # Timestamps\n    created_at = models.DateTimeField(auto_now_add=True)\n    updated_at = models.DateTimeField(auto_now=True)\n\n    class Meta:\n        ordering = ['name']\n        indexes = [\n            models.Index(fields=['name']),\n            models.Index(fields=['owner_name']),\n        ]\n</code></pre> <p>Campos:</p> Campo Tipo Descri\u00e7\u00e3o <code>name</code> CharField Nome \u00fanico do hin\u00e1rio <code>slug</code> SlugField Auto-gerado de name <code>intro_name</code> CharField Nome curto para exibi\u00e7\u00e3o <code>owner_name</code> CharField Texto livre - quem recebeu <code>owner_user</code> FK User Usu\u00e1rio dono (opcional) <code>cover_image</code> ImageField Capa do hin\u00e1rio <code>description</code> TextField Descri\u00e7\u00e3o completa"},{"location":"developer-guide/architecture/data-models/#hymn","title":"Hymn","text":"<pre><code>class Hymn(models.Model):\n    \"\"\"Hino individual dentro de um hin\u00e1rio.\"\"\"\n\n    id = models.UUIDField(primary_key=True, default=uuid.uuid4)\n\n    hymn_book = models.ForeignKey(\n        HymnBook,\n        on_delete=models.CASCADE,\n        related_name='hymns'\n    )\n\n    # Identifica\u00e7\u00e3o\n    number = models.PositiveIntegerField()\n    title = models.CharField(max_length=255, db_index=True)\n\n    # Conte\u00fado\n    text = models.TextField()\n\n    # Metadados\n    received_at = models.DateField(null=True, blank=True)\n    offered_to = models.CharField(max_length=255, blank=True)\n    style = models.CharField(max_length=50, blank=True)\n    extra_instructions = models.TextField(blank=True)\n    repetitions = models.CharField(max_length=100, blank=True)\n\n    class Meta:\n        ordering = ['hymn_book', 'number']\n        unique_together = [['hymn_book', 'number']]\n</code></pre> <p>Constraints:</p> <ul> <li><code>unique_together(hymn_book, number)</code> - N\u00famero \u00fanico por hin\u00e1rio</li> <li><code>CASCADE delete</code> - Deleta hinos quando hin\u00e1rio \u00e9 deletado</li> </ul>"},{"location":"developer-guide/architecture/data-models/#user-custom","title":"User (Custom)","text":"<pre><code>class User(AbstractUser):\n    \"\"\"Usu\u00e1rio customizado com campos extras.\"\"\"\n\n    id = models.UUIDField(primary_key=True, default=uuid.uuid4)\n    bio = models.TextField(blank=True)\n    avatar = models.ImageField(upload_to='avatars/', blank=True)\n</code></pre>"},{"location":"developer-guide/architecture/data-models/#hymnbookversion","title":"HymnBookVersion","text":"<pre><code>class HymnBookVersion(models.Model):\n    \"\"\"Vers\u00e3o de um hin\u00e1rio para tracking de mudan\u00e7as.\"\"\"\n\n    id = models.UUIDField(primary_key=True, default=uuid.uuid4)\n    original = models.ForeignKey(HymnBook, on_delete=models.CASCADE)\n    uploaded_by = models.ForeignKey(User, on_delete=models.SET_NULL)\n    version_number = models.PositiveIntegerField()\n    changes = models.JSONField(default=dict)\n    status = models.CharField(max_length=20, choices=STATUS_CHOICES)\n</code></pre>"},{"location":"developer-guide/architecture/data-models/#favorite","title":"Favorite","text":"<pre><code>class Favorite(models.Model):\n    \"\"\"Hino favoritado por usu\u00e1rio.\"\"\"\n\n    user = models.ForeignKey(User, on_delete=models.CASCADE)\n    hymn = models.ForeignKey(Hymn, on_delete=models.CASCADE)\n    created_at = models.DateTimeField(auto_now_add=True)\n\n    class Meta:\n        unique_together = [['user', 'hymn']]\n</code></pre>"},{"location":"developer-guide/architecture/data-models/#comment","title":"Comment","text":"<pre><code>class Comment(models.Model):\n    \"\"\"Coment\u00e1rio em um hino.\"\"\"\n\n    user = models.ForeignKey(User, on_delete=models.CASCADE)\n    hymn = models.ForeignKey(Hymn, on_delete=models.CASCADE)\n    text = models.TextField()\n    created_at = models.DateTimeField(auto_now_add=True)\n</code></pre>"},{"location":"developer-guide/architecture/data-models/#typesense-schema","title":"TypeSense Schema","text":"<pre><code>HYMNS_SCHEMA = {\n    'name': 'hymns',\n    'fields': [\n        {'name': 'id', 'type': 'string'},\n        {'name': 'hymn_book_id', 'type': 'string'},\n        {'name': 'hymn_book_name', 'type': 'string', 'facet': True},\n        {'name': 'hymn_book_slug', 'type': 'string'},\n        {'name': 'owner_name', 'type': 'string', 'facet': True},\n        {'name': 'number', 'type': 'int32', 'sort': True},\n        {'name': 'title', 'type': 'string'},\n        {'name': 'text', 'type': 'string'},\n        {'name': 'style', 'type': 'string', 'facet': True, 'optional': True},\n    ],\n    'default_sorting_field': 'number'\n}\n</code></pre> <p>Facets: <code>hymn_book_name</code>, <code>owner_name</code>, <code>style</code> Sortable: <code>number</code> Searchable: <code>title</code>, <code>text</code></p>"},{"location":"developer-guide/architecture/data-models/#migrations","title":"Migrations","text":"<p>Ver hist\u00f3rico em:</p> <ul> <li><code>apps/hymns/migrations/</code></li> <li><code>apps/users/migrations/</code></li> </ul>"},{"location":"developer-guide/architecture/decisions/","title":"Architecture Decision Records (ADRs)","text":"<p>Decis\u00f5es arquiteturais importantes do projeto.</p>"},{"location":"developer-guide/architecture/decisions/#adr-001-uuid-como-primary-key","title":"ADR-001: UUID como Primary Key","text":""},{"location":"developer-guide/architecture/decisions/#status","title":"Status","text":"<p>Aceito</p>"},{"location":"developer-guide/architecture/decisions/#contexto","title":"Contexto","text":"<p>Precisamos escolher entre auto-increment integer e UUID para primary keys.</p>"},{"location":"developer-guide/architecture/decisions/#decisao","title":"Decis\u00e3o","text":"<p>Usar UUID v4 como primary key em todos os models.</p>"},{"location":"developer-guide/architecture/decisions/#consequencias","title":"Consequ\u00eancias","text":"<p>Positivas:</p> <ul> <li>URLs n\u00e3o exp\u00f5em contagem de registros</li> <li>Merge de bancos mais simples</li> <li>IDs podem ser gerados no cliente</li> <li>Melhor para sistemas distribu\u00eddos</li> </ul> <p>Negativas:</p> <ul> <li>\u00cdndices maiores (16 bytes vs 4 bytes)</li> <li>Queries de range menos eficientes</li> <li>Debug mais dif\u00edcil (IDs n\u00e3o sequenciais)</li> </ul>"},{"location":"developer-guide/architecture/decisions/#implementacao","title":"Implementa\u00e7\u00e3o","text":"<pre><code>import uuid\nfrom django.db import models\n\nclass BaseModel(models.Model):\n    id = models.UUIDField(\n        primary_key=True,\n        default=uuid.uuid4,\n        editable=False\n    )\n\n    class Meta:\n        abstract = True\n</code></pre>"},{"location":"developer-guide/architecture/decisions/#adr-002-typesense-para-busca","title":"ADR-002: TypeSense para Busca","text":""},{"location":"developer-guide/architecture/decisions/#status_1","title":"Status","text":"<p>Aceito</p>"},{"location":"developer-guide/architecture/decisions/#contexto_1","title":"Contexto","text":"<p>Precisamos de busca full-text com:</p> <ul> <li>Toler\u00e2ncia a erros de digita\u00e7\u00e3o</li> <li>Busca instant\u00e2nea</li> <li>Facilidade de setup</li> </ul> <p>Alternativas consideradas:</p> <ul> <li>PostgreSQL full-text search</li> <li>ElasticSearch</li> <li>Meilisearch</li> <li>TypeSense</li> </ul>"},{"location":"developer-guide/architecture/decisions/#decisao_1","title":"Decis\u00e3o","text":"<p>Usar TypeSense 27.1.</p>"},{"location":"developer-guide/architecture/decisions/#consequencias_1","title":"Consequ\u00eancias","text":"<p>Positivas:</p> <ul> <li>Setup simples (Docker)</li> <li>Typo-tolerance nativo</li> <li>Lat\u00eancia &lt; 10ms</li> <li>Baixo consumo de mem\u00f3ria (~500MB)</li> </ul> <p>Negativas:</p> <ul> <li>Comunidade menor que ElasticSearch</li> <li>Menos integra\u00e7\u00f5es prontas</li> <li>Features avan\u00e7adas limitadas</li> </ul>"},{"location":"developer-guide/architecture/decisions/#adr-003-wagtail-para-cms","title":"ADR-003: Wagtail para CMS","text":""},{"location":"developer-guide/architecture/decisions/#status_2","title":"Status","text":"<p>Aceito</p>"},{"location":"developer-guide/architecture/decisions/#contexto_2","title":"Contexto","text":"<p>Precisamos de CMS para p\u00e1ginas edit\u00e1veis (Home, About, etc).</p> <p>Alternativas:</p> <ul> <li>Django Admin puro</li> <li>Wagtail</li> <li>django-cms</li> <li>Headless CMS externo</li> </ul>"},{"location":"developer-guide/architecture/decisions/#decisao_2","title":"Decis\u00e3o","text":"<p>Usar Wagtail 6.4.</p>"},{"location":"developer-guide/architecture/decisions/#consequencias_2","title":"Consequ\u00eancias","text":"<p>Positivas:</p> <ul> <li>Integra\u00e7\u00e3o nativa com Django</li> <li>Interface de edi\u00e7\u00e3o amig\u00e1vel</li> <li>StreamFields flex\u00edveis</li> <li>Boa documenta\u00e7\u00e3o</li> </ul> <p>Negativas:</p> <ul> <li>Overhead para uso simples</li> <li>Curva de aprendizado</li> <li>Migrations adicionais</li> </ul>"},{"location":"developer-guide/architecture/decisions/#adr-004-celery-para-background-tasks","title":"ADR-004: Celery para Background Tasks","text":""},{"location":"developer-guide/architecture/decisions/#status_3","title":"Status","text":"<p>Aceito</p>"},{"location":"developer-guide/architecture/decisions/#contexto_3","title":"Contexto","text":"<p>Opera\u00e7\u00f5es como:</p> <ul> <li>Reindexa\u00e7\u00e3o em batch</li> <li>Processamento de uploads</li> <li>Envio de emails</li> </ul> <p>S\u00e3o lentas demais para request/response.</p>"},{"location":"developer-guide/architecture/decisions/#decisao_3","title":"Decis\u00e3o","text":"<p>Usar Celery 5.4 com Redis como broker.</p>"},{"location":"developer-guide/architecture/decisions/#consequencias_3","title":"Consequ\u00eancias","text":"<p>Positivas:</p> <ul> <li>Tasks ass\u00edncronas</li> <li>Retry autom\u00e1tico</li> <li>Scheduling</li> <li>Monitoramento (Flower)</li> </ul> <p>Negativas:</p> <ul> <li>Complexidade operacional</li> <li>Mais um servi\u00e7o para manter</li> <li>Debug mais dif\u00edcil</li> </ul>"},{"location":"developer-guide/architecture/decisions/#adr-005-versionamento-de-hinarios","title":"ADR-005: Versionamento de Hin\u00e1rios","text":""},{"location":"developer-guide/architecture/decisions/#status_4","title":"Status","text":"<p>Aceito</p>"},{"location":"developer-guide/architecture/decisions/#contexto_4","title":"Contexto","text":"<p>Usu\u00e1rios podem fazer upload de hin\u00e1rios que j\u00e1 existem. Precisamos:</p> <ul> <li>Detectar duplicatas</li> <li>Permitir atualiza\u00e7\u00f5es</li> <li>Manter hist\u00f3rico</li> </ul>"},{"location":"developer-guide/architecture/decisions/#decisao_4","title":"Decis\u00e3o","text":"<p>Criar model <code>HymnBookVersion</code> para tracking.</p> <pre><code>class HymnBookVersion(models.Model):\n    original = models.ForeignKey(HymnBook)\n    uploaded_by = models.ForeignKey(User)\n    version_number = models.PositiveIntegerField()\n    changes = models.JSONField()\n    status = models.CharField(choices=STATUS_CHOICES)\n</code></pre>"},{"location":"developer-guide/architecture/decisions/#consequencias_4","title":"Consequ\u00eancias","text":"<p>Positivas:</p> <ul> <li>Hist\u00f3rico completo de mudan\u00e7as</li> <li>Possibilidade de rollback</li> <li>Atribui\u00e7\u00e3o de contribuidores</li> </ul> <p>Negativas:</p> <ul> <li>Complexidade adicional</li> <li>Mais espa\u00e7o em disco</li> <li>L\u00f3gica de merge complexa</li> </ul>"},{"location":"developer-guide/architecture/decisions/#adr-006-desambiguacao-fuzzy","title":"ADR-006: Desambigua\u00e7\u00e3o Fuzzy","text":""},{"location":"developer-guide/architecture/decisions/#status_5","title":"Status","text":"<p>Aceito</p>"},{"location":"developer-guide/architecture/decisions/#contexto_5","title":"Contexto","text":"<p>Detectar se um hin\u00e1rio novo \u00e9 duplicata de um existente usando fuzzy matching.</p>"},{"location":"developer-guide/architecture/decisions/#decisao_5","title":"Decis\u00e3o","text":"<p>Usar <code>difflib.SequenceMatcher</code> para calcular similaridade.</p> <pre><code>def calculate_string_similarity(str1: str, str2: str) -&gt; float:\n    if not str1 or not str2:\n        return 0.0\n    return SequenceMatcher(None, str1.lower(), str2.lower()).ratio()\n</code></pre>"},{"location":"developer-guide/architecture/decisions/#consequencias_5","title":"Consequ\u00eancias","text":"<p>Positivas:</p> <ul> <li>Sem depend\u00eancias externas</li> <li>R\u00e1pido para poucos registros</li> <li>Simples de entender</li> </ul> <p>Negativas:</p> <ul> <li>N\u00e3o escala para milh\u00f5es de registros</li> <li>Pode ter falsos positivos/negativos</li> <li>Threshold precisa de tuning</li> </ul>"},{"location":"developer-guide/architecture/decisions/#adr-007-playwright-para-e2e-tests","title":"ADR-007: Playwright para E2E Tests","text":""},{"location":"developer-guide/architecture/decisions/#status_6","title":"Status","text":"<p>Aceito</p>"},{"location":"developer-guide/architecture/decisions/#contexto_6","title":"Contexto","text":"<p>Precisamos de testes E2E para validar fluxos completos.</p> <p>Alternativas:</p> <ul> <li>Selenium</li> <li>Cypress</li> <li>Playwright</li> </ul>"},{"location":"developer-guide/architecture/decisions/#decisao_6","title":"Decis\u00e3o","text":"<p>Usar Playwright via pytest.</p>"},{"location":"developer-guide/architecture/decisions/#consequencias_6","title":"Consequ\u00eancias","text":"<p>Positivas:</p> <ul> <li>API moderna e simples</li> <li>Suporte nativo a pytest</li> <li>Cross-browser</li> <li>Auto-wait</li> </ul> <p>Negativas:</p> <ul> <li>Mais lento que testes unit\u00e1rios</li> <li>Requer servidor rodando</li> <li>Flaky tests poss\u00edveis</li> </ul>"},{"location":"developer-guide/architecture/decisions/#template-para-novas-adrs","title":"Template para Novas ADRs","text":"<pre><code>## ADR-XXX: [T\u00edtulo]\n\n### Status\n[Proposto | Aceito | Deprecated | Substitu\u00eddo]\n\n### Contexto\n[Descreva o problema e as for\u00e7as em jogo]\n\n### Decis\u00e3o\n[Descreva a decis\u00e3o tomada]\n\n### Consequ\u00eancias\n[Descreva o que acontece ap\u00f3s a decis\u00e3o]\n\n**Positivas:**\n- ...\n\n**Negativas:**\n- ...\n</code></pre>"},{"location":"developer-guide/architecture/overview/","title":"Arquitetura do Sistema","text":""},{"location":"developer-guide/architecture/overview/#visao-geral","title":"Vis\u00e3o Geral","text":"<p>O hyms-plat usa arquitetura monol\u00edtica Django com separa\u00e7\u00e3o de apps por dom\u00ednio.</p>"},{"location":"developer-guide/architecture/overview/#diagrama-de-arquitetura","title":"Diagrama de Arquitetura","text":"graph TB     subgraph \"Frontend\"         Browser[Browser/Client]     end      subgraph \"Application Layer\"         Django[Django 5.1]         Wagtail[Wagtail CMS]     end      subgraph \"Apps\"         Hymns[apps.hymns]         Search[apps.search]         Users[apps.users]         CMS[apps.cms]     end      subgraph \"Data Layer\"         PostgreSQL[(PostgreSQL 16)]         TypeSense[(TypeSense 27.1)]         Redis[(Redis 7)]     end      subgraph \"Background\"         Celery[Celery Workers]     end      Browser --&gt; Django     Django --&gt; Wagtail     Django --&gt; Hymns     Django --&gt; Search     Django --&gt; Users     Django --&gt; CMS      Hymns --&gt; PostgreSQL     Users --&gt; PostgreSQL     CMS --&gt; PostgreSQL     Search --&gt; TypeSense      Celery --&gt; Redis     Celery --&gt; PostgreSQL     Celery --&gt; TypeSense"},{"location":"developer-guide/architecture/overview/#apps-django","title":"Apps Django","text":""},{"location":"developer-guide/architecture/overview/#appshymns-core","title":"<code>apps/hymns/</code> (Core)","text":"<p>Responsabilidades:</p> <ul> <li>Models: HymnBook, Hymn, HymnBookVersion</li> <li>Views: Home, List, Detail</li> <li>Admin: Interface de gerenciamento</li> <li>Commands: import_yaml</li> </ul> <p>Depend\u00eancias:</p> <ul> <li><code>apps.search</code> - TypeSense integration</li> <li><code>apps.users</code> - FK owner_user</li> </ul>"},{"location":"developer-guide/architecture/overview/#appssearch","title":"<code>apps/search/</code>","text":"<p>Responsabilidades:</p> <ul> <li>TypeSense client wrapper</li> <li>Index/reindex functions</li> <li>Search queries</li> <li>Commands: reindex_typesense</li> </ul> <p>Depend\u00eancias:</p> <ul> <li><code>apps.hymns</code> - Hymn model</li> </ul>"},{"location":"developer-guide/architecture/overview/#appsusers","title":"<code>apps/users/</code>","text":"<p>Responsabilidades:</p> <ul> <li>Custom User model (bio, avatar)</li> <li>Upload e desambigua\u00e7\u00e3o</li> <li>Features sociais (favoritos, coment\u00e1rios, follows)</li> <li>Notifica\u00e7\u00f5es</li> </ul> <p>Depend\u00eancias:</p> <ul> <li>django-allauth</li> <li><code>apps.hymns</code></li> </ul>"},{"location":"developer-guide/architecture/overview/#appscms","title":"<code>apps/cms/</code>","text":"<p>Responsabilidades:</p> <ul> <li>Wagtail HomePage model</li> <li>CMS pages edit\u00e1veis</li> </ul> <p>Depend\u00eancias:</p> <ul> <li>Wagtail</li> </ul>"},{"location":"developer-guide/architecture/overview/#appscore","title":"<code>apps/core/</code>","text":"<p>Responsabilidades:</p> <ul> <li>Base mixins</li> <li>Common utilities</li> <li>Shared models</li> </ul>"},{"location":"developer-guide/architecture/overview/#fluxo-de-dados","title":"Fluxo de Dados","text":""},{"location":"developer-guide/architecture/overview/#1-importacao-yaml-db","title":"1. Importa\u00e7\u00e3o YAML \u2192 DB","text":"sequenceDiagram     participant Admin     participant Command     participant Validator     participant DB     participant TypeSense      Admin-&gt;&gt;Command: import_yaml hinario.yaml     Command-&gt;&gt;Validator: Valida YAML     Validator--&gt;&gt;Command: OK     Command-&gt;&gt;DB: Cria HymnBook + Hymns     DB--&gt;&gt;Command: Sucesso     Command-&gt;&gt;TypeSense: Indexa hinos     TypeSense--&gt;&gt;Command: Indexado     Command--&gt;&gt;Admin: Conclu\u00eddo"},{"location":"developer-guide/architecture/overview/#2-busca-de-usuario","title":"2. Busca de Usu\u00e1rio","text":"sequenceDiagram     participant User     participant View     participant TypeSense     participant DB      User-&gt;&gt;View: GET /busca/?q=lua     View-&gt;&gt;TypeSense: search_hymns(\"lua\")     TypeSense--&gt;&gt;View: [uuid1, uuid2, ...]     View-&gt;&gt;DB: Hymn.objects.filter(id__in=uuids)     DB--&gt;&gt;View: Hymn objects     View--&gt;&gt;User: Render results"},{"location":"developer-guide/architecture/overview/#3-upload-de-hinario","title":"3. Upload de Hin\u00e1rio","text":"sequenceDiagram     participant User     participant View     participant Validator     participant Disambiguator     participant DB     participant TypeSense      User-&gt;&gt;View: POST /contribuir/ (YAML file)     View-&gt;&gt;Validator: Valida YAML     Validator--&gt;&gt;View: Data dict     View-&gt;&gt;Disambiguator: find_duplicates(name)     alt Duplicata encontrada         Disambiguator--&gt;&gt;View: Similar hymnbooks         View--&gt;&gt;User: P\u00e1gina de desambigua\u00e7\u00e3o     else Novo hin\u00e1rio         View-&gt;&gt;DB: Cria HymnBookVersion         DB--&gt;&gt;View: Sucesso         View-&gt;&gt;TypeSense: Indexa         View--&gt;&gt;User: Sucesso     end"},{"location":"developer-guide/architecture/overview/#padroes-e-decisoes","title":"Padr\u00f5es e Decis\u00f5es","text":""},{"location":"developer-guide/architecture/overview/#uuid-como-primary-key","title":"UUID como Primary Key","text":"<p>Por qu\u00ea: Melhor para sistemas distribu\u00eddos, n\u00e3o exp\u00f5e contagem</p> <p>Trade-off: \u00cdndices maiores que auto-increment</p>"},{"location":"developer-guide/architecture/overview/#typesense-vs-elasticsearch","title":"TypeSense vs ElasticSearch","text":"<p>Por qu\u00ea: TypeSense \u00e9 mais simples, menor overhead, typo-tolerance nativo</p> <p>Trade-off: Menos features avan\u00e7adas que ElasticSearch</p>"},{"location":"developer-guide/architecture/overview/#celery-para-background-tasks","title":"Celery para Background Tasks","text":"<p>Por qu\u00ea: Upload, reindexa\u00e7\u00e3o s\u00e3o opera\u00e7\u00f5es lentas</p> <p>Trade-off: Mais complexidade operacional</p>"},{"location":"developer-guide/architecture/overview/#wagtail-cms","title":"Wagtail CMS","text":"<p>Por qu\u00ea: CMS Django-native para p\u00e1ginas edit\u00e1veis</p> <p>Trade-off: Overhead para features simples</p> <p>Veja Architecture Decisions para detalhes.</p>"},{"location":"developer-guide/architecture/search-architecture/","title":"Arquitetura de Busca","text":"<p>O projeto usa TypeSense como motor de busca principal.</p>"},{"location":"developer-guide/architecture/search-architecture/#por-que-typesense","title":"Por que TypeSense?","text":""},{"location":"developer-guide/architecture/search-architecture/#vantagens","title":"Vantagens","text":"Feature TypeSense ElasticSearch Setup Simples Complexo Typo-tolerance Nativo Plugin Mem\u00f3ria ~500MB ~2GB+ Lat\u00eancia &lt;10ms ~50ms Manuten\u00e7\u00e3o Baixa Alta"},{"location":"developer-guide/architecture/search-architecture/#trade-offs","title":"Trade-offs","text":"<ul> <li>Menos features avan\u00e7adas que ElasticSearch</li> <li>Comunidade menor</li> <li>Menos integra\u00e7\u00f5es prontas</li> </ul>"},{"location":"developer-guide/architecture/search-architecture/#arquitetura","title":"Arquitetura","text":"graph LR     subgraph \"Django\"         Models[Hymn Model]         Signals[post_save signal]         Views[Search View]     end      subgraph \"Search App\"         Client[TypeSense Client]         Indexer[Indexer]         Searcher[Searcher]     end      subgraph \"TypeSense\"         Collection[(hymns collection)]     end      Models --&gt; Signals     Signals --&gt; Indexer     Indexer --&gt; Client     Client --&gt; Collection      Views --&gt; Searcher     Searcher --&gt; Client     Client --&gt; Collection"},{"location":"developer-guide/architecture/search-architecture/#client-typesense","title":"Client TypeSense","text":""},{"location":"developer-guide/architecture/search-architecture/#configuracao","title":"Configura\u00e7\u00e3o","text":"<pre><code># apps/search/client.py\nimport typesense\n\nclient = typesense.Client({\n    'nodes': [{\n        'host': settings.TYPESENSE_HOST,\n        'port': settings.TYPESENSE_PORT,\n        'protocol': settings.TYPESENSE_PROTOCOL,\n    }],\n    'api_key': settings.TYPESENSE_API_KEY,\n    'connection_timeout_seconds': 2\n})\n</code></pre>"},{"location":"developer-guide/architecture/search-architecture/#schema","title":"Schema","text":"<pre><code>HYMNS_SCHEMA = {\n    'name': 'hymns',\n    'fields': [\n        {'name': 'id', 'type': 'string'},\n        {'name': 'hymn_book_id', 'type': 'string'},\n        {'name': 'hymn_book_name', 'type': 'string', 'facet': True},\n        {'name': 'hymn_book_slug', 'type': 'string'},\n        {'name': 'owner_name', 'type': 'string', 'facet': True},\n        {'name': 'number', 'type': 'int32', 'sort': True},\n        {'name': 'title', 'type': 'string'},\n        {'name': 'text', 'type': 'string'},\n        {'name': 'style', 'type': 'string', 'facet': True, 'optional': True},\n    ],\n    'default_sorting_field': 'number'\n}\n</code></pre>"},{"location":"developer-guide/architecture/search-architecture/#indexacao","title":"Indexa\u00e7\u00e3o","text":""},{"location":"developer-guide/architecture/search-architecture/#indexar-um-hino","title":"Indexar um Hino","text":"<pre><code>def index_hymn(hymn: Hymn) -&gt; None:\n    \"\"\"Indexa um hino no TypeSense.\"\"\"\n    document = {\n        'id': str(hymn.id),\n        'hymn_book_id': str(hymn.hymn_book_id),\n        'hymn_book_name': hymn.hymn_book.name,\n        'hymn_book_slug': hymn.hymn_book.slug,\n        'owner_name': hymn.hymn_book.owner_name,\n        'number': hymn.number,\n        'title': hymn.title,\n        'text': hymn.text,\n        'style': hymn.style or '',\n    }\n\n    client.collections['hymns'].documents.upsert(document)\n</code></pre>"},{"location":"developer-guide/architecture/search-architecture/#via-signal","title":"Via Signal","text":"<pre><code>@receiver(post_save, sender=Hymn)\ndef index_hymn_on_save(sender, instance, **kwargs):\n    \"\"\"Indexa automaticamente ao salvar.\"\"\"\n    index_hymn(instance)\n</code></pre>"},{"location":"developer-guide/architecture/search-architecture/#reindexacao-completa","title":"Reindexa\u00e7\u00e3o Completa","text":"<pre><code>poetry run python manage.py reindex_typesense\n</code></pre> <pre><code># apps/search/management/commands/reindex_typesense.py\nclass Command(BaseCommand):\n    def handle(self, *args, **options):\n        # Deleta collection existente\n        try:\n            client.collections['hymns'].delete()\n        except Exception:\n            pass\n\n        # Recria collection\n        client.collections.create(HYMNS_SCHEMA)\n\n        # Indexa todos os hinos\n        for hymn in Hymn.objects.select_related('hymn_book'):\n            index_hymn(hymn)\n</code></pre>"},{"location":"developer-guide/architecture/search-architecture/#busca","title":"Busca","text":""},{"location":"developer-guide/architecture/search-architecture/#funcao-de-busca","title":"Fun\u00e7\u00e3o de Busca","text":"<pre><code>def search_hymns(query: str, per_page: int = 20, page: int = 1) -&gt; dict:\n    \"\"\"Busca hinos no TypeSense.\"\"\"\n    search_parameters = {\n        'q': query,\n        'query_by': 'title,text,hymn_book_name,owner_name',\n        'per_page': per_page,\n        'page': page,\n        'typo_tolerance': True,\n    }\n\n    return client.collections['hymns'].documents.search(search_parameters)\n</code></pre>"},{"location":"developer-guide/architecture/search-architecture/#parametros-de-busca","title":"Par\u00e2metros de Busca","text":"Par\u00e2metro Descri\u00e7\u00e3o <code>query_by</code> Campos para buscar <code>per_page</code> Resultados por p\u00e1gina <code>typo_tolerance</code> Toler\u00e2ncia a erros <code>filter_by</code> Filtros (facets) <code>sort_by</code> Ordena\u00e7\u00e3o"},{"location":"developer-guide/architecture/search-architecture/#exemplo-com-filtros","title":"Exemplo com Filtros","text":"<pre><code>search_parameters = {\n    'q': 'lua',\n    'query_by': 'title,text',\n    'filter_by': 'hymn_book_name:=O Cruzeiro',\n    'sort_by': 'number:asc',\n}\n</code></pre>"},{"location":"developer-guide/architecture/search-architecture/#view-de-busca","title":"View de Busca","text":"<pre><code>def search_view(request):\n    query = request.GET.get('q', '')\n\n    if not query or len(query) &lt; 3:\n        return render(request, 'search/search.html', {'results': []})\n\n    # Busca no TypeSense\n    response = search_hymns(query)\n\n    # Busca objetos no Django (preservando ordem)\n    hymn_ids = [hit['document']['id'] for hit in response['hits']]\n    hymns = Hymn.objects.filter(id__in=hymn_ids)\n\n    # Preserva ordem do TypeSense\n    hymn_map = {str(h.id): h for h in hymns}\n    ordered_hymns = [hymn_map[id] for id in hymn_ids if id in hymn_map]\n\n    return render(request, 'search/search.html', {\n        'results': ordered_hymns,\n        'query': query,\n        'total': response['found'],\n    })\n</code></pre>"},{"location":"developer-guide/architecture/search-architecture/#troubleshooting","title":"Troubleshooting","text":""},{"location":"developer-guide/architecture/search-architecture/#typesense-nao-conecta","title":"TypeSense n\u00e3o conecta","text":"<pre><code># Verificar container\ndocker ps | grep typesense\n\n# Ver logs\ndocker logs typesense\n\n# Testar conex\u00e3o\ncurl http://localhost:8108/health\n</code></pre>"},{"location":"developer-guide/architecture/search-architecture/#resultados-desatualizados","title":"Resultados desatualizados","text":"<pre><code># Reindexar\npoetry run python manage.py reindex_typesense\n</code></pre>"},{"location":"developer-guide/architecture/search-architecture/#busca-lenta","title":"Busca lenta","text":"<ul> <li>Verifique recursos do container TypeSense</li> <li>Use pagina\u00e7\u00e3o adequada</li> <li>Limite campos em <code>query_by</code></li> </ul>"},{"location":"developer-guide/architecture/technology-stack/","title":"Stack Tecnol\u00f3gico","text":"<p>Vis\u00e3o detalhada das tecnologias utilizadas no projeto.</p>"},{"location":"developer-guide/architecture/technology-stack/#backend","title":"Backend","text":""},{"location":"developer-guide/architecture/technology-stack/#python-311","title":"Python 3.11+","text":"<p>Linguagem principal do projeto.</p> <p>Por que 3.11+:</p> <ul> <li>Performance melhorada</li> <li>Melhor mensagens de erro</li> <li><code>tomllib</code> nativo</li> <li>Typing improvements</li> </ul>"},{"location":"developer-guide/architecture/technology-stack/#django-51","title":"Django 5.1","text":"<p>Framework web principal.</p> <p>Features utilizadas:</p> <ul> <li>ORM completo</li> <li>Admin interface</li> <li>Form validation</li> <li>Signals</li> <li>Management commands</li> <li>Middleware</li> </ul> <p>Configura\u00e7\u00e3o:</p> <pre><code># config/settings/base.py\nINSTALLED_APPS = [\n    'django.contrib.admin',\n    'django.contrib.auth',\n    # ...\n    'apps.core',\n    'apps.hymns',\n    'apps.search',\n    'apps.users',\n    'apps.cms',\n]\n</code></pre>"},{"location":"developer-guide/architecture/technology-stack/#wagtail-64","title":"Wagtail 6.4","text":"<p>CMS para p\u00e1ginas edit\u00e1veis.</p> <p>Uso:</p> <ul> <li>HomePage customizada</li> <li>P\u00e1ginas de conte\u00fado est\u00e1tico</li> <li>StreamFields para conte\u00fado rico</li> </ul>"},{"location":"developer-guide/architecture/technology-stack/#banco-de-dados","title":"Banco de Dados","text":""},{"location":"developer-guide/architecture/technology-stack/#postgresql-16","title":"PostgreSQL 16","text":"<p>Banco de dados principal.</p> <p>Features utilizadas:</p> <ul> <li>UUID fields</li> <li>Full-text search (backup)</li> <li>JSONField</li> <li>Indexes</li> </ul> <p>Conex\u00e3o:</p> <pre><code>DATABASES = {\n    'default': {\n        'ENGINE': 'django.db.backends.postgresql',\n        'NAME': env('DATABASE_NAME'),\n        'USER': env('DATABASE_USER'),\n        'PASSWORD': env('DATABASE_PASSWORD'),\n        'HOST': env('DATABASE_HOST'),\n        'PORT': env('DATABASE_PORT', default='5432'),\n    }\n}\n</code></pre>"},{"location":"developer-guide/architecture/technology-stack/#busca","title":"Busca","text":""},{"location":"developer-guide/architecture/technology-stack/#typesense-271","title":"TypeSense 27.1","text":"<p>Motor de busca principal.</p> <p>Features:</p> <ul> <li>Typo-tolerance nativo</li> <li>Busca instant\u00e2nea</li> <li>Faceted search</li> <li>Relev\u00e2ncia configur\u00e1vel</li> </ul> <p>Schema dos hinos:</p> <pre><code>HYMNS_SCHEMA = {\n    'name': 'hymns',\n    'fields': [\n        {'name': 'id', 'type': 'string'},\n        {'name': 'title', 'type': 'string'},\n        {'name': 'text', 'type': 'string'},\n        {'name': 'hymn_book_name', 'type': 'string', 'facet': True},\n        {'name': 'owner_name', 'type': 'string', 'facet': True},\n        {'name': 'number', 'type': 'int32', 'sort': True},\n    ],\n    'default_sorting_field': 'number'\n}\n</code></pre>"},{"location":"developer-guide/architecture/technology-stack/#cache-e-queue","title":"Cache e Queue","text":""},{"location":"developer-guide/architecture/technology-stack/#redis-7","title":"Redis 7","text":"<p>Cache e message broker.</p> <p>Uso:</p> <ul> <li>Cache de sess\u00f5es</li> <li>Broker do Celery</li> <li>Cache de queries</li> </ul>"},{"location":"developer-guide/architecture/technology-stack/#celery-54","title":"Celery 5.4","text":"<p>Task queue para opera\u00e7\u00f5es ass\u00edncronas.</p> <p>Uso:</p> <ul> <li>Indexa\u00e7\u00e3o em batch</li> <li>Processamento de uploads</li> <li>Envio de emails</li> </ul>"},{"location":"developer-guide/architecture/technology-stack/#autenticacao","title":"Autentica\u00e7\u00e3o","text":""},{"location":"developer-guide/architecture/technology-stack/#django-allauth-65x","title":"django-allauth 65.x","text":"<p>Autentica\u00e7\u00e3o completa.</p> <p>Features:</p> <ul> <li>Login email/senha</li> <li>Login social (Google)</li> <li>Verifica\u00e7\u00e3o de email</li> <li>Recupera\u00e7\u00e3o de senha</li> </ul>"},{"location":"developer-guide/architecture/technology-stack/#frontend","title":"Frontend","text":""},{"location":"developer-guide/architecture/technology-stack/#templates-django","title":"Templates Django","text":"<p>Templates server-side com:</p> <ul> <li>Template inheritance</li> <li>Custom template tags</li> <li>Context processors</li> </ul>"},{"location":"developer-guide/architecture/technology-stack/#css-framework","title":"CSS Framework","text":"<p>Bootstrap 5 para estilos.</p>"},{"location":"developer-guide/architecture/technology-stack/#javascript","title":"JavaScript","text":"<p>Vanilla JS para intera\u00e7\u00f5es simples.</p>"},{"location":"developer-guide/architecture/technology-stack/#testes","title":"Testes","text":""},{"location":"developer-guide/architecture/technology-stack/#pytest-pytest-django","title":"pytest + pytest-django","text":"<p>Framework de testes.</p> <p>Plugins:</p> <ul> <li><code>pytest-cov</code> - Coverage</li> <li><code>pytest-django</code> - Django integration</li> <li><code>factory-boy</code> - Test factories</li> </ul>"},{"location":"developer-guide/architecture/technology-stack/#playwright","title":"Playwright","text":"<p>Testes E2E.</p> <p>Uso:</p> <ul> <li>Navega\u00e7\u00e3o</li> <li>Autentica\u00e7\u00e3o</li> <li>Upload</li> <li>Features sociais</li> </ul>"},{"location":"developer-guide/architecture/technology-stack/#qualidade-de-codigo","title":"Qualidade de C\u00f3digo","text":""},{"location":"developer-guide/architecture/technology-stack/#black","title":"Black","text":"<p>Formatador de c\u00f3digo.</p> <pre><code>poetry run black .\n</code></pre>"},{"location":"developer-guide/architecture/technology-stack/#isort","title":"isort","text":"<p>Ordena\u00e7\u00e3o de imports.</p> <pre><code>poetry run isort .\n</code></pre>"},{"location":"developer-guide/architecture/technology-stack/#ruff","title":"Ruff","text":"<p>Linter r\u00e1pido.</p> <pre><code>poetry run ruff check .\n</code></pre>"},{"location":"developer-guide/architecture/technology-stack/#cicd","title":"CI/CD","text":""},{"location":"developer-guide/architecture/technology-stack/#github-actions","title":"GitHub Actions","text":"<p>Pipeline de CI/CD.</p> <p>Jobs:</p> <ol> <li>Lint (Black, isort, Ruff)</li> <li>Unit Tests</li> <li>E2E Tests</li> </ol>"},{"location":"developer-guide/architecture/technology-stack/#docker","title":"Docker","text":""},{"location":"developer-guide/architecture/technology-stack/#servicos","title":"Servi\u00e7os","text":"<pre><code>services:\n  postgres:\n    image: postgres:16-alpine\n\n  redis:\n    image: redis:7-alpine\n\n  typesense:\n    image: typesense/typesense:27.1\n</code></pre>"},{"location":"developer-guide/architecture/technology-stack/#dependencias-principais","title":"Depend\u00eancias Principais","text":"<pre><code>[tool.poetry.dependencies]\npython = \"^3.11\"\ndjango = \"^5.1\"\nwagtail = \"^6.4\"\npsycopg2-binary = \"^2.9\"\ntypesense = \"^0.21\"\ndjango-allauth = \"^65.3\"\ncelery = \"^5.4\"\nredis = \"^5.2\"\npyyaml = \"^6.0\"\npillow = \"^11.1\"\n</code></pre> <p>Veja <code>pyproject.toml</code> para lista completa.</p>"},{"location":"developer-guide/contributing/code-style/","title":"Code Style","text":"<p>Padr\u00f5es de c\u00f3digo do projeto.</p>"},{"location":"developer-guide/contributing/code-style/#ferramentas","title":"Ferramentas","text":"<p>O projeto usa tr\u00eas ferramentas para garantir consist\u00eancia:</p> Ferramenta Fun\u00e7\u00e3o Black Formata\u00e7\u00e3o isort Ordena\u00e7\u00e3o de imports Ruff Linting"},{"location":"developer-guide/contributing/code-style/#black","title":"Black","text":"<p>Formatador autom\u00e1tico de c\u00f3digo Python.</p>"},{"location":"developer-guide/contributing/code-style/#configuracao","title":"Configura\u00e7\u00e3o","text":"<pre><code># pyproject.toml\n[tool.black]\nline-length = 120\ntarget-version = ['py311']\ninclude = '\\.pyi?$'\nexclude = '''\n/(\n    \\.git\n  | migrations\n)/\n'''\n</code></pre>"},{"location":"developer-guide/contributing/code-style/#uso","title":"Uso","text":"<pre><code># Formatar tudo\npoetry run black .\n\n# Checar sem modificar\npoetry run black --check .\n</code></pre>"},{"location":"developer-guide/contributing/code-style/#isort","title":"isort","text":"<p>Ordena\u00e7\u00e3o autom\u00e1tica de imports.</p>"},{"location":"developer-guide/contributing/code-style/#configuracao_1","title":"Configura\u00e7\u00e3o","text":"<pre><code># pyproject.toml\n[tool.isort]\nprofile = \"black\"\nline_length = 120\nskip = [\"migrations\", \".venv\"]\n</code></pre>"},{"location":"developer-guide/contributing/code-style/#uso_1","title":"Uso","text":"<pre><code># Ordenar imports\npoetry run isort .\n\n# Checar sem modificar\npoetry run isort --check-only .\n</code></pre>"},{"location":"developer-guide/contributing/code-style/#ruff","title":"Ruff","text":"<p>Linter r\u00e1pido para Python.</p>"},{"location":"developer-guide/contributing/code-style/#configuracao_2","title":"Configura\u00e7\u00e3o","text":"<pre><code># pyproject.toml\n[tool.ruff]\nline-length = 120\ntarget-version = \"py311\"\nexclude = [\"migrations\", \".venv\"]\n\n[tool.ruff.lint]\nselect = [\"E\", \"F\", \"W\", \"I\", \"N\", \"B\", \"C4\"]\nignore = [\"E501\"]\n</code></pre>"},{"location":"developer-guide/contributing/code-style/#regras-ativadas","title":"Regras Ativadas","text":"C\u00f3digo Descri\u00e7\u00e3o E pycodestyle errors F Pyflakes W pycodestyle warnings I isort N pep8-naming B flake8-bugbear C4 flake8-comprehensions"},{"location":"developer-guide/contributing/code-style/#uso_2","title":"Uso","text":"<pre><code># Checar\npoetry run ruff check .\n\n# Corrigir automaticamente\npoetry run ruff check --fix .\n</code></pre>"},{"location":"developer-guide/contributing/code-style/#pre-commit","title":"Pre-commit","text":"<p>Hooks autom\u00e1ticos antes de cada commit.</p>"},{"location":"developer-guide/contributing/code-style/#configuracao_3","title":"Configura\u00e7\u00e3o","text":"<pre><code># .pre-commit-config.yaml\nrepos:\n  - repo: https://github.com/psf/black\n    rev: 24.10.0\n    hooks:\n      - id: black\n\n  - repo: https://github.com/pycqa/isort\n    rev: 5.13.0\n    hooks:\n      - id: isort\n\n  - repo: https://github.com/astral-sh/ruff-pre-commit\n    rev: v0.8.0\n    hooks:\n      - id: ruff\n</code></pre>"},{"location":"developer-guide/contributing/code-style/#instalacao","title":"Instala\u00e7\u00e3o","text":"<pre><code>poetry run pre-commit install\n</code></pre>"},{"location":"developer-guide/contributing/code-style/#convencoes-de-codigo","title":"Conven\u00e7\u00f5es de C\u00f3digo","text":""},{"location":"developer-guide/contributing/code-style/#naming","title":"Naming","text":"<pre><code># Classes: PascalCase\nclass HymnBook:\n    pass\n\n# Fun\u00e7\u00f5es e vari\u00e1veis: snake_case\ndef get_hymn_count():\n    hymn_count = 10\n\n# Constantes: UPPER_SNAKE_CASE\nMAX_UPLOAD_SIZE = 10 * 1024 * 1024\n</code></pre>"},{"location":"developer-guide/contributing/code-style/#imports","title":"Imports","text":"<pre><code># Ordem: stdlib \u2192 third-party \u2192 local\nimport os\nfrom typing import Optional\n\nfrom django.db import models\n\nfrom apps.core.models import BaseModel\n</code></pre>"},{"location":"developer-guide/contributing/code-style/#docstrings","title":"Docstrings","text":"<pre><code>def calculate_similarity(str1: str, str2: str) -&gt; float:\n    \"\"\"Calcula similaridade entre duas strings.\n\n    Args:\n        str1: Primeira string\n        str2: Segunda string\n\n    Returns:\n        Valor entre 0.0 e 1.0\n\n    Raises:\n        ValueError: Se alguma string for None\n    \"\"\"\n    pass\n</code></pre>"},{"location":"developer-guide/contributing/code-style/#type-hints","title":"Type Hints","text":"<pre><code>from typing import Optional, List\n\ndef get_hymns(\n    hymn_book_id: str,\n    limit: Optional[int] = None\n) -&gt; List[Hymn]:\n    pass\n</code></pre>"},{"location":"developer-guide/contributing/code-style/#django-especifico","title":"Django Espec\u00edfico","text":""},{"location":"developer-guide/contributing/code-style/#models","title":"Models","text":"<pre><code>class Hymn(models.Model):\n    \"\"\"Docstring descrevendo o model.\"\"\"\n\n    # Campos organizados por tipo\n    id = models.UUIDField(primary_key=True)\n\n    hymn_book = models.ForeignKey(HymnBook)\n\n    title = models.CharField(max_length=255)\n    text = models.TextField()\n\n    created_at = models.DateTimeField(auto_now_add=True)\n\n    class Meta:\n        ordering = ['number']\n        verbose_name = \"Hino\"\n\n    def __str__(self):\n        return self.title\n</code></pre>"},{"location":"developer-guide/contributing/code-style/#views","title":"Views","text":"<pre><code>def hymn_detail(request, pk):\n    \"\"\"View para detalhes de um hino.\"\"\"\n    hymn = get_object_or_404(Hymn, pk=pk)\n    return render(request, 'hymns/detail.html', {'hymn': hymn})\n</code></pre>"},{"location":"developer-guide/contributing/code-style/#rodando-todas-as-verificacoes","title":"Rodando Todas as Verifica\u00e7\u00f5es","text":"<pre><code># Formatar\npoetry run black .\npoetry run isort .\n\n# Lint\npoetry run ruff check .\n\n# Testes\npoetry run pytest\n</code></pre> <p>O CI verifica tudo isso automaticamente.</p>"},{"location":"developer-guide/contributing/commit-guidelines/","title":"Commit Guidelines","text":"<p>Padr\u00f5es para mensagens de commit.</p>"},{"location":"developer-guide/contributing/commit-guidelines/#conventional-commits","title":"Conventional Commits","text":"<p>Usamos Conventional Commits:</p> <pre><code>&lt;type&gt;(&lt;scope&gt;): &lt;description&gt;\n\n[optional body]\n\n[optional footer]\n</code></pre>"},{"location":"developer-guide/contributing/commit-guidelines/#tipos","title":"Tipos","text":"Tipo Descri\u00e7\u00e3o <code>feat</code> Nova feature <code>fix</code> Bug fix <code>docs</code> Documenta\u00e7\u00e3o <code>style</code> Formata\u00e7\u00e3o (n\u00e3o afeta l\u00f3gica) <code>refactor</code> Refatora\u00e7\u00e3o <code>test</code> Testes <code>chore</code> Manuten\u00e7\u00e3o, deps, config <code>perf</code> Performance <code>ci</code> CI/CD"},{"location":"developer-guide/contributing/commit-guidelines/#exemplos","title":"Exemplos","text":""},{"location":"developer-guide/contributing/commit-guidelines/#feature","title":"Feature","text":"<pre><code>feat(hymns): adiciona filtro por estilo musical\n\nPermite filtrar hinos por estilo (Valsa, Marcha, etc)\nna p\u00e1gina de busca.\n</code></pre>"},{"location":"developer-guide/contributing/commit-guidelines/#bug-fix","title":"Bug Fix","text":"<pre><code>fix(search): corrige erro de encoding na busca\n\nO TypeSense n\u00e3o estava recebendo caracteres acentuados\ncorretamente. Agora normaliza para UTF-8 antes de enviar.\n\nFixes #123\n</code></pre>"},{"location":"developer-guide/contributing/commit-guidelines/#documentacao","title":"Documenta\u00e7\u00e3o","text":"<pre><code>docs: adiciona guia de contribui\u00e7\u00e3o\n\n- Como fazer fork\n- Workflow de PR\n- Code style\n</code></pre>"},{"location":"developer-guide/contributing/commit-guidelines/#refatoracao","title":"Refatora\u00e7\u00e3o","text":"<pre><code>refactor(views): extrai l\u00f3gica de valida\u00e7\u00e3o para form\n\nMove valida\u00e7\u00e3o de YAML do view para o form,\nseguindo padr\u00e3o Django.\n</code></pre>"},{"location":"developer-guide/contributing/commit-guidelines/#testes","title":"Testes","text":"<pre><code>test(e2e): adiciona testes de navega\u00e7\u00e3o\n\n- test_home_page_loads\n- test_hymnbook_list\n- test_hymn_detail\n</code></pre>"},{"location":"developer-guide/contributing/commit-guidelines/#chore","title":"Chore","text":"<pre><code>chore(deps): atualiza Django para 5.1.1\n\nInclui security patches.\n</code></pre>"},{"location":"developer-guide/contributing/commit-guidelines/#boas-praticas","title":"Boas Pr\u00e1ticas","text":""},{"location":"developer-guide/contributing/commit-guidelines/#descricao","title":"Descri\u00e7\u00e3o","text":"<ul> <li>Use imperativo: \"adiciona\" n\u00e3o \"adicionado\"</li> <li>Primeira letra min\u00fascula</li> <li>Sem ponto final</li> <li>M\u00e1ximo 72 caracteres</li> </ul>"},{"location":"developer-guide/contributing/commit-guidelines/#body","title":"Body","text":"<ul> <li>Explique O QUE e POR QUE</li> <li>Pule uma linha ap\u00f3s o t\u00edtulo</li> <li>Quebre em 72 caracteres</li> </ul>"},{"location":"developer-guide/contributing/commit-guidelines/#footer","title":"Footer","text":"<ul> <li><code>Fixes #123</code> - Fecha issue</li> <li><code>Closes #123</code> - Fecha issue</li> <li><code>BREAKING CHANGE:</code> - Mudan\u00e7a incompat\u00edvel</li> </ul>"},{"location":"developer-guide/contributing/commit-guidelines/#co-authored-by","title":"Co-Authored-By","text":"<p>Quando usando Claude Code ou pair programming:</p> <pre><code>feat: adiciona sistema de favoritos\n\nCo-Authored-By: Claude Opus 4.5 &lt;noreply@anthropic.com&gt;\n</code></pre>"},{"location":"developer-guide/contributing/commit-guidelines/#commits-atomicos","title":"Commits At\u00f4micos","text":""},{"location":"developer-guide/contributing/commit-guidelines/#bom","title":"Bom","text":"<pre><code>feat(hymns): adiciona model Favorite\nfeat(hymns): adiciona view de favoritos\nfeat(hymns): adiciona template de favoritos\ntest(hymns): adiciona testes de favoritos\n</code></pre>"},{"location":"developer-guide/contributing/commit-guidelines/#ruim","title":"Ruim","text":"<pre><code>feat: adiciona favoritos, corrige bug, atualiza docs, refatora views\n</code></pre>"},{"location":"developer-guide/contributing/commit-guidelines/#squash","title":"Squash","text":"<p>Ao fazer merge, commits s\u00e3o combinados (squash). O t\u00edtulo do PR vira a mensagem do commit.</p>"},{"location":"developer-guide/contributing/commit-guidelines/#dicas","title":"Dicas","text":""},{"location":"developer-guide/contributing/commit-guidelines/#amend","title":"Amend","text":"<pre><code># Corrigir \u00faltimo commit\ngit commit --amend -m \"nova mensagem\"\n</code></pre>"},{"location":"developer-guide/contributing/commit-guidelines/#interactive-rebase","title":"Interactive Rebase","text":"<pre><code># Reorganizar commits antes de PR\ngit rebase -i HEAD~3\n</code></pre>"},{"location":"developer-guide/contributing/commit-guidelines/#hooks","title":"Hooks","text":"<p>Pre-commit pode validar mensagens:</p> <pre><code># .pre-commit-config.yaml\nrepos:\n  - repo: https://github.com/compilerla/conventional-pre-commit\n    rev: v3.0.0\n    hooks:\n      - id: conventional-pre-commit\n</code></pre>"},{"location":"developer-guide/contributing/getting-started/","title":"Como Contribuir","text":"<p>Obrigado pelo interesse em contribuir com o projeto!</p>"},{"location":"developer-guide/contributing/getting-started/#primeiros-passos","title":"Primeiros Passos","text":""},{"location":"developer-guide/contributing/getting-started/#1-fork-o-repositorio","title":"1. Fork o Reposit\u00f3rio","text":"<p>No GitHub, clique em Fork para criar sua c\u00f3pia.</p>"},{"location":"developer-guide/contributing/getting-started/#2-clone-seu-fork","title":"2. Clone seu Fork","text":"<pre><code>git clone https://github.com/seu-usuario/hyms-plat.git\ncd hyms-plat\n</code></pre>"},{"location":"developer-guide/contributing/getting-started/#3-configure-upstream","title":"3. Configure Upstream","text":"<pre><code>git remote add upstream https://github.com/nitai-bezerra/hyms-plat.git\n</code></pre>"},{"location":"developer-guide/contributing/getting-started/#4-setup-local","title":"4. Setup Local","text":"<p>Siga o guia de setup local.</p>"},{"location":"developer-guide/contributing/getting-started/#workflow","title":"Workflow","text":""},{"location":"developer-guide/contributing/getting-started/#1-sincronize-com-upstream","title":"1. Sincronize com Upstream","text":"<pre><code>git fetch upstream\ngit checkout main\ngit merge upstream/main\n</code></pre>"},{"location":"developer-guide/contributing/getting-started/#2-crie-uma-branch","title":"2. Crie uma Branch","text":"<pre><code>git checkout -b feat/minha-feature\n</code></pre> <p>Conven\u00e7\u00e3o de nomes:</p> <ul> <li><code>feat/</code> - Nova feature</li> <li><code>fix/</code> - Bug fix</li> <li><code>docs/</code> - Documenta\u00e7\u00e3o</li> <li><code>refactor/</code> - Refatora\u00e7\u00e3o</li> <li><code>test/</code> - Testes</li> </ul>"},{"location":"developer-guide/contributing/getting-started/#3-faca-suas-mudancas","title":"3. Fa\u00e7a suas Mudan\u00e7as","text":"<ul> <li>Escreva c\u00f3digo</li> <li>Adicione testes</li> <li>Documente se necess\u00e1rio</li> </ul>"},{"location":"developer-guide/contributing/getting-started/#4-formate-o-codigo","title":"4. Formate o C\u00f3digo","text":"<pre><code>poetry run black .\npoetry run isort .\npoetry run ruff check --fix .\n</code></pre>"},{"location":"developer-guide/contributing/getting-started/#5-rode-os-testes","title":"5. Rode os Testes","text":"<pre><code>poetry run pytest\n</code></pre>"},{"location":"developer-guide/contributing/getting-started/#6-commit","title":"6. Commit","text":"<pre><code>git add .\ngit commit -m \"feat: adiciona funcionalidade X\"\n</code></pre> <p>Veja Commit Guidelines.</p>"},{"location":"developer-guide/contributing/getting-started/#7-push","title":"7. Push","text":"<pre><code>git push origin feat/minha-feature\n</code></pre>"},{"location":"developer-guide/contributing/getting-started/#8-abra-pull-request","title":"8. Abra Pull Request","text":"<p>No GitHub, abra um PR do seu fork para o reposit\u00f3rio original.</p>"},{"location":"developer-guide/contributing/getting-started/#tipos-de-contribuicao","title":"Tipos de Contribui\u00e7\u00e3o","text":""},{"location":"developer-guide/contributing/getting-started/#codigo","title":"C\u00f3digo","text":"<ul> <li>Novas features</li> <li>Bug fixes</li> <li>Refatora\u00e7\u00f5es</li> <li>Performance</li> </ul>"},{"location":"developer-guide/contributing/getting-started/#documentacao","title":"Documenta\u00e7\u00e3o","text":"<ul> <li>Corrigir erros</li> <li>Melhorar clareza</li> <li>Adicionar exemplos</li> <li>Traduzir</li> </ul>"},{"location":"developer-guide/contributing/getting-started/#testes","title":"Testes","text":"<ul> <li>Aumentar coverage</li> <li>Testes E2E</li> <li>Testes de edge cases</li> </ul>"},{"location":"developer-guide/contributing/getting-started/#issues","title":"Issues","text":"<ul> <li>Reportar bugs</li> <li>Sugerir features</li> <li>Tirar d\u00favidas</li> </ul>"},{"location":"developer-guide/contributing/getting-started/#boas-praticas","title":"Boas Pr\u00e1ticas","text":""},{"location":"developer-guide/contributing/getting-started/#codigo_1","title":"C\u00f3digo","text":"<ul> <li>Siga o code style do projeto</li> <li>Escreva testes para c\u00f3digo novo</li> <li>Documente fun\u00e7\u00f5es p\u00fablicas</li> <li>Mantenha commits pequenos e focados</li> </ul>"},{"location":"developer-guide/contributing/getting-started/#pull-requests","title":"Pull Requests","text":"<ul> <li>Um PR = uma feature/fix</li> <li>Descreva claramente as mudan\u00e7as</li> <li>Referencie issues relacionadas</li> <li>Responda aos code reviews</li> </ul>"},{"location":"developer-guide/contributing/getting-started/#issues_1","title":"Issues","text":"<ul> <li>Verifique se j\u00e1 existe antes de criar</li> <li>Use templates quando dispon\u00edveis</li> <li>Forne\u00e7a informa\u00e7\u00f5es detalhadas</li> </ul>"},{"location":"developer-guide/contributing/getting-started/#processo-de-review","title":"Processo de Review","text":"<ol> <li>Abra PR</li> <li>CI roda automaticamente</li> <li>Maintainer faz code review</li> <li>Ajustes se necess\u00e1rio</li> <li>Aprova\u00e7\u00e3o e merge</li> </ol>"},{"location":"developer-guide/contributing/getting-started/#duvidas","title":"D\u00favidas?","text":"<p>Abra uma issue de discuss\u00e3o.</p>"},{"location":"developer-guide/contributing/pull-requests/","title":"Pull Requests","text":"<p>Guia para criar e revisar Pull Requests.</p>"},{"location":"developer-guide/contributing/pull-requests/#antes-de-criar","title":"Antes de Criar","text":"<ul> <li>[ ] C\u00f3digo formatado (<code>black</code>, <code>isort</code>)</li> <li>[ ] Lint passa (<code>ruff check</code>)</li> <li>[ ] Testes passam (<code>pytest</code>)</li> <li>[ ] Testes adicionados para c\u00f3digo novo</li> <li>[ ] Documenta\u00e7\u00e3o atualizada se necess\u00e1rio</li> </ul>"},{"location":"developer-guide/contributing/pull-requests/#criando-um-pr","title":"Criando um PR","text":""},{"location":"developer-guide/contributing/pull-requests/#1-push-da-branch","title":"1. Push da Branch","text":"<pre><code>git push origin feat/minha-feature\n</code></pre>"},{"location":"developer-guide/contributing/pull-requests/#2-abra-o-pr-no-github","title":"2. Abra o PR no GitHub","text":"<ul> <li>V\u00e1 para o reposit\u00f3rio</li> <li>Clique em \"Compare &amp; pull request\"</li> </ul>"},{"location":"developer-guide/contributing/pull-requests/#3-preencha-o-template","title":"3. Preencha o Template","text":"<pre><code>## Descri\u00e7\u00e3o\n\nBreve descri\u00e7\u00e3o das mudan\u00e7as.\n\n## Tipo de Mudan\u00e7a\n\n- [ ] Bug fix\n- [ ] Nova feature\n- [ ] Breaking change\n- [ ] Documenta\u00e7\u00e3o\n\n## Como Testar\n\n1. Passo 1\n2. Passo 2\n3. Passo 3\n\n## Checklist\n\n- [ ] Meu c\u00f3digo segue o style guide\n- [ ] Adicionei testes\n- [ ] Documenta\u00e7\u00e3o atualizada\n- [ ] CI passa\n\n## Issues Relacionadas\n\nCloses #123\n</code></pre>"},{"location":"developer-guide/contributing/pull-requests/#4-aguarde-review","title":"4. Aguarde Review","text":"<p>Um maintainer ir\u00e1 revisar seu PR.</p>"},{"location":"developer-guide/contributing/pull-requests/#boas-praticas","title":"Boas Pr\u00e1ticas","text":""},{"location":"developer-guide/contributing/pull-requests/#tamanho","title":"Tamanho","text":"<ul> <li>PRs pequenos s\u00e3o mais f\u00e1ceis de revisar</li> <li>Uma feature/fix por PR</li> <li>Se for grande, divida em PRs menores</li> </ul>"},{"location":"developer-guide/contributing/pull-requests/#titulo","title":"T\u00edtulo","text":"<p>Use Conventional Commits:</p> <pre><code>feat: adiciona sistema de favoritos\nfix: corrige bug na busca\ndocs: atualiza README\nrefactor: reorganiza views\ntest: adiciona testes E2E\n</code></pre>"},{"location":"developer-guide/contributing/pull-requests/#descricao","title":"Descri\u00e7\u00e3o","text":"<ul> <li>Explique O QUE mudou</li> <li>Explique POR QUE mudou</li> <li>Screenshots se houver mudan\u00e7as visuais</li> <li>Como testar manualmente</li> </ul>"},{"location":"developer-guide/contributing/pull-requests/#commits","title":"Commits","text":"<ul> <li>Commits pequenos e focados</li> <li>Mensagens claras</li> <li>Veja Commit Guidelines</li> </ul>"},{"location":"developer-guide/contributing/pull-requests/#code-review","title":"Code Review","text":""},{"location":"developer-guide/contributing/pull-requests/#como-reviewer","title":"Como Reviewer","text":"<ul> <li>Seja construtivo</li> <li>Sugira melhorias espec\u00edficas</li> <li>Aprove quando estiver pronto</li> <li>Use aprova\u00e7\u00e3o com sugest\u00f5es quando houver pequenos ajustes</li> </ul>"},{"location":"developer-guide/contributing/pull-requests/#como-autor","title":"Como Autor","text":"<ul> <li>Responda a todos os coment\u00e1rios</li> <li>N\u00e3o leve para o lado pessoal</li> <li>Fa\u00e7a as mudan\u00e7as solicitadas</li> <li>Pe\u00e7a esclarecimento se n\u00e3o entender</li> </ul>"},{"location":"developer-guide/contributing/pull-requests/#merge","title":"Merge","text":""},{"location":"developer-guide/contributing/pull-requests/#requisitos","title":"Requisitos","text":"<ul> <li>[ ] CI passou</li> <li>[ ] Aprovado por reviewer</li> <li>[ ] Sem conflitos</li> <li>[ ] Branch atualizada com main</li> </ul>"},{"location":"developer-guide/contributing/pull-requests/#tipo-de-merge","title":"Tipo de Merge","text":"<p>Usamos Squash and merge para:</p> <ul> <li>Hist\u00f3rico limpo</li> <li>Um commit por PR</li> <li>Mensagem de commit clara</li> </ul>"},{"location":"developer-guide/contributing/pull-requests/#apos-o-merge","title":"Ap\u00f3s o Merge","text":"<ul> <li>Branch \u00e9 deletada automaticamente</li> <li>Issue \u00e9 fechada automaticamente (se linked)</li> <li>Deploy autom\u00e1tico para staging (se configurado)</li> </ul>"},{"location":"developer-guide/contributing/pull-requests/#troubleshooting","title":"Troubleshooting","text":""},{"location":"developer-guide/contributing/pull-requests/#ci-falhou","title":"CI Falhou","text":"<pre><code># Ver logs no GitHub Actions\n# Corrigir localmente\npoetry run black .\npoetry run isort .\npoetry run ruff check --fix .\npoetry run pytest\n\n# Push novamente\ngit add .\ngit commit --amend\ngit push -f origin feat/minha-feature\n</code></pre>"},{"location":"developer-guide/contributing/pull-requests/#conflitos","title":"Conflitos","text":"<pre><code># Atualizar branch\ngit fetch upstream\ngit rebase upstream/main\n\n# Resolver conflitos\n# Editar arquivos conflitantes\ngit add .\ngit rebase --continue\n\n# Push\ngit push -f origin feat/minha-feature\n</code></pre>"},{"location":"developer-guide/contributing/pull-requests/#mudancas-solicitadas","title":"Mudan\u00e7as Solicitadas","text":"<pre><code># Fazer mudan\u00e7as\ngit add .\ngit commit -m \"fix: aplica sugest\u00f5es do review\"\ngit push origin feat/minha-feature\n</code></pre>"},{"location":"developer-guide/contributing/testing/","title":"Escrevendo Testes","text":"<p>Guia para escrever testes no projeto.</p>"},{"location":"developer-guide/contributing/testing/#visao-geral","title":"Vis\u00e3o Geral","text":"<p>O projeto usa:</p> <ul> <li>pytest - Framework de testes</li> <li>pytest-django - Integra\u00e7\u00e3o com Django</li> <li>pytest-cov - Coverage</li> <li>factory-boy - Test factories</li> <li>Playwright - Testes E2E</li> </ul>"},{"location":"developer-guide/contributing/testing/#estrutura","title":"Estrutura","text":"<pre><code>tests/\n\u251c\u2500\u2500 unit/                    # Testes unit\u00e1rios\n\u2502   \u251c\u2500\u2500 test_models.py\n\u2502   \u251c\u2500\u2500 test_views.py\n\u2502   \u2514\u2500\u2500 ...\n\u251c\u2500\u2500 e2e/                     # Testes end-to-end\n\u2502   \u251c\u2500\u2500 conftest.py\n\u2502   \u251c\u2500\u2500 test_navigation.py\n\u2502   \u2514\u2500\u2500 ...\n\u251c\u2500\u2500 conftest.py              # Fixtures globais\n\u2514\u2500\u2500 fixtures/                # Arquivos de teste\n    \u2514\u2500\u2500 test_hymnbook.yaml\n</code></pre>"},{"location":"developer-guide/contributing/testing/#testes-unitarios","title":"Testes Unit\u00e1rios","text":""},{"location":"developer-guide/contributing/testing/#convencoes","title":"Conven\u00e7\u00f5es","text":"<pre><code># tests/unit/test_models.py\nimport pytest\nfrom apps.hymns.models import Hymn, HymnBook\n\n\nclass TestHymnBook:\n    \"\"\"Testes para o model HymnBook.\"\"\"\n\n    def test_str_returns_name(self, hymnbook):\n        \"\"\"__str__ deve retornar o nome.\"\"\"\n        assert str(hymnbook) == hymnbook.name\n\n    def test_hymn_count_returns_correct_value(self, hymnbook_with_hymns):\n        \"\"\"hymn_count deve retornar quantidade correta.\"\"\"\n        assert hymnbook_with_hymns.hymn_count == 5\n</code></pre>"},{"location":"developer-guide/contributing/testing/#fixtures","title":"Fixtures","text":"<pre><code># tests/conftest.py\nimport pytest\nfrom apps.hymns.models import HymnBook, Hymn\n\n\n@pytest.fixture\ndef hymnbook(db):\n    \"\"\"Cria um HymnBook b\u00e1sico.\"\"\"\n    return HymnBook.objects.create(\n        name=\"Test Hymnbook\",\n        owner_name=\"Test Owner\"\n    )\n\n\n@pytest.fixture\ndef hymnbook_with_hymns(hymnbook):\n    \"\"\"Cria HymnBook com 5 hinos.\"\"\"\n    for i in range(1, 6):\n        Hymn.objects.create(\n            hymn_book=hymnbook,\n            number=i,\n            title=f\"Hymn {i}\",\n            text=f\"Text for hymn {i}\"\n        )\n    return hymnbook\n</code></pre>"},{"location":"developer-guide/contributing/testing/#factories","title":"Factories","text":"<pre><code># tests/factories.py\nimport factory\nfrom apps.hymns.models import HymnBook, Hymn\n\n\nclass HymnBookFactory(factory.django.DjangoModelFactory):\n    class Meta:\n        model = HymnBook\n\n    name = factory.Sequence(lambda n: f\"Hymnbook {n}\")\n    owner_name = factory.Faker('name')\n\n\nclass HymnFactory(factory.django.DjangoModelFactory):\n    class Meta:\n        model = Hymn\n\n    hymn_book = factory.SubFactory(HymnBookFactory)\n    number = factory.Sequence(lambda n: n + 1)\n    title = factory.Faker('sentence', nb_words=3)\n    text = factory.Faker('paragraph')\n</code></pre>"},{"location":"developer-guide/contributing/testing/#testes-e2e","title":"Testes E2E","text":""},{"location":"developer-guide/contributing/testing/#setup","title":"Setup","text":"<pre><code># tests/e2e/conftest.py\nimport pytest\nfrom playwright.sync_api import sync_playwright\n\n\n@pytest.fixture(scope=\"session\")\ndef browser():\n    with sync_playwright() as p:\n        browser = p.chromium.launch(headless=True)\n        yield browser\n        browser.close()\n\n\n@pytest.fixture\ndef page(browser):\n    context = browser.new_context()\n    page = context.new_page()\n    yield page\n    page.close()\n    context.close()\n\n\n@pytest.fixture\ndef base_url():\n    return \"http://localhost:9000\"\n</code></pre>"},{"location":"developer-guide/contributing/testing/#exemplo","title":"Exemplo","text":"<pre><code># tests/e2e/test_navigation.py\nimport pytest\nfrom playwright.sync_api import Page, expect\n\n\n@pytest.mark.e2e\nclass TestNavigation:\n    def test_home_page_loads(self, page: Page, base_url: str):\n        page.goto(base_url)\n        expect(page.locator(\"h1\")).to_be_visible()\n\n    def test_search_works(self, page: Page, base_url: str):\n        page.goto(f\"{base_url}/busca/\")\n        page.fill('input[name=\"q\"]', \"lua\")\n        page.click('button[type=\"submit\"]')\n        expect(page.locator(\".card\")).to_be_visible()\n</code></pre>"},{"location":"developer-guide/contributing/testing/#rodando-testes","title":"Rodando Testes","text":"<pre><code># Todos os testes unit\u00e1rios\npoetry run pytest tests/unit/\n\n# Teste espec\u00edfico\npoetry run pytest tests/unit/test_models.py::TestHymnBook::test_str_returns_name\n\n# Com coverage\npoetry run pytest --cov=apps --cov-report=html\n\n# Testes E2E (servidor deve estar rodando)\npoetry run pytest tests/e2e/ -v\n</code></pre>"},{"location":"developer-guide/contributing/testing/#boas-praticas","title":"Boas Pr\u00e1ticas","text":""},{"location":"developer-guide/contributing/testing/#nomenclatura","title":"Nomenclatura","text":"<pre><code># Classe: Test + Nome do que est\u00e1 testando\nclass TestHymnBook:\n    # M\u00e9todo: test_ + comportamento esperado\n    def test_str_returns_name(self):\n        pass\n</code></pre>"},{"location":"developer-guide/contributing/testing/#arrange-act-assert","title":"Arrange-Act-Assert","text":"<pre><code>def test_hymn_creation(self, hymnbook):\n    # Arrange\n    title = \"New Hymn\"\n    text = \"Hymn lyrics\"\n\n    # Act\n    hymn = Hymn.objects.create(\n        hymn_book=hymnbook,\n        number=1,\n        title=title,\n        text=text\n    )\n\n    # Assert\n    assert hymn.title == title\n    assert hymn.text == text\n</code></pre>"},{"location":"developer-guide/contributing/testing/#isolamento","title":"Isolamento","text":"<ul> <li>Cada teste deve ser independente</li> <li>Use fixtures para setup</li> <li>Limpe ap\u00f3s o teste se necess\u00e1rio</li> </ul>"},{"location":"developer-guide/contributing/testing/#coverage","title":"Coverage","text":"<p>Meta m\u00ednima: 80%</p> <pre><code># Ver coverage detalhado\npoetry run pytest --cov=apps --cov-report=html\nopen htmlcov/index.html\n</code></pre>"},{"location":"developer-guide/contributing/testing/#ci","title":"CI","text":"<p>Testes rodam automaticamente no GitHub Actions:</p> <ol> <li>Lint (Black, isort, Ruff)</li> <li>Unit Tests</li> <li>E2E Tests</li> </ol> <p>Todos devem passar para merge.</p>"},{"location":"developer-guide/deployment/backup-restore/","title":"Backup e Restore","text":"<p>Estrat\u00e9gias de backup e recupera\u00e7\u00e3o.</p>"},{"location":"developer-guide/deployment/backup-restore/#o-que-fazer-backup","title":"O que Fazer Backup","text":"Componente Cr\u00edtico Frequ\u00eancia PostgreSQL Sim Di\u00e1rio Media files Sim Di\u00e1rio TypeSense data N\u00e3o* Semanal Redis N\u00e3o N\u00e3o .env Sim Sob demanda <p>*TypeSense pode ser reindexado a partir do PostgreSQL.</p>"},{"location":"developer-guide/deployment/backup-restore/#postgresql","title":"PostgreSQL","text":""},{"location":"developer-guide/deployment/backup-restore/#backup-manual","title":"Backup Manual","text":"<pre><code># Dump completo\npg_dump -U hymsplat hymsplat &gt; backup_$(date +%Y%m%d).sql\n\n# Dump comprimido\npg_dump -U hymsplat hymsplat | gzip &gt; backup_$(date +%Y%m%d).sql.gz\n\n# Dump custom format (mais r\u00e1pido para restore)\npg_dump -Fc -U hymsplat hymsplat &gt; backup_$(date +%Y%m%d).dump\n</code></pre>"},{"location":"developer-guide/deployment/backup-restore/#restore","title":"Restore","text":"<pre><code># SQL plain\npsql -U hymsplat hymsplat &lt; backup.sql\n\n# Gzip\ngunzip -c backup.sql.gz | psql -U hymsplat hymsplat\n\n# Custom format\npg_restore -d hymsplat backup.dump\n</code></pre>"},{"location":"developer-guide/deployment/backup-restore/#backup-automatico","title":"Backup Autom\u00e1tico","text":"<pre><code># /etc/cron.d/hymsplat-backup\n0 3 * * * hymsplat /home/hymsplat/scripts/backup.sh\n</code></pre> <pre><code>#!/bin/bash\n# /home/hymsplat/scripts/backup.sh\n\nBACKUP_DIR=\"/home/hymsplat/backups\"\nDATE=$(date +%Y%m%d_%H%M%S)\n\n# Database\npg_dump -Fc -U hymsplat hymsplat &gt; $BACKUP_DIR/db_$DATE.dump\n\n# Media\ntar -czf $BACKUP_DIR/media_$DATE.tar.gz /home/hymsplat/hyms-plat/media/\n\n# Limpar backups antigos (manter \u00faltimos 7 dias)\nfind $BACKUP_DIR -type f -mtime +7 -delete\n\n# Upload para S3 (opcional)\naws s3 cp $BACKUP_DIR/db_$DATE.dump s3://hymsplat-backups/\naws s3 cp $BACKUP_DIR/media_$DATE.tar.gz s3://hymsplat-backups/\n</code></pre>"},{"location":"developer-guide/deployment/backup-restore/#media-files","title":"Media Files","text":""},{"location":"developer-guide/deployment/backup-restore/#backup","title":"Backup","text":"<pre><code># Tar completo\ntar -czf media_backup.tar.gz /home/hymsplat/hyms-plat/media/\n\n# Rsync para outro servidor\nrsync -avz /home/hymsplat/hyms-plat/media/ backup-server:/backups/media/\n</code></pre>"},{"location":"developer-guide/deployment/backup-restore/#restore_1","title":"Restore","text":"<pre><code># Extrair\ntar -xzf media_backup.tar.gz -C /home/hymsplat/hyms-plat/\n\n# Permiss\u00f5es\nchown -R hymsplat:hymsplat /home/hymsplat/hyms-plat/media/\n</code></pre>"},{"location":"developer-guide/deployment/backup-restore/#typesense","title":"TypeSense","text":""},{"location":"developer-guide/deployment/backup-restore/#backup_1","title":"Backup","text":"<pre><code># Snapshot via API\ncurl -X POST \"http://localhost:8108/operations/snapshot?snapshot_path=/backups/typesense\" \\\n  -H \"X-TYPESENSE-API-KEY: xyz\"\n</code></pre>"},{"location":"developer-guide/deployment/backup-restore/#restore_2","title":"Restore","text":"<p>Geralmente \u00e9 mais f\u00e1cil reindexar:</p> <pre><code>poetry run python manage.py reindex_typesense\n</code></pre>"},{"location":"developer-guide/deployment/backup-restore/#configuracoes","title":"Configura\u00e7\u00f5es","text":""},{"location":"developer-guide/deployment/backup-restore/#env","title":".env","text":"<pre><code># Backup\ncp .env .env.backup_$(date +%Y%m%d)\n\n# N\u00e3o commitar .env!\n# Guarde em local seguro (1Password, Vault, etc)\n</code></pre>"},{"location":"developer-guide/deployment/backup-restore/#disaster-recovery","title":"Disaster Recovery","text":""},{"location":"developer-guide/deployment/backup-restore/#cenario-perda-total","title":"Cen\u00e1rio: Perda Total","text":"<ol> <li> <p>Provisionar novo servidor <pre><code># Usar Terraform/Ansible ou manual\n</code></pre></p> </li> <li> <p>Restaurar configura\u00e7\u00f5es <pre><code># Clone do repo\ngit clone https://github.com/nitai-bezerra/hyms-plat.git\ncd hyms-plat\n\n# Restaurar .env\ncp /backup/.env.backup .env\n</code></pre></p> </li> <li> <p>Restaurar database <pre><code># Criar DB\nsudo -u postgres createdb hymsplat\n\n# Restore\npg_restore -d hymsplat /backup/db_latest.dump\n</code></pre></p> </li> <li> <p>Restaurar media <pre><code>tar -xzf /backup/media_latest.tar.gz -C /home/hymsplat/hyms-plat/\n</code></pre></p> </li> <li> <p>Setup aplica\u00e7\u00e3o <pre><code>poetry install --only main\npython manage.py collectstatic --noinput\npython manage.py reindex_typesense\n</code></pre></p> </li> <li> <p>Iniciar servi\u00e7os <pre><code>sudo systemctl start hymsplat\nsudo systemctl start nginx\n</code></pre></p> </li> </ol>"},{"location":"developer-guide/deployment/backup-restore/#tempo-de-recuperacao","title":"Tempo de Recupera\u00e7\u00e3o","text":"Etapa Tempo Estimado Provisionar servidor 10-30 min Restaurar DB 5-15 min Restaurar media 5-10 min Setup aplica\u00e7\u00e3o 10-15 min Verifica\u00e7\u00e3o 5-10 min Total 35-80 min"},{"location":"developer-guide/deployment/backup-restore/#testes-de-backup","title":"Testes de Backup","text":""},{"location":"developer-guide/deployment/backup-restore/#mensal","title":"Mensal","text":"<ol> <li>Restaurar backup em ambiente de teste</li> <li>Verificar integridade dos dados</li> <li>Testar funcionalidades principais</li> </ol>"},{"location":"developer-guide/deployment/backup-restore/#script-de-verificacao","title":"Script de Verifica\u00e7\u00e3o","text":"<pre><code>#!/bin/bash\n# verify_backup.sh\n\n# Restore para DB de teste\ncreatedb hymsplat_test\npg_restore -d hymsplat_test /backup/db_latest.dump\n\n# Verificar contagens\npsql -d hymsplat_test -c \"SELECT COUNT(*) FROM hymns_hymnbook;\"\npsql -d hymsplat_test -c \"SELECT COUNT(*) FROM hymns_hymn;\"\npsql -d hymsplat_test -c \"SELECT COUNT(*) FROM users_user;\"\n\n# Limpar\ndropdb hymsplat_test\n\necho \"Backup verification complete\"\n</code></pre>"},{"location":"developer-guide/deployment/backup-restore/#cloud-storage","title":"Cloud Storage","text":""},{"location":"developer-guide/deployment/backup-restore/#s3","title":"S3","text":"<pre><code># Install AWS CLI\npip install awscli\naws configure\n\n# Upload\naws s3 cp backup.dump s3://hymsplat-backups/db/\naws s3 cp media.tar.gz s3://hymsplat-backups/media/\n\n# Download\naws s3 cp s3://hymsplat-backups/db/backup.dump ./\n</code></pre>"},{"location":"developer-guide/deployment/backup-restore/#lifecycle-policy","title":"Lifecycle Policy","text":"<pre><code>{\n  \"Rules\": [\n    {\n      \"ID\": \"DeleteOldBackups\",\n      \"Status\": \"Enabled\",\n      \"Filter\": {},\n      \"Expiration\": {\n        \"Days\": 30\n      }\n    }\n  ]\n}\n</code></pre>"},{"location":"developer-guide/deployment/ci-cd/","title":"CI/CD","text":"<p>Pipeline de Integra\u00e7\u00e3o e Deploy Cont\u00ednuo.</p>"},{"location":"developer-guide/deployment/ci-cd/#github-actions","title":"GitHub Actions","text":"<p>O projeto usa GitHub Actions para CI/CD.</p>"},{"location":"developer-guide/deployment/ci-cd/#workflow","title":"Workflow","text":"<pre><code># .github/workflows/ci.yml\nname: CI\n\non:\n  push:\n    branches: [main, develop]\n  pull_request:\n    branches: [main, develop]\n\njobs:\n  lint:\n    name: Lint &amp; Format Check\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v4\n\n      - name: Set up Python\n        uses: actions/setup-python@v5\n        with:\n          python-version: '3.13'\n\n      - name: Install Poetry\n        uses: snok/install-poetry@v1\n\n      - name: Install dependencies\n        run: poetry install\n\n      - name: Run Black\n        run: poetry run black --check .\n\n      - name: Run isort\n        run: poetry run isort --check-only .\n\n      - name: Run Ruff\n        run: poetry run ruff check .\n\n  unit-tests:\n    name: Unit Tests\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v4\n\n      - name: Set up Python\n        uses: actions/setup-python@v5\n        with:\n          python-version: '3.13'\n\n      - name: Install dependencies\n        run: poetry install\n\n      - name: Run tests\n        env:\n          DJANGO_SETTINGS_MODULE: config.settings.test\n        run: poetry run pytest tests/unit/ --cov=apps\n\n  e2e-tests:\n    name: E2E Tests\n    runs-on: ubuntu-latest\n    services:\n      postgres:\n        image: postgres:16-alpine\n        env:\n          POSTGRES_DB: hymnplat\n          POSTGRES_USER: hymnplat\n          POSTGRES_PASSWORD: hymnplat\n        ports:\n          - 5432:5432\n\n      redis:\n        image: redis:7-alpine\n        ports:\n          - 6379:6379\n\n      typesense:\n        image: typesense/typesense:27.1\n        ports:\n          - 8108:8108\n        env:\n          TYPESENSE_API_KEY: xyz\n\n    steps:\n      - uses: actions/checkout@v4\n\n      - name: Setup and run E2E tests\n        run: |\n          poetry install\n          poetry run playwright install chromium --with-deps\n          poetry run python manage.py migrate\n          poetry run python manage.py runserver 9000 &amp;\n          sleep 5\n          poetry run pytest tests/e2e/ -v\n</code></pre>"},{"location":"developer-guide/deployment/ci-cd/#jobs","title":"Jobs","text":""},{"location":"developer-guide/deployment/ci-cd/#lint","title":"lint","text":"<p>Verifica formata\u00e7\u00e3o e estilo:</p> <ul> <li>Black (formata\u00e7\u00e3o)</li> <li>isort (imports)</li> <li>Ruff (linting)</li> </ul>"},{"location":"developer-guide/deployment/ci-cd/#unit-tests","title":"unit-tests","text":"<p>Roda testes unit\u00e1rios:</p> <ul> <li>pytest com coverage</li> <li>Banco em mem\u00f3ria (SQLite)</li> <li>TypeSense mockado</li> </ul>"},{"location":"developer-guide/deployment/ci-cd/#e2e-tests","title":"e2e-tests","text":"<p>Roda testes E2E:</p> <ul> <li>PostgreSQL real</li> <li>Redis real</li> <li>TypeSense real</li> <li>Playwright browser</li> </ul>"},{"location":"developer-guide/deployment/ci-cd/#triggers","title":"Triggers","text":"Evento Quando Jobs push main Merge em main Todos push develop Merge em develop Todos pull_request PR aberto/atualizado Todos"},{"location":"developer-guide/deployment/ci-cd/#secrets","title":"Secrets","text":"<p>Configure no GitHub:</p> Secret Descri\u00e7\u00e3o <code>DEPLOY_KEY</code> SSH key para servidor <code>CODECOV_TOKEN</code> Token do Codecov"},{"location":"developer-guide/deployment/ci-cd/#deploy-automatico","title":"Deploy Autom\u00e1tico","text":""},{"location":"developer-guide/deployment/ci-cd/#deploy-em-staging","title":"Deploy em Staging","text":"<pre><code># .github/workflows/deploy-staging.yml\nname: Deploy Staging\n\non:\n  push:\n    branches: [develop]\n\njobs:\n  deploy:\n    runs-on: ubuntu-latest\n    needs: [lint, unit-tests, e2e-tests]\n    steps:\n      - name: Deploy to staging\n        uses: appleboy/ssh-action@master\n        with:\n          host: ${{ secrets.STAGING_HOST }}\n          username: hymsplat\n          key: ${{ secrets.DEPLOY_KEY }}\n          script: |\n            cd /home/hymsplat/hyms-plat\n            git pull origin develop\n            source venv/bin/activate\n            poetry install --only main\n            python manage.py migrate\n            python manage.py collectstatic --noinput\n            sudo systemctl restart hymsplat\n</code></pre>"},{"location":"developer-guide/deployment/ci-cd/#deploy-em-producao","title":"Deploy em Produ\u00e7\u00e3o","text":"<pre><code># .github/workflows/deploy-production.yml\nname: Deploy Production\n\non:\n  release:\n    types: [published]\n\njobs:\n  deploy:\n    runs-on: ubuntu-latest\n    environment: production\n    steps:\n      - name: Deploy to production\n        uses: appleboy/ssh-action@master\n        with:\n          host: ${{ secrets.PRODUCTION_HOST }}\n          username: hymsplat\n          key: ${{ secrets.DEPLOY_KEY }}\n          script: |\n            cd /home/hymsplat/hyms-plat\n            git fetch --tags\n            git checkout ${{ github.event.release.tag_name }}\n            source venv/bin/activate\n            poetry install --only main\n            python manage.py migrate\n            python manage.py collectstatic --noinput\n            sudo systemctl restart hymsplat\n            python manage.py reindex_typesense\n</code></pre>"},{"location":"developer-guide/deployment/ci-cd/#badges","title":"Badges","text":"<pre><code>![CI](https://github.com/nitai-bezerra/hyms-plat/workflows/CI/badge.svg)\n[![codecov](https://codecov.io/gh/nitai-bezerra/hyms-plat/branch/main/graph/badge.svg)](https://codecov.io/gh/nitai-bezerra/hyms-plat)\n</code></pre>"},{"location":"developer-guide/deployment/ci-cd/#rodando-localmente","title":"Rodando Localmente","text":"<pre><code># Simular CI localmente com act\nbrew install act\n\n# Rodar workflow\nact push\n\n# Rodar job espec\u00edfico\nact -j unit-tests\n</code></pre>"},{"location":"developer-guide/deployment/ci-cd/#troubleshooting","title":"Troubleshooting","text":""},{"location":"developer-guide/deployment/ci-cd/#job-falhou","title":"Job Falhou","text":"<ol> <li>Clique no job no GitHub</li> <li>Veja os logs</li> <li>Identifique o erro</li> <li>Corrija localmente</li> <li>Push novamente</li> </ol>"},{"location":"developer-guide/deployment/ci-cd/#cache-problema","title":"Cache Problema","text":"<pre><code># Limpar cache\n- name: Clear cache\n  run: |\n    poetry cache clear . --all\n</code></pre>"},{"location":"developer-guide/deployment/ci-cd/#timeout","title":"Timeout","text":"<pre><code>jobs:\n  test:\n    timeout-minutes: 30\n</code></pre>"},{"location":"developer-guide/deployment/monitoring/","title":"Monitoramento","text":"<p>Observabilidade e monitoramento em produ\u00e7\u00e3o.</p>"},{"location":"developer-guide/deployment/monitoring/#logs","title":"Logs","text":""},{"location":"developer-guide/deployment/monitoring/#django-logging","title":"Django Logging","text":"<pre><code># config/settings/production.py\nLOGGING = {\n    'version': 1,\n    'disable_existing_loggers': False,\n    'formatters': {\n        'verbose': {\n            'format': '{levelname} {asctime} {module} {process:d} {thread:d} {message}',\n            'style': '{',\n        },\n    },\n    'handlers': {\n        'file': {\n            'level': 'INFO',\n            'class': 'logging.handlers.RotatingFileHandler',\n            'filename': '/var/log/hymsplat/django.log',\n            'maxBytes': 10485760,  # 10MB\n            'backupCount': 5,\n            'formatter': 'verbose',\n        },\n        'error_file': {\n            'level': 'ERROR',\n            'class': 'logging.handlers.RotatingFileHandler',\n            'filename': '/var/log/hymsplat/error.log',\n            'maxBytes': 10485760,\n            'backupCount': 5,\n            'formatter': 'verbose',\n        },\n    },\n    'root': {\n        'handlers': ['file'],\n        'level': 'INFO',\n    },\n    'loggers': {\n        'django': {\n            'handlers': ['file', 'error_file'],\n            'level': 'INFO',\n            'propagate': True,\n        },\n    },\n}\n</code></pre>"},{"location":"developer-guide/deployment/monitoring/#gunicorn-logs","title":"Gunicorn Logs","text":"<pre><code># gunicorn.conf.py\nerrorlog = \"/var/log/gunicorn/error.log\"\naccesslog = \"/var/log/gunicorn/access.log\"\nloglevel = \"info\"\n</code></pre>"},{"location":"developer-guide/deployment/monitoring/#nginx-logs","title":"Nginx Logs","text":"<pre><code>access_log /var/log/nginx/hymsplat.access.log;\nerror_log /var/log/nginx/hymsplat.error.log;\n</code></pre>"},{"location":"developer-guide/deployment/monitoring/#metricas","title":"M\u00e9tricas","text":""},{"location":"developer-guide/deployment/monitoring/#django-prometheus","title":"Django Prometheus","text":"<pre><code># config/settings/production.py\nINSTALLED_APPS += ['django_prometheus']\n\nMIDDLEWARE = [\n    'django_prometheus.middleware.PrometheusBeforeMiddleware',\n    # ... outros middlewares ...\n    'django_prometheus.middleware.PrometheusAfterMiddleware',\n]\n</code></pre> <pre><code># config/urls.py\nurlpatterns += [\n    path('metrics/', include('django_prometheus.urls')),\n]\n</code></pre>"},{"location":"developer-guide/deployment/monitoring/#metricas-disponiveis","title":"M\u00e9tricas Dispon\u00edveis","text":"<ul> <li>Request count</li> <li>Request latency</li> <li>Response status codes</li> <li>Database queries</li> <li>Cache hits/misses</li> </ul>"},{"location":"developer-guide/deployment/monitoring/#alertas","title":"Alertas","text":""},{"location":"developer-guide/deployment/monitoring/#sentry","title":"Sentry","text":"<pre><code># config/settings/production.py\nimport sentry_sdk\nfrom sentry_sdk.integrations.django import DjangoIntegration\n\nsentry_sdk.init(\n    dsn=env('SENTRY_DSN'),\n    integrations=[DjangoIntegration()],\n    traces_sample_rate=0.1,\n    send_default_pii=True\n)\n</code></pre>"},{"location":"developer-guide/deployment/monitoring/#alertas-recomendados","title":"Alertas Recomendados","text":"Alerta Condi\u00e7\u00e3o A\u00e7\u00e3o Error Rate &gt;1% em 5min Investigar Latency p99 &gt;2s Otimizar 5xx &gt;10 em 1min Investigar Disk &gt;80% Limpar/expandir Memory &gt;90% Investigar leak"},{"location":"developer-guide/deployment/monitoring/#health-checks","title":"Health Checks","text":""},{"location":"developer-guide/deployment/monitoring/#endpoint","title":"Endpoint","text":"<pre><code># apps/core/views.py\nfrom django.http import JsonResponse\nfrom django.db import connection\n\ndef health_check(request):\n    \"\"\"Endpoint de health check.\"\"\"\n    status = {'status': 'healthy'}\n\n    # Database\n    try:\n        with connection.cursor() as cursor:\n            cursor.execute('SELECT 1')\n        status['database'] = 'ok'\n    except Exception as e:\n        status['database'] = f'error: {e}'\n        status['status'] = 'unhealthy'\n\n    # TypeSense\n    try:\n        import requests\n        resp = requests.get(f'{TYPESENSE_HOST}/health', timeout=2)\n        status['typesense'] = 'ok' if resp.ok else 'error'\n    except Exception:\n        status['typesense'] = 'error'\n\n    # Redis\n    try:\n        import redis\n        r = redis.from_url(REDIS_URL)\n        r.ping()\n        status['redis'] = 'ok'\n    except Exception:\n        status['redis'] = 'error'\n\n    http_status = 200 if status['status'] == 'healthy' else 503\n    return JsonResponse(status, status=http_status)\n</code></pre>"},{"location":"developer-guide/deployment/monitoring/#nginx-health","title":"Nginx Health","text":"<pre><code>location /health/ {\n    proxy_pass http://hymsplat;\n    proxy_read_timeout 5s;\n}\n</code></pre>"},{"location":"developer-guide/deployment/monitoring/#dashboards","title":"Dashboards","text":""},{"location":"developer-guide/deployment/monitoring/#grafana","title":"Grafana","text":"<p>M\u00e9tricas recomendadas:</p> <ol> <li>Request Rate - Requests/segundo</li> <li>Error Rate - % de erros</li> <li>Latency - p50, p95, p99</li> <li>Active Users - Sess\u00f5es ativas</li> <li>Search Latency - Tempo de busca</li> </ol>"},{"location":"developer-guide/deployment/monitoring/#exemplo-dashboard","title":"Exemplo Dashboard","text":"<pre><code>{\n  \"panels\": [\n    {\n      \"title\": \"Request Rate\",\n      \"type\": \"graph\",\n      \"targets\": [\n        {\n          \"expr\": \"rate(django_http_requests_total[5m])\"\n        }\n      ]\n    },\n    {\n      \"title\": \"Error Rate\",\n      \"type\": \"singlestat\",\n      \"targets\": [\n        {\n          \"expr\": \"sum(rate(django_http_requests_total{status=~\\\"5..\\\"}[5m])) / sum(rate(django_http_requests_total[5m])) * 100\"\n        }\n      ]\n    }\n  ]\n}\n</code></pre>"},{"location":"developer-guide/deployment/monitoring/#comandos-uteis","title":"Comandos \u00dateis","text":"<pre><code># Logs em tempo real\nsudo journalctl -u hymsplat -f\n\n# Erros recentes\nsudo tail -100 /var/log/hymsplat/error.log\n\n# Nginx access\nsudo tail -f /var/log/nginx/hymsplat.access.log | grep -v health\n\n# Celery workers\npoetry run celery -A config inspect active\n\n# Redis stats\nredis-cli info\n</code></pre>"},{"location":"developer-guide/deployment/monitoring/#troubleshooting","title":"Troubleshooting","text":""},{"location":"developer-guide/deployment/monitoring/#alto-tempo-de-resposta","title":"Alto Tempo de Resposta","text":"<ol> <li>Verificar queries lentas: <code>pg_stat_statements</code></li> <li>Verificar cache: <code>redis-cli info stats</code></li> <li>Verificar CPU/Memory: <code>htop</code></li> </ol>"},{"location":"developer-guide/deployment/monitoring/#erros-500","title":"Erros 500","text":"<ol> <li>Verificar logs: <code>/var/log/hymsplat/error.log</code></li> <li>Verificar Sentry</li> <li>Verificar conex\u00f5es: DB, Redis, TypeSense</li> </ol>"},{"location":"developer-guide/deployment/monitoring/#memoria-alta","title":"Mem\u00f3ria Alta","text":"<ol> <li>Verificar workers: <code>ps aux | grep gunicorn</code></li> <li>Verificar cache size</li> <li>Restart workers: <code>sudo systemctl restart hymsplat</code></li> </ol>"},{"location":"developer-guide/deployment/overview/","title":"Deployment Overview","text":"<p>Vis\u00e3o geral do deploy do projeto.</p>"},{"location":"developer-guide/deployment/overview/#ambientes","title":"Ambientes","text":"Ambiente Uso URL Local Desenvolvimento localhost:8000 Staging Testes staging.portal-hinarios.com.br Production Usu\u00e1rios portal-hinarios.com.br"},{"location":"developer-guide/deployment/overview/#stack-de-producao","title":"Stack de Produ\u00e7\u00e3o","text":"<pre><code>                    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                    \u2502   Cloudflare \u2502 (CDN/DNS)\n                    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                           \u2502\n                    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                    \u2502    Nginx     \u2502 (Reverse Proxy)\n                    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                           \u2502\n         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n         \u2502                 \u2502                 \u2502\n    \u250c\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2510      \u250c\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2510      \u250c\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2510\n    \u2502 Gunicorn \u2502      \u2502 Gunicorn \u2502      \u2502 Gunicorn \u2502\n    \u2502 Worker 1 \u2502      \u2502 Worker 2 \u2502      \u2502 Worker N \u2502\n    \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2518      \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2518      \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2518\n         \u2502                 \u2502                 \u2502\n         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                           \u2502\n    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n    \u2502                      \u2502                      \u2502\n\u250c\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2510          \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2510          \u250c\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2510\n\u2502PostgreSQL\u2502          \u2502   TypeSense  \u2502          \u2502  Redis   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518          \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518          \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"developer-guide/deployment/overview/#componentes","title":"Componentes","text":""},{"location":"developer-guide/deployment/overview/#application-server","title":"Application Server","text":"<p>Gunicorn com m\u00faltiplos workers:</p> <pre><code>gunicorn config.wsgi:application \\\n  --bind 0.0.0.0:8000 \\\n  --workers 4 \\\n  --threads 2 \\\n  --worker-class gthread\n</code></pre>"},{"location":"developer-guide/deployment/overview/#reverse-proxy","title":"Reverse Proxy","text":"<p>Nginx para:</p> <ul> <li>SSL termination</li> <li>Static files</li> <li>Load balancing</li> <li>Rate limiting</li> </ul>"},{"location":"developer-guide/deployment/overview/#database","title":"Database","text":"<p>PostgreSQL com:</p> <ul> <li>Connection pooling (PgBouncer)</li> <li>Backups di\u00e1rios</li> <li>Replica\u00e7\u00e3o (opcional)</li> </ul>"},{"location":"developer-guide/deployment/overview/#search","title":"Search","text":"<p>TypeSense com:</p> <ul> <li>Alta disponibilidade</li> <li>Replica\u00e7\u00e3o</li> <li>Backups</li> </ul>"},{"location":"developer-guide/deployment/overview/#cachequeue","title":"Cache/Queue","text":"<p>Redis para:</p> <ul> <li>Cache de sess\u00f5es</li> <li>Celery broker</li> <li>Cache de queries</li> </ul>"},{"location":"developer-guide/deployment/overview/#background-tasks","title":"Background Tasks","text":"<p>Celery com:</p> <ul> <li>Workers para tasks</li> <li>Beat para agendamento</li> <li>Flower para monitoramento</li> </ul>"},{"location":"developer-guide/deployment/overview/#checklist-de-deploy","title":"Checklist de Deploy","text":""},{"location":"developer-guide/deployment/overview/#pre-deploy","title":"Pr\u00e9-deploy","text":"<ul> <li>[ ] Testes passando (CI)</li> <li>[ ] Migrations testadas</li> <li>[ ] Assets buildados</li> <li>[ ] Vari\u00e1veis de ambiente configuradas</li> <li>[ ] Backups verificados</li> </ul>"},{"location":"developer-guide/deployment/overview/#deploy","title":"Deploy","text":"<ul> <li>[ ] Migrate database</li> <li>[ ] Collect static files</li> <li>[ ] Restart workers</li> <li>[ ] Reindex search (se necess\u00e1rio)</li> <li>[ ] Verificar logs</li> </ul>"},{"location":"developer-guide/deployment/overview/#pos-deploy","title":"P\u00f3s-deploy","text":"<ul> <li>[ ] Smoke tests</li> <li>[ ] Monitorar erros</li> <li>[ ] Verificar m\u00e9tricas</li> <li>[ ] Comunicar equipe</li> </ul>"},{"location":"developer-guide/deployment/overview/#estrategias","title":"Estrat\u00e9gias","text":""},{"location":"developer-guide/deployment/overview/#blue-green","title":"Blue-Green","text":"<ol> <li>Dois ambientes id\u00eanticos</li> <li>Deploy no ambiente inativo</li> <li>Switch de tr\u00e1fego</li> <li>Rollback r\u00e1pido</li> </ol>"},{"location":"developer-guide/deployment/overview/#rolling","title":"Rolling","text":"<ol> <li>Atualiza um server por vez</li> <li>Sem downtime</li> <li>Rollback complexo</li> </ol>"},{"location":"developer-guide/deployment/overview/#canary","title":"Canary","text":"<ol> <li>Deploy para subset de usu\u00e1rios</li> <li>Monitorar erros</li> <li>Rollout gradual</li> </ol>"},{"location":"developer-guide/deployment/overview/#ferramentas","title":"Ferramentas","text":"Ferramenta Uso Docker Containeriza\u00e7\u00e3o GitHub Actions CI/CD Ansible Provisioning Terraform Infrastructure"},{"location":"developer-guide/deployment/overview/#links","title":"Links","text":"<ul> <li>Setup Produ\u00e7\u00e3o</li> <li>CI/CD</li> <li>Monitoramento</li> <li>Backup/Restore</li> </ul>"},{"location":"developer-guide/deployment/production-setup/","title":"Setup de Produ\u00e7\u00e3o","text":"<p>Configura\u00e7\u00e3o do ambiente de produ\u00e7\u00e3o.</p>"},{"location":"developer-guide/deployment/production-setup/#requisitos","title":"Requisitos","text":""},{"location":"developer-guide/deployment/production-setup/#hardware-minimo","title":"Hardware M\u00ednimo","text":"Componente M\u00ednimo Recomendado CPU 2 cores 4+ cores RAM 4 GB 8+ GB Storage 20 GB 50+ GB SSD"},{"location":"developer-guide/deployment/production-setup/#software","title":"Software","text":"<ul> <li>Ubuntu 22.04 LTS</li> <li>Python 3.11+</li> <li>PostgreSQL 16</li> <li>Redis 7</li> <li>Nginx</li> <li>Supervisor/Systemd</li> </ul>"},{"location":"developer-guide/deployment/production-setup/#instalacao","title":"Instala\u00e7\u00e3o","text":""},{"location":"developer-guide/deployment/production-setup/#1-sistema-base","title":"1. Sistema Base","text":"<pre><code># Atualizar sistema\nsudo apt update &amp;&amp; sudo apt upgrade -y\n\n# Instalar depend\u00eancias\nsudo apt install -y \\\n  python3.11 python3.11-venv python3-pip \\\n  postgresql-16 postgresql-contrib \\\n  redis-server \\\n  nginx \\\n  supervisor \\\n  git curl\n</code></pre>"},{"location":"developer-guide/deployment/production-setup/#2-usuario-da-aplicacao","title":"2. Usu\u00e1rio da Aplica\u00e7\u00e3o","text":"<pre><code>sudo useradd -m -s /bin/bash hymsplat\nsudo su - hymsplat\n</code></pre>"},{"location":"developer-guide/deployment/production-setup/#3-clone-e-setup","title":"3. Clone e Setup","text":"<pre><code>cd /home/hymsplat\ngit clone https://github.com/nitai-bezerra/hyms-plat.git\ncd hyms-plat\n\n# Ambiente virtual\npython3.11 -m venv venv\nsource venv/bin/activate\n\n# Depend\u00eancias\npip install poetry\npoetry install --only main\n</code></pre>"},{"location":"developer-guide/deployment/production-setup/#4-configuracao","title":"4. Configura\u00e7\u00e3o","text":"<pre><code># Copiar exemplo\ncp .env.example .env\n\n# Editar com valores de produ\u00e7\u00e3o\nnano .env\n</code></pre> <pre><code># .env (produ\u00e7\u00e3o)\nDEBUG=False\nALLOWED_HOSTS=portal-hinarios.com.br,www.portal-hinarios.com.br\nSECRET_KEY=&lt;gerar-chave-segura&gt;\n\nDATABASE_URL=postgres://user:pass@localhost:5432/hymsplat\nREDIS_URL=redis://localhost:6379/0\n\nTYPESENSE_API_KEY=&lt;chave-segura&gt;\nTYPESENSE_HOST=localhost\nTYPESENSE_PORT=8108\nTYPESENSE_PROTOCOL=http\n</code></pre>"},{"location":"developer-guide/deployment/production-setup/#5-database","title":"5. Database","text":"<pre><code># Como postgres user\nsudo -u postgres psql\n\nCREATE DATABASE hymsplat;\nCREATE USER hymsplat WITH PASSWORD 'senha-segura';\nGRANT ALL PRIVILEGES ON DATABASE hymsplat TO hymsplat;\n\\q\n\n# Migrations\npython manage.py migrate\npython manage.py createsuperuser\n</code></pre>"},{"location":"developer-guide/deployment/production-setup/#6-static-files","title":"6. Static Files","text":"<pre><code>python manage.py collectstatic --noinput\n</code></pre>"},{"location":"developer-guide/deployment/production-setup/#gunicorn","title":"Gunicorn","text":""},{"location":"developer-guide/deployment/production-setup/#configuracao","title":"Configura\u00e7\u00e3o","text":"<pre><code># gunicorn.conf.py\nbind = \"127.0.0.1:8000\"\nworkers = 4\nthreads = 2\nworker_class = \"gthread\"\ntimeout = 30\nkeepalive = 5\nerrorlog = \"/var/log/gunicorn/error.log\"\naccesslog = \"/var/log/gunicorn/access.log\"\nloglevel = \"info\"\n</code></pre>"},{"location":"developer-guide/deployment/production-setup/#systemd-service","title":"Systemd Service","text":"<pre><code># /etc/systemd/system/hymsplat.service\n[Unit]\nDescription=hyms-plat gunicorn daemon\nAfter=network.target\n\n[Service]\nUser=hymsplat\nGroup=hymsplat\nWorkingDirectory=/home/hymsplat/hyms-plat\nEnvironment=\"PATH=/home/hymsplat/hyms-plat/venv/bin\"\nExecStart=/home/hymsplat/hyms-plat/venv/bin/gunicorn \\\n  --config gunicorn.conf.py \\\n  config.wsgi:application\nRestart=on-failure\n\n[Install]\nWantedBy=multi-user.target\n</code></pre> <pre><code>sudo systemctl enable hymsplat\nsudo systemctl start hymsplat\n</code></pre>"},{"location":"developer-guide/deployment/production-setup/#nginx","title":"Nginx","text":"<pre><code># /etc/nginx/sites-available/hymsplat\nupstream hymsplat {\n    server 127.0.0.1:8000;\n}\n\nserver {\n    listen 80;\n    server_name portal-hinarios.com.br;\n    return 301 https://$server_name$request_uri;\n}\n\nserver {\n    listen 443 ssl http2;\n    server_name portal-hinarios.com.br;\n\n    ssl_certificate /etc/letsencrypt/live/portal-hinarios.com.br/fullchain.pem;\n    ssl_certificate_key /etc/letsencrypt/live/portal-hinarios.com.br/privkey.pem;\n\n    location /static/ {\n        alias /home/hymsplat/hyms-plat/staticfiles/;\n        expires 30d;\n    }\n\n    location /media/ {\n        alias /home/hymsplat/hyms-plat/media/;\n        expires 7d;\n    }\n\n    location / {\n        proxy_pass http://hymsplat;\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n    }\n}\n</code></pre> <pre><code>sudo ln -s /etc/nginx/sites-available/hymsplat /etc/nginx/sites-enabled/\nsudo nginx -t\nsudo systemctl reload nginx\n</code></pre>"},{"location":"developer-guide/deployment/production-setup/#ssl","title":"SSL","text":"<pre><code># Certbot\nsudo apt install certbot python3-certbot-nginx\nsudo certbot --nginx -d portal-hinarios.com.br\n</code></pre>"},{"location":"developer-guide/deployment/production-setup/#typesense","title":"TypeSense","text":"<pre><code># Docker (recomendado)\ndocker run -d \\\n  --name typesense \\\n  -p 8108:8108 \\\n  -v /data/typesense:/data \\\n  typesense/typesense:27.1 \\\n  --data-dir /data \\\n  --api-key=$TYPESENSE_API_KEY\n</code></pre>"},{"location":"developer-guide/deployment/production-setup/#celery","title":"Celery","text":"<pre><code># /etc/systemd/system/celery.service\n[Unit]\nDescription=Celery Worker\nAfter=network.target\n\n[Service]\nUser=hymsplat\nGroup=hymsplat\nWorkingDirectory=/home/hymsplat/hyms-plat\nEnvironment=\"PATH=/home/hymsplat/hyms-plat/venv/bin\"\nExecStart=/home/hymsplat/hyms-plat/venv/bin/celery \\\n  -A config worker \\\n  -l INFO\nRestart=on-failure\n\n[Install]\nWantedBy=multi-user.target\n</code></pre>"},{"location":"developer-guide/deployment/production-setup/#verificacao","title":"Verifica\u00e7\u00e3o","text":"<pre><code># Servi\u00e7os\nsudo systemctl status hymsplat\nsudo systemctl status nginx\nsudo systemctl status postgresql\nsudo systemctl status redis\n\n# Aplica\u00e7\u00e3o\ncurl -I https://portal-hinarios.com.br/\n\n# Logs\nsudo journalctl -u hymsplat -f\n</code></pre>"},{"location":"developer-guide/guides/adding-features/","title":"Adicionar Features","text":"<p>Guia para adicionar novas funcionalidades.</p>"},{"location":"developer-guide/guides/adding-features/#workflow","title":"Workflow","text":"<ol> <li>Criar branch</li> <li>Implementar feature</li> <li>Adicionar testes</li> <li>Rodar CI local</li> <li>Abrir PR</li> </ol>"},{"location":"developer-guide/guides/adding-features/#exemplo-nova-feature","title":"Exemplo: Nova Feature","text":"<p>Vamos adicionar um sistema de \"playlists\" como exemplo.</p>"},{"location":"developer-guide/guides/adding-features/#1-criar-model","title":"1. Criar Model","text":"<pre><code># apps/users/models.py\nclass Playlist(models.Model):\n    \"\"\"Playlist de hinos.\"\"\"\n\n    id = models.UUIDField(primary_key=True, default=uuid.uuid4)\n    user = models.ForeignKey(User, on_delete=models.CASCADE, related_name='playlists')\n    name = models.CharField(max_length=255)\n    description = models.TextField(blank=True)\n    hymns = models.ManyToManyField('hymns.Hymn', through='PlaylistItem')\n    created_at = models.DateTimeField(auto_now_add=True)\n\n    class Meta:\n        ordering = ['-created_at']\n\n\nclass PlaylistItem(models.Model):\n    \"\"\"Item de playlist (hymn + ordem).\"\"\"\n\n    playlist = models.ForeignKey(Playlist, on_delete=models.CASCADE)\n    hymn = models.ForeignKey('hymns.Hymn', on_delete=models.CASCADE)\n    order = models.PositiveIntegerField(default=0)\n\n    class Meta:\n        ordering = ['order']\n        unique_together = [['playlist', 'hymn']]\n</code></pre>"},{"location":"developer-guide/guides/adding-features/#2-criar-migration","title":"2. Criar Migration","text":"<pre><code>poetry run python manage.py makemigrations users\npoetry run python manage.py migrate\n</code></pre>"},{"location":"developer-guide/guides/adding-features/#3-criar-views","title":"3. Criar Views","text":"<pre><code># apps/users/views.py\n@login_required\ndef playlist_list(request):\n    playlists = request.user.playlists.all()\n    return render(request, 'users/playlist_list.html', {'playlists': playlists})\n\n\n@login_required\ndef playlist_detail(request, pk):\n    playlist = get_object_or_404(Playlist, pk=pk, user=request.user)\n    items = playlist.playlistitem_set.select_related('hymn')\n    return render(request, 'users/playlist_detail.html', {\n        'playlist': playlist,\n        'items': items,\n    })\n\n\n@login_required\n@require_POST\ndef create_playlist(request):\n    name = request.POST.get('name')\n    if not name:\n        return JsonResponse({'error': 'Name required'}, status=400)\n\n    playlist = Playlist.objects.create(user=request.user, name=name)\n    return JsonResponse({'id': str(playlist.id), 'name': playlist.name})\n\n\n@login_required\n@require_POST\ndef add_to_playlist(request, playlist_id, hymn_id):\n    playlist = get_object_or_404(Playlist, pk=playlist_id, user=request.user)\n    hymn = get_object_or_404(Hymn, pk=hymn_id)\n\n    item, created = PlaylistItem.objects.get_or_create(\n        playlist=playlist,\n        hymn=hymn,\n        defaults={'order': playlist.playlistitem_set.count()}\n    )\n\n    return JsonResponse({'added': created})\n</code></pre>"},{"location":"developer-guide/guides/adding-features/#4-adicionar-urls","title":"4. Adicionar URLs","text":"<pre><code># apps/users/urls.py\nurlpatterns += [\n    path('playlists/', playlist_list, name='playlist_list'),\n    path('playlists/&lt;uuid:pk&gt;/', playlist_detail, name='playlist_detail'),\n    path('api/playlists/', create_playlist, name='create_playlist'),\n    path('api/playlists/&lt;uuid:playlist_id&gt;/add/&lt;uuid:hymn_id&gt;/',\n         add_to_playlist, name='add_to_playlist'),\n]\n</code></pre>"},{"location":"developer-guide/guides/adding-features/#5-criar-templates","title":"5. Criar Templates","text":"<pre><code>&lt;!-- templates/users/playlist_list.html --&gt;\n{% extends \"base.html\" %}\n\n{% block content %}\n&lt;h1&gt;Minhas Playlists&lt;/h1&gt;\n\n&lt;button id=\"create-playlist\"&gt;Nova Playlist&lt;/button&gt;\n\n&lt;ul&gt;\n{% for playlist in playlists %}\n  &lt;li&gt;\n    &lt;a href=\"{% url 'playlist_detail' playlist.pk %}\"&gt;\n      {{ playlist.name }}\n    &lt;/a&gt;\n    ({{ playlist.hymns.count }} hinos)\n  &lt;/li&gt;\n{% empty %}\n  &lt;li&gt;Nenhuma playlist ainda.&lt;/li&gt;\n{% endfor %}\n&lt;/ul&gt;\n{% endblock %}\n</code></pre>"},{"location":"developer-guide/guides/adding-features/#6-adicionar-testes","title":"6. Adicionar Testes","text":"<pre><code># tests/unit/test_playlists.py\nimport pytest\nfrom apps.users.models import Playlist, PlaylistItem\n\n\n@pytest.fixture\ndef playlist(user):\n    return Playlist.objects.create(user=user, name=\"My Playlist\")\n\n\nclass TestPlaylist:\n    def test_create_playlist(self, user):\n        playlist = Playlist.objects.create(user=user, name=\"Test\")\n        assert playlist.name == \"Test\"\n        assert playlist.user == user\n\n    def test_add_hymn_to_playlist(self, playlist, hymn):\n        item = PlaylistItem.objects.create(playlist=playlist, hymn=hymn)\n        assert item in playlist.playlistitem_set.all()\n\n    def test_playlist_ordering(self, playlist, hymn_factory):\n        hymns = [hymn_factory() for _ in range(3)]\n        for i, hymn in enumerate(hymns):\n            PlaylistItem.objects.create(playlist=playlist, hymn=hymn, order=i)\n\n        items = list(playlist.playlistitem_set.all())\n        assert items[0].order &lt; items[1].order &lt; items[2].order\n</code></pre>"},{"location":"developer-guide/guides/adding-features/#7-testes-e2e","title":"7. Testes E2E","text":"<pre><code># tests/e2e/test_playlists.py\nimport pytest\nfrom playwright.sync_api import Page, expect\n\n\n@pytest.mark.e2e\nclass TestPlaylists:\n    def test_create_playlist(self, authenticated_page: Page, base_url: str):\n        authenticated_page.goto(f\"{base_url}/playlists/\")\n        authenticated_page.click(\"#create-playlist\")\n        authenticated_page.fill('input[name=\"name\"]', \"Minha Playlist\")\n        authenticated_page.click('button[type=\"submit\"]')\n\n        expect(authenticated_page.locator(\"text=Minha Playlist\")).to_be_visible()\n</code></pre>"},{"location":"developer-guide/guides/adding-features/#8-rodar-testes","title":"8. Rodar Testes","text":"<pre><code># Unit\u00e1rios\npoetry run pytest tests/unit/test_playlists.py -v\n\n# E2E (com servidor rodando)\npoetry run pytest tests/e2e/test_playlists.py -v\n\n# Coverage\npoetry run pytest --cov=apps tests/\n</code></pre>"},{"location":"developer-guide/guides/adding-features/#9-formatar-e-lint","title":"9. Formatar e Lint","text":"<pre><code>poetry run black .\npoetry run isort .\npoetry run ruff check --fix .\n</code></pre>"},{"location":"developer-guide/guides/adding-features/#10-commit-e-pr","title":"10. Commit e PR","text":"<pre><code>git add .\ngit commit -m \"feat(users): adiciona sistema de playlists\"\ngit push origin feat/playlists\n</code></pre>"},{"location":"developer-guide/guides/adding-features/#checklist","title":"Checklist","text":"<p>Antes de abrir PR:</p> <ul> <li>[ ] Models com docstrings</li> <li>[ ] Migrations criadas</li> <li>[ ] Views implementadas</li> <li>[ ] URLs registradas</li> <li>[ ] Templates criados</li> <li>[ ] Testes unit\u00e1rios</li> <li>[ ] Testes E2E (se aplic\u00e1vel)</li> <li>[ ] Coverage &gt; 80%</li> <li>[ ] C\u00f3digo formatado</li> <li>[ ] Lint passa</li> </ul>"},{"location":"developer-guide/guides/adding-features/#dicas","title":"Dicas","text":""},{"location":"developer-guide/guides/adding-features/#use-factories","title":"Use Factories","text":"<pre><code># tests/factories.py\nclass PlaylistFactory(factory.django.DjangoModelFactory):\n    class Meta:\n        model = Playlist\n\n    user = factory.SubFactory(UserFactory)\n    name = factory.Faker('sentence', nb_words=3)\n</code></pre>"},{"location":"developer-guide/guides/adding-features/#use-fixtures","title":"Use Fixtures","text":"<pre><code>@pytest.fixture\ndef playlist_with_hymns(playlist, hymn_factory):\n    for i in range(5):\n        PlaylistItem.objects.create(\n            playlist=playlist,\n            hymn=hymn_factory(),\n            order=i\n        )\n    return playlist\n</code></pre>"},{"location":"developer-guide/guides/adding-features/#mantenha-simples","title":"Mantenha Simples","text":"<ul> <li>Uma feature por PR</li> <li>Commits pequenos</li> <li>Testes focados</li> </ul>"},{"location":"developer-guide/guides/celery-tasks/","title":"Celery Tasks","text":"<p>Guia para tarefas em background com Celery.</p>"},{"location":"developer-guide/guides/celery-tasks/#configuracao","title":"Configura\u00e7\u00e3o","text":""},{"location":"developer-guide/guides/celery-tasks/#settings","title":"Settings","text":"<pre><code># config/settings/base.py\nCELERY_BROKER_URL = env('CELERY_BROKER_URL', default='redis://localhost:6379/0')\nCELERY_RESULT_BACKEND = env('CELERY_RESULT_BACKEND', default='redis://localhost:6379/0')\nCELERY_ACCEPT_CONTENT = ['json']\nCELERY_TASK_SERIALIZER = 'json'\nCELERY_RESULT_SERIALIZER = 'json'\nCELERY_TIMEZONE = 'America/Sao_Paulo'\n</code></pre>"},{"location":"developer-guide/guides/celery-tasks/#celery-app","title":"Celery App","text":"<pre><code># config/celery.py\nimport os\nfrom celery import Celery\n\nos.environ.setdefault('DJANGO_SETTINGS_MODULE', 'config.settings.local')\n\napp = Celery('hymsplat')\napp.config_from_object('django.conf:settings', namespace='CELERY')\napp.autodiscover_tasks()\n\n\n@app.task(bind=True, ignore_result=True)\ndef debug_task(self):\n    print(f'Request: {self.request!r}')\n</code></pre>"},{"location":"developer-guide/guides/celery-tasks/#init","title":"Init","text":"<pre><code># config/__init__.py\nfrom .celery import app as celery_app\n\n__all__ = ('celery_app',)\n</code></pre>"},{"location":"developer-guide/guides/celery-tasks/#criando-tasks","title":"Criando Tasks","text":""},{"location":"developer-guide/guides/celery-tasks/#task-simples","title":"Task Simples","text":"<pre><code># apps/hymns/tasks.py\nfrom celery import shared_task\nfrom apps.search.indexer import reindex_all\n\n\n@shared_task\ndef reindex_typesense_task():\n    \"\"\"Reindexa todos os hinos no TypeSense.\"\"\"\n    count = reindex_all()\n    return f'Indexed {count} hymns'\n</code></pre>"},{"location":"developer-guide/guides/celery-tasks/#task-com-retry","title":"Task com Retry","text":"<pre><code>@shared_task(\n    bind=True,\n    max_retries=3,\n    default_retry_delay=60\n)\ndef send_email_task(self, user_id, subject, body):\n    \"\"\"Envia email com retry autom\u00e1tico.\"\"\"\n    try:\n        user = User.objects.get(pk=user_id)\n        user.email_user(subject, body)\n    except Exception as exc:\n        raise self.retry(exc=exc)\n</code></pre>"},{"location":"developer-guide/guides/celery-tasks/#task-com-timeout","title":"Task com Timeout","text":"<pre><code>@shared_task(time_limit=300, soft_time_limit=240)\ndef process_large_file_task(file_path):\n    \"\"\"Processa arquivo grande com timeout.\"\"\"\n    # 5 min hard limit, 4 min soft limit\n    pass\n</code></pre>"},{"location":"developer-guide/guides/celery-tasks/#chamando-tasks","title":"Chamando Tasks","text":""},{"location":"developer-guide/guides/celery-tasks/#assincrono","title":"Ass\u00edncrono","text":"<pre><code>from apps.hymns.tasks import reindex_typesense_task\n\n# Dispara e n\u00e3o espera\nreindex_typesense_task.delay()\n\n# Com argumentos\nsend_email_task.delay(user_id=123, subject='Hi', body='Hello')\n</code></pre>"},{"location":"developer-guide/guides/celery-tasks/#sincrono-debug","title":"S\u00edncrono (debug)","text":"<pre><code># Executa imediatamente (bloqueia)\nresult = reindex_typesense_task()\n</code></pre>"},{"location":"developer-guide/guides/celery-tasks/#com-options","title":"Com Options","text":"<pre><code># Agendar para depois\nfrom datetime import timedelta\n\nreindex_typesense_task.apply_async(\n    countdown=60  # em 60 segundos\n)\n\n# Em hor\u00e1rio espec\u00edfico\nfrom datetime import datetime\nreindex_typesense_task.apply_async(\n    eta=datetime(2024, 1, 15, 10, 0, 0)\n)\n</code></pre>"},{"location":"developer-guide/guides/celery-tasks/#rodando-workers","title":"Rodando Workers","text":""},{"location":"developer-guide/guides/celery-tasks/#desenvolvimento","title":"Desenvolvimento","text":"<pre><code># Terminal 1: Django\npoetry run python manage.py runserver\n\n# Terminal 2: Celery worker\npoetry run celery -A config worker -l INFO\n</code></pre>"},{"location":"developer-guide/guides/celery-tasks/#com-auto-reload","title":"Com Auto-reload","text":"<pre><code>poetry run celery -A config worker -l INFO --autoreload\n</code></pre>"},{"location":"developer-guide/guides/celery-tasks/#beat-agendamento","title":"Beat (Agendamento)","text":"<pre><code># Terminal 3: Celery beat\npoetry run celery -A config beat -l INFO\n</code></pre>"},{"location":"developer-guide/guides/celery-tasks/#tarefas-agendadas","title":"Tarefas Agendadas","text":"<pre><code># config/celery.py\nfrom celery.schedules import crontab\n\napp.conf.beat_schedule = {\n    'reindex-every-night': {\n        'task': 'apps.hymns.tasks.reindex_typesense_task',\n        'schedule': crontab(hour=3, minute=0),\n    },\n    'cleanup-every-hour': {\n        'task': 'apps.core.tasks.cleanup_old_data_task',\n        'schedule': crontab(minute=0),\n    },\n}\n</code></pre>"},{"location":"developer-guide/guides/celery-tasks/#monitoramento","title":"Monitoramento","text":""},{"location":"developer-guide/guides/celery-tasks/#flower","title":"Flower","text":"<pre><code># Instalar\npoetry add flower\n\n# Rodar\npoetry run celery -A config flower\n\n# Acessar\nopen http://localhost:5555\n</code></pre>"},{"location":"developer-guide/guides/celery-tasks/#logs","title":"Logs","text":"<pre><code># Ver logs do worker\npoetry run celery -A config worker -l DEBUG\n\n# Com arquivo\npoetry run celery -A config worker -l INFO --logfile=celery.log\n</code></pre>"},{"location":"developer-guide/guides/celery-tasks/#tasks-uteis","title":"Tasks \u00dateis","text":""},{"location":"developer-guide/guides/celery-tasks/#notificacoes","title":"Notifica\u00e7\u00f5es","text":"<pre><code>@shared_task\ndef send_notification_task(user_id, notification_type, data):\n    \"\"\"Cria notifica\u00e7\u00e3o para usu\u00e1rio.\"\"\"\n    from apps.users.models import Notification\n\n    Notification.objects.create(\n        user_id=user_id,\n        notification_type=notification_type,\n        data=data\n    )\n</code></pre>"},{"location":"developer-guide/guides/celery-tasks/#cleanup","title":"Cleanup","text":"<pre><code>@shared_task\ndef cleanup_old_notifications_task(days=30):\n    \"\"\"Remove notifica\u00e7\u00f5es antigas.\"\"\"\n    from datetime import timedelta\n    from django.utils import timezone\n    from apps.users.models import Notification\n\n    cutoff = timezone.now() - timedelta(days=days)\n    deleted, _ = Notification.objects.filter(\n        created_at__lt=cutoff,\n        read=True\n    ).delete()\n\n    return f'Deleted {deleted} notifications'\n</code></pre>"},{"location":"developer-guide/guides/celery-tasks/#processamento-de-upload","title":"Processamento de Upload","text":"<pre><code>@shared_task(bind=True)\ndef process_upload_task(self, version_id):\n    \"\"\"Processa upload de hin\u00e1rio.\"\"\"\n    from apps.hymns.models import HymnBookVersion\n    from apps.hymns.services import process_hymnbook_version\n\n    version = HymnBookVersion.objects.get(pk=version_id)\n\n    try:\n        process_hymnbook_version(version)\n        version.status = 'approved'\n    except Exception as e:\n        version.status = 'rejected'\n        version.changes['error'] = str(e)\n\n    version.save()\n</code></pre>"},{"location":"developer-guide/guides/celery-tasks/#troubleshooting","title":"Troubleshooting","text":""},{"location":"developer-guide/guides/celery-tasks/#task-nao-executa","title":"Task n\u00e3o executa","text":"<pre><code># Verificar broker\nimport redis\nr = redis.from_url('redis://localhost:6379/0')\nr.ping()  # Deve retornar True\n</code></pre>"},{"location":"developer-guide/guides/celery-tasks/#worker-nao-conecta","title":"Worker n\u00e3o conecta","text":"<pre><code># Verificar Redis\ndocker-compose ps redis\n\n# Testar conex\u00e3o\nredis-cli ping\n</code></pre>"},{"location":"developer-guide/guides/celery-tasks/#task-presa","title":"Task presa","text":"<pre><code># Listar tasks ativas\npoetry run celery -A config inspect active\n\n# Cancelar task\npoetry run celery -A config control revoke &lt;task_id&gt;\n</code></pre>"},{"location":"developer-guide/guides/importing-yaml/","title":"Importar YAML","text":"<p>Guia para importar hin\u00e1rios via arquivo YAML.</p>"},{"location":"developer-guide/guides/importing-yaml/#formato-do-yaml","title":"Formato do YAML","text":""},{"location":"developer-guide/guides/importing-yaml/#estrutura-basica","title":"Estrutura B\u00e1sica","text":"<pre><code>name: \"Nome do Hin\u00e1rio\"\nowner_name: \"Nome do Dono\"\nintro_name: \"Nome Curto\"  # opcional\ndescription: \"Descri\u00e7\u00e3o do hin\u00e1rio\"  # opcional\n\nhymns:\n  - number: 1\n    title: \"Primeiro Hino\"\n    text: |\n      Letra do primeiro hino\n      Com quebras de linha\n  - number: 2\n    title: \"Segundo Hino\"\n    text: \"Letra do segundo hino\"\n</code></pre>"},{"location":"developer-guide/guides/importing-yaml/#campos-obrigatorios","title":"Campos Obrigat\u00f3rios","text":"Campo Tipo Descri\u00e7\u00e3o <code>name</code> string Nome \u00fanico do hin\u00e1rio <code>owner_name</code> string Nome de quem recebeu <code>hymns</code> list Lista de hinos <code>hymns[].number</code> int N\u00famero no hin\u00e1rio <code>hymns[].title</code> string T\u00edtulo do hino <code>hymns[].text</code> string Letra completa"},{"location":"developer-guide/guides/importing-yaml/#campos-opcionais","title":"Campos Opcionais","text":"Campo Tipo Descri\u00e7\u00e3o <code>intro_name</code> string Nome curto <code>description</code> string Descri\u00e7\u00e3o do hin\u00e1rio <code>hymns[].received_at</code> date Data (YYYY-MM-DD) <code>hymns[].offered_to</code> string Dedicat\u00f3ria <code>hymns[].style</code> string Valsa, Marcha, etc <code>hymns[].extra_instructions</code> string Instru\u00e7\u00f5es <code>hymns[].repetitions</code> string Ex: \"1-4, 5-8\""},{"location":"developer-guide/guides/importing-yaml/#exemplo-completo","title":"Exemplo Completo","text":"<pre><code>name: \"O Cruzeiro\"\nowner_name: \"Mestre Irineu\"\nintro_name: \"Cruzeiro\"\ndescription: |\n  O Cruzeiro \u00e9 o primeiro hin\u00e1rio do Santo Daime,\n  recebido pelo Mestre Irineu Serra.\n\nhymns:\n  - number: 1\n    title: \"Lua Branca\"\n    text: |\n      Lua branca da luz serena\n      Que ilumina a natureza\n      Vem da floresta encantada\n      Esta celestial princesa\n    style: \"Valsa\"\n    received_at: \"1930-07-15\"\n    offered_to: \"Nossa Senhora\"\n    repetitions: \"1-4\"\n\n  - number: 2\n    title: \"Tuperci\"\n    text: |\n      Tuperci \u00e9 um anjo\n      Que Deus mandou\n      Para me ensinar\n      O que eu n\u00e3o sei\n    style: \"Marcha\"\n</code></pre>"},{"location":"developer-guide/guides/importing-yaml/#importando-via-command","title":"Importando via Command","text":""},{"location":"developer-guide/guides/importing-yaml/#comando-basico","title":"Comando B\u00e1sico","text":"<pre><code>poetry run python manage.py import_yaml arquivo.yaml\n</code></pre>"},{"location":"developer-guide/guides/importing-yaml/#opcoes","title":"Op\u00e7\u00f5es","text":"<pre><code># Simula sem salvar\npoetry run python manage.py import_yaml arquivo.yaml --dry-run\n\n# Sobrescreve se existir\npoetry run python manage.py import_yaml arquivo.yaml --force\n\n# Verbose\npoetry run python manage.py import_yaml arquivo.yaml -v 2\n</code></pre>"},{"location":"developer-guide/guides/importing-yaml/#output-esperado","title":"Output Esperado","text":"<pre><code>Parsing YAML file: arquivo.yaml\nFound hymnbook: O Cruzeiro\nFound 10 hymns\nCreating HymnBook...\nCreating Hymns...\nIndexing in TypeSense...\nSuccessfully imported: O Cruzeiro (10 hymns)\n</code></pre>"},{"location":"developer-guide/guides/importing-yaml/#importando-via-codigo","title":"Importando via C\u00f3digo","text":"<pre><code>from apps.hymns.services import import_hymnbook_from_yaml\n\n# Via path\nhymnbook = import_hymnbook_from_yaml('/path/to/file.yaml')\n\n# Via dict\ndata = {\n    'name': 'Meu Hin\u00e1rio',\n    'owner_name': 'Jo\u00e3o',\n    'hymns': [\n        {'number': 1, 'title': 'Hino 1', 'text': 'Letra...'}\n    ]\n}\nhymnbook = import_hymnbook_from_yaml(data)\n</code></pre>"},{"location":"developer-guide/guides/importing-yaml/#validacao","title":"Valida\u00e7\u00e3o","text":""},{"location":"developer-guide/guides/importing-yaml/#erros-comuns","title":"Erros Comuns","text":"Erro Causa Solu\u00e7\u00e3o <code>name is required</code> Falta campo name Adicione <code>name:</code> <code>Duplicate hymn number</code> Dois hinos com mesmo n\u00famero Corrija numera\u00e7\u00e3o <code>HymnBook already exists</code> Nome j\u00e1 existe Use <code>--force</code> ou renomeie"},{"location":"developer-guide/guides/importing-yaml/#validar-antes-de-importar","title":"Validar Antes de Importar","text":"<pre><code># Valida YAML online\n# https://www.yamllint.com/\n\n# Ou via Python\nimport yaml\nwith open('arquivo.yaml') as f:\n    data = yaml.safe_load(f)\n    print(data)\n</code></pre>"},{"location":"developer-guide/guides/importing-yaml/#apos-importacao","title":"Ap\u00f3s Importa\u00e7\u00e3o","text":"<p>O hin\u00e1rio importado:</p> <ol> <li>\u00c9 salvo no PostgreSQL</li> <li>\u00c9 indexado no TypeSense</li> <li>Aparece na lista de hin\u00e1rios</li> <li>Pode ser buscado imediatamente</li> </ol>"},{"location":"developer-guide/guides/importing-yaml/#formatos-alternativos","title":"Formatos Alternativos","text":""},{"location":"developer-guide/guides/importing-yaml/#sem-hymn_book-como-raiz","title":"Sem <code>hymn_book:</code> como raiz","text":"<p>O sistema tamb\u00e9m aceita:</p> <pre><code># Tamb\u00e9m v\u00e1lido (sem hymn_book: wrapper)\nname: \"Hin\u00e1rio\"\nowner_name: \"Dono\"\nhymns:\n  - number: 1\n    title: \"Hino\"\n    text: \"Letra\"\n</code></pre>"},{"location":"developer-guide/guides/importing-yaml/#com-hymn_book-wrapper","title":"Com <code>hymn_book:</code> wrapper","text":"<pre><code>hymn_book:\n  name: \"Hin\u00e1rio\"\n  owner_name: \"Dono\"\n  hymns:\n    - number: 1\n      title: \"Hino\"\n      text: \"Letra\"\n</code></pre> <p>Ambos funcionam.</p>"},{"location":"developer-guide/guides/importing-yaml/#troubleshooting","title":"Troubleshooting","text":""},{"location":"developer-guide/guides/importing-yaml/#encoding","title":"Encoding","text":"<p>Use UTF-8:</p> <pre><code>file -I arquivo.yaml\n# deve retornar: text/plain; charset=utf-8\n</code></pre>"},{"location":"developer-guide/guides/importing-yaml/#caracteres-especiais","title":"Caracteres Especiais","text":"<p>Escape caracteres especiais:</p> <pre><code>title: \"Hino: Uma Nova Era\"  # OK\ntitle: 'Hino: Uma Nova Era'  # OK\ntitle: Hino: Uma Nova Era    # ERRO\n</code></pre>"},{"location":"developer-guide/guides/importing-yaml/#quebras-de-linha","title":"Quebras de Linha","text":"<p>Use <code>|</code> para preservar quebras:</p> <pre><code>text: |\n  Primeira linha\n  Segunda linha\n\n  Nova estrofe\n</code></pre>"},{"location":"developer-guide/guides/indexing-search/","title":"Reindexar Busca","text":"<p>Guia para gerenciar o \u00edndice do TypeSense.</p>"},{"location":"developer-guide/guides/indexing-search/#quando-reindexar","title":"Quando Reindexar","text":"<ul> <li>Ap\u00f3s importa\u00e7\u00e3o em batch</li> <li>Quando dados parecem desatualizados</li> <li>Ap\u00f3s mudan\u00e7as no schema</li> <li>Ap\u00f3s restaurar backup</li> </ul>"},{"location":"developer-guide/guides/indexing-search/#comando-basico","title":"Comando B\u00e1sico","text":"<pre><code>poetry run python manage.py reindex_typesense\n</code></pre>"},{"location":"developer-guide/guides/indexing-search/#output-esperado","title":"Output Esperado","text":"<pre><code>Checking TypeSense connection...\nConnection OK: localhost:8108\nDeleting existing 'hymns' collection...\nCreating 'hymns' collection with schema...\nIndexing hymns...\nProgress: 100/1234 hymns...\nProgress: 200/1234 hymns...\n...\nSuccessfully indexed 1234 hymns in 12.5 seconds\n</code></pre>"},{"location":"developer-guide/guides/indexing-search/#opcoes","title":"Op\u00e7\u00f5es","text":""},{"location":"developer-guide/guides/indexing-search/#batch-size","title":"Batch Size","text":"<pre><code># Maior batch = mais r\u00e1pido, mais mem\u00f3ria\npoetry run python manage.py reindex_typesense --batch-size=500\n</code></pre>"},{"location":"developer-guide/guides/indexing-search/#sem-deletar","title":"Sem Deletar","text":"<pre><code># Mant\u00e9m collection existente, apenas atualiza\npoetry run python manage.py reindex_typesense --no-delete\n</code></pre>"},{"location":"developer-guide/guides/indexing-search/#indexacao-individual","title":"Indexa\u00e7\u00e3o Individual","text":""},{"location":"developer-guide/guides/indexing-search/#via-signal","title":"Via Signal","text":"<p>Hinos s\u00e3o indexados automaticamente ao salvar:</p> <pre><code># Ao criar/atualizar um hino, o signal dispara\nhymn = Hymn.objects.create(...)\n# Automaticamente indexado!\n</code></pre>"},{"location":"developer-guide/guides/indexing-search/#via-codigo","title":"Via C\u00f3digo","text":"<pre><code>from apps.search.indexer import index_hymn, delete_hymn\n\n# Indexar\nindex_hymn(hymn)\n\n# Remover\ndelete_hymn(str(hymn.id))\n</code></pre>"},{"location":"developer-guide/guides/indexing-search/#verificar-indice","title":"Verificar \u00cdndice","text":""},{"location":"developer-guide/guides/indexing-search/#via-api","title":"Via API","text":"<pre><code># Health check\ncurl http://localhost:8108/health\n\n# Ver collections\ncurl -H \"X-TYPESENSE-API-KEY: xyz\" \\\n  http://localhost:8108/collections\n\n# Ver stats da collection\ncurl -H \"X-TYPESENSE-API-KEY: xyz\" \\\n  http://localhost:8108/collections/hymns\n</code></pre>"},{"location":"developer-guide/guides/indexing-search/#via-django","title":"Via Django","text":"<pre><code>poetry run python manage.py check_typesense\n</code></pre>"},{"location":"developer-guide/guides/indexing-search/#schema","title":"Schema","text":"<p>O schema atual:</p> <pre><code>HYMNS_SCHEMA = {\n    'name': 'hymns',\n    'fields': [\n        {'name': 'id', 'type': 'string'},\n        {'name': 'hymn_book_id', 'type': 'string'},\n        {'name': 'hymn_book_name', 'type': 'string', 'facet': True},\n        {'name': 'hymn_book_slug', 'type': 'string'},\n        {'name': 'owner_name', 'type': 'string', 'facet': True},\n        {'name': 'number', 'type': 'int32', 'sort': True},\n        {'name': 'title', 'type': 'string'},\n        {'name': 'text', 'type': 'string'},\n        {'name': 'style', 'type': 'string', 'facet': True, 'optional': True},\n    ],\n    'default_sorting_field': 'number'\n}\n</code></pre>"},{"location":"developer-guide/guides/indexing-search/#modificando-schema","title":"Modificando Schema","text":"<p>Se precisar mudar o schema:</p> <ol> <li>Atualize <code>apps/search/schema.py</code></li> <li>Execute <code>reindex_typesense</code></li> <li>Collection \u00e9 recriada com novo schema</li> </ol>"},{"location":"developer-guide/guides/indexing-search/#performance","title":"Performance","text":""},{"location":"developer-guide/guides/indexing-search/#reindexacao-grande","title":"Reindexa\u00e7\u00e3o Grande","text":"<p>Para muitos hinos (10k+):</p> <pre><code># Use batch maior\npoetry run python manage.py reindex_typesense --batch-size=1000\n\n# Considere rodar em background\nnohup poetry run python manage.py reindex_typesense &gt; reindex.log 2&gt;&amp;1 &amp;\n</code></pre>"},{"location":"developer-guide/guides/indexing-search/#monitorar-progresso","title":"Monitorar Progresso","text":"<pre><code># Acompanhar log\ntail -f reindex.log\n</code></pre>"},{"location":"developer-guide/guides/indexing-search/#troubleshooting","title":"Troubleshooting","text":""},{"location":"developer-guide/guides/indexing-search/#connection-refused","title":"Connection Refused","text":"<pre><code># Verificar se TypeSense est\u00e1 rodando\ndocker-compose ps typesense\n\n# Reiniciar\ndocker-compose restart typesense\n</code></pre>"},{"location":"developer-guide/guides/indexing-search/#collection-not-found","title":"Collection Not Found","text":"<pre><code># Recriar collection\npoetry run python manage.py reindex_typesense\n</code></pre>"},{"location":"developer-guide/guides/indexing-search/#dados-desatualizados","title":"Dados Desatualizados","text":"<pre><code># For\u00e7ar recria\u00e7\u00e3o\npoetry run python manage.py reindex_typesense\n</code></pre>"},{"location":"developer-guide/guides/indexing-search/#memory-issues","title":"Memory Issues","text":"<pre><code># Usar batch menor\npoetry run python manage.py reindex_typesense --batch-size=50\n</code></pre>"},{"location":"developer-guide/guides/indexing-search/#em-producao","title":"Em Produ\u00e7\u00e3o","text":""},{"location":"developer-guide/guides/indexing-search/#reindexacao-sem-downtime","title":"Reindexa\u00e7\u00e3o sem Downtime","text":"<pre><code># 1. Criar collection tempor\u00e1ria\ncreate_collection_with_name('hymns_new')\n\n# 2. Indexar na nova\nfor hymn in Hymn.objects.iterator():\n    index_hymn_to_collection(hymn, 'hymns_new')\n\n# 3. Trocar alias (se usar)\n# Ou: deletar antiga e renomear\ndelete_collection('hymns')\nrename_collection('hymns_new', 'hymns')\n</code></pre>"},{"location":"developer-guide/guides/indexing-search/#via-celery","title":"Via Celery","text":"<pre><code>@celery_app.task\ndef reindex_typesense_task():\n    \"\"\"Task para reindexar em background.\"\"\"\n    from apps.search.indexer import reindex_all\n    return reindex_all()\n\n# Disparar\nreindex_typesense_task.delay()\n</code></pre>"},{"location":"developer-guide/guides/working-with-wagtail/","title":"Wagtail CMS","text":"<p>Guia para trabalhar com Wagtail no projeto.</p>"},{"location":"developer-guide/guides/working-with-wagtail/#visao-geral","title":"Vis\u00e3o Geral","text":"<p>Wagtail \u00e9 usado para:</p> <ul> <li>P\u00e1ginas edit\u00e1veis (Home, About)</li> <li>Conte\u00fado est\u00e1tico gerenci\u00e1vel</li> <li>Admin de conte\u00fado amig\u00e1vel</li> </ul>"},{"location":"developer-guide/guides/working-with-wagtail/#estrutura","title":"Estrutura","text":"<pre><code>apps/cms/\n\u251c\u2500\u2500 __init__.py\n\u251c\u2500\u2500 models.py          # Page models\n\u251c\u2500\u2500 wagtail_hooks.py   # Customiza\u00e7\u00f5es admin\n\u2514\u2500\u2500 migrations/\n</code></pre>"},{"location":"developer-guide/guides/working-with-wagtail/#homepage-model","title":"HomePage Model","text":"<pre><code># apps/cms/models.py\nfrom wagtail.models import Page\nfrom wagtail.fields import RichTextField\nfrom wagtail.admin.panels import FieldPanel\n\n\nclass HomePage(Page):\n    \"\"\"P\u00e1gina inicial customizada.\"\"\"\n\n    # Campos\n    intro = RichTextField(blank=True)\n    hero_title = models.CharField(max_length=255, blank=True)\n    hero_subtitle = models.CharField(max_length=255, blank=True)\n\n    # Panels para admin\n    content_panels = Page.content_panels + [\n        FieldPanel('hero_title'),\n        FieldPanel('hero_subtitle'),\n        FieldPanel('intro'),\n    ]\n\n    # Restri\u00e7\u00f5es\n    parent_page_types = []  # S\u00f3 pode ser raiz\n    subpage_types = ['cms.ContentPage']  # P\u00e1ginas filhas permitidas\n\n    def get_context(self, request):\n        context = super().get_context(request)\n        # Adiciona dados din\u00e2micos\n        context['hymnbook_count'] = HymnBook.objects.count()\n        context['hymn_count'] = Hymn.objects.count()\n        return context\n</code></pre>"},{"location":"developer-guide/guides/working-with-wagtail/#contentpage","title":"ContentPage","text":"<pre><code>class ContentPage(Page):\n    \"\"\"P\u00e1gina de conte\u00fado gen\u00e9rica.\"\"\"\n\n    body = RichTextField()\n\n    content_panels = Page.content_panels + [\n        FieldPanel('body'),\n    ]\n\n    parent_page_types = ['cms.HomePage']\n</code></pre>"},{"location":"developer-guide/guides/working-with-wagtail/#streamfield","title":"StreamField","text":"<p>Para conte\u00fado mais flex\u00edvel:</p> <pre><code>from wagtail.blocks import CharBlock, RichTextBlock, StructBlock\nfrom wagtail.fields import StreamField\nfrom wagtail.images.blocks import ImageChooserBlock\n\n\nclass HeroBlock(StructBlock):\n    title = CharBlock()\n    subtitle = CharBlock(required=False)\n    image = ImageChooserBlock(required=False)\n\n    class Meta:\n        template = 'blocks/hero.html'\n\n\nclass FlexiblePage(Page):\n    body = StreamField([\n        ('hero', HeroBlock()),\n        ('text', RichTextBlock()),\n        ('image', ImageChooserBlock()),\n    ], blank=True)\n\n    content_panels = Page.content_panels + [\n        FieldPanel('body'),\n    ]\n</code></pre>"},{"location":"developer-guide/guides/working-with-wagtail/#templates","title":"Templates","text":""},{"location":"developer-guide/guides/working-with-wagtail/#template-base","title":"Template Base","text":"<pre><code>&lt;!-- templates/cms/home_page.html --&gt;\n{% extends \"base.html\" %}\n{% load wagtailcore_tags %}\n\n{% block content %}\n&lt;section class=\"hero\"&gt;\n  &lt;h1&gt;{{ page.hero_title }}&lt;/h1&gt;\n  &lt;p&gt;{{ page.hero_subtitle }}&lt;/p&gt;\n&lt;/section&gt;\n\n&lt;section class=\"intro\"&gt;\n  {{ page.intro|richtext }}\n&lt;/section&gt;\n\n&lt;section class=\"stats\"&gt;\n  &lt;p&gt;{{ hymnbook_count }} hin\u00e1rios&lt;/p&gt;\n  &lt;p&gt;{{ hymn_count }} hinos&lt;/p&gt;\n&lt;/section&gt;\n{% endblock %}\n</code></pre>"},{"location":"developer-guide/guides/working-with-wagtail/#streamfield-template","title":"StreamField Template","text":"<pre><code>&lt;!-- templates/cms/flexible_page.html --&gt;\n{% extends \"base.html\" %}\n{% load wagtailcore_tags %}\n\n{% block content %}\n{% for block in page.body %}\n  {% include_block block %}\n{% endfor %}\n{% endblock %}\n</code></pre>"},{"location":"developer-guide/guides/working-with-wagtail/#admin-customizacao","title":"Admin Customiza\u00e7\u00e3o","text":"<pre><code># apps/cms/wagtail_hooks.py\nfrom wagtail import hooks\nfrom wagtail.admin.panels import FieldPanel\n\n\n@hooks.register('construct_main_menu')\ndef hide_snippets_menu(request, menu_items):\n    \"\"\"Remove itens do menu que n\u00e3o usamos.\"\"\"\n    menu_items[:] = [item for item in menu_items\n                     if item.name not in ['snippets']]\n</code></pre>"},{"location":"developer-guide/guides/working-with-wagtail/#imagens","title":"Imagens","text":""},{"location":"developer-guide/guides/working-with-wagtail/#upload","title":"Upload","text":"<pre><code>from wagtail.images.models import Image\n\n# Via admin Wagtail\n# Imagens \u2192 Upload\n\n# Via c\u00f3digo\nfrom django.core.files import File\nwith open('image.jpg', 'rb') as f:\n    image = Image.objects.create(\n        title='Minha Imagem',\n        file=File(f, name='image.jpg')\n    )\n</code></pre>"},{"location":"developer-guide/guides/working-with-wagtail/#em-templates","title":"Em Templates","text":"<pre><code>{% load wagtailimages_tags %}\n\n{% image page.cover_image width-300 as img %}\n&lt;img src=\"{{ img.url }}\" alt=\"{{ img.alt }}\"&gt;\n</code></pre>"},{"location":"developer-guide/guides/working-with-wagtail/#migrations","title":"Migrations","text":"<pre><code># Criar migrations do CMS\npoetry run python manage.py makemigrations cms\n\n# Aplicar\npoetry run python manage.py migrate\n</code></pre>"},{"location":"developer-guide/guides/working-with-wagtail/#acessar-admin","title":"Acessar Admin","text":"<ol> <li>Inicie o servidor</li> <li>Acesse <code>/admin/</code> (Django) ou <code>/cms/</code> (Wagtail)</li> <li>Use credenciais de superusu\u00e1rio</li> </ol>"},{"location":"developer-guide/guides/working-with-wagtail/#paginas-iniciais","title":"P\u00e1ginas Iniciais","text":"<p>Ap\u00f3s setup, crie:</p> <ol> <li>Root Page (autom\u00e1tica)</li> <li>HomePage como filha da root</li> <li>Defina como <code>Site.root_page</code></li> </ol> <pre><code># Via shell\nfrom wagtail.models import Site\nfrom apps.cms.models import HomePage\n\nhome = HomePage.objects.get(slug='home')\nSite.objects.filter(is_default_site=True).update(root_page=home)\n</code></pre>"},{"location":"developer-guide/guides/working-with-wagtail/#boas-praticas","title":"Boas Pr\u00e1ticas","text":""},{"location":"developer-guide/guides/working-with-wagtail/#campos","title":"Campos","text":"<ul> <li>Use <code>RichTextField</code> para texto formatado</li> <li>Use <code>StreamField</code> para layouts flex\u00edveis</li> <li>Adicione <code>help_text</code> aos campos</li> </ul>"},{"location":"developer-guide/guides/working-with-wagtail/#templates_1","title":"Templates","text":"<ul> <li>Crie templates em <code>templates/cms/</code></li> <li>Use <code>{% include_block %}</code> para StreamField</li> <li>Prefira template tags a l\u00f3gica complexa</li> </ul>"},{"location":"developer-guide/guides/working-with-wagtail/#performance","title":"Performance","text":"<ul> <li>Use <code>select_related</code> quando buscar p\u00e1ginas</li> <li>Cache p\u00e1ginas que mudam pouco</li> <li>Otimize queries no <code>get_context</code></li> </ul>"},{"location":"developer-guide/guides/working-with-wagtail/#troubleshooting","title":"Troubleshooting","text":""},{"location":"developer-guide/guides/working-with-wagtail/#pagina-nao-aparece","title":"P\u00e1gina n\u00e3o aparece","text":"<pre><code># Verificar se est\u00e1 publicada\npage = HomePage.objects.get(slug='home')\nprint(page.live)  # Deve ser True\n</code></pre>"},{"location":"developer-guide/guides/working-with-wagtail/#template-nao-encontrado","title":"Template n\u00e3o encontrado","text":"<p>Verifique:</p> <ol> <li>Nome do template: <code>{app_label}/{model_name}.html</code></li> <li>Localiza\u00e7\u00e3o: <code>templates/cms/home_page.html</code></li> </ol>"},{"location":"developer-guide/guides/working-with-wagtail/#site-nao-configurado","title":"Site n\u00e3o configurado","text":"<pre><code>from wagtail.models import Site\nSite.objects.all()  # Verificar sites\n</code></pre>"},{"location":"developer-guide/setup/common-issues/","title":"Problemas Comuns","text":"<p>Solu\u00e7\u00f5es para problemas frequentes no setup.</p>"},{"location":"developer-guide/setup/common-issues/#instalacao","title":"Instala\u00e7\u00e3o","text":""},{"location":"developer-guide/setup/common-issues/#poetry-nao-encontrado","title":"Poetry n\u00e3o encontrado","text":"<p>Erro: <pre><code>command not found: poetry\n</code></pre></p> <p>Solu\u00e7\u00e3o: <pre><code># Instalar Poetry\ncurl -sSL https://install.python-poetry.org | python3 -\n\n# Adicionar ao PATH\nexport PATH=\"$HOME/.local/bin:$PATH\"\n</code></pre></p>"},{"location":"developer-guide/setup/common-issues/#versao-python-incorreta","title":"Vers\u00e3o Python incorreta","text":"<p>Erro: <pre><code>The currently activated Python version 3.9.x is not supported\n</code></pre></p> <p>Solu\u00e7\u00e3o: <pre><code># Instalar Python 3.11+\n# macOS\nbrew install python@3.11\n\n# Ubuntu\nsudo apt install python3.11\n\n# Usar vers\u00e3o espec\u00edfica\npoetry env use python3.11\npoetry install\n</code></pre></p>"},{"location":"developer-guide/setup/common-issues/#erro-ao-instalar-psycopg2","title":"Erro ao instalar psycopg2","text":"<p>Erro: <pre><code>Error: pg_config executable not found\n</code></pre></p> <p>Solu\u00e7\u00e3o: <pre><code># macOS\nbrew install postgresql\n\n# Ubuntu\nsudo apt install libpq-dev python3-dev\n</code></pre></p>"},{"location":"developer-guide/setup/common-issues/#docker","title":"Docker","text":""},{"location":"developer-guide/setup/common-issues/#container-nao-inicia","title":"Container n\u00e3o inicia","text":"<p>Erro: <pre><code>port is already allocated\n</code></pre></p> <p>Solu\u00e7\u00e3o: <pre><code># Encontrar processo usando a porta\nlsof -i :5432\n\n# Matar processo\nkill -9 &lt;PID&gt;\n\n# Ou mude a porta no docker-compose.yml\n</code></pre></p>"},{"location":"developer-guide/setup/common-issues/#permissao-negada","title":"Permiss\u00e3o negada","text":"<p>Erro: <pre><code>permission denied while trying to connect to Docker\n</code></pre></p> <p>Solu\u00e7\u00e3o: <pre><code># Adicionar usu\u00e1rio ao grupo docker\nsudo usermod -aG docker $USER\n\n# Logout e login novamente\n</code></pre></p>"},{"location":"developer-guide/setup/common-issues/#volume-com-dados-antigos","title":"Volume com dados antigos","text":"<p>Problema: Migrations n\u00e3o funcionam</p> <p>Solu\u00e7\u00e3o: <pre><code># Limpar volumes\ndocker-compose down -v\ndocker-compose up -d\n</code></pre></p>"},{"location":"developer-guide/setup/common-issues/#database","title":"Database","text":""},{"location":"developer-guide/setup/common-issues/#connection-refused","title":"Connection refused","text":"<p>Erro: <pre><code>connection refused to localhost:5432\n</code></pre></p> <p>Solu\u00e7\u00e3o:</p> <ol> <li> <p>Verificar se container est\u00e1 rodando: <pre><code>docker-compose ps\n</code></pre></p> </li> <li> <p>Verificar logs: <pre><code>docker-compose logs postgres\n</code></pre></p> </li> <li> <p>Reiniciar container: <pre><code>docker-compose restart postgres\n</code></pre></p> </li> </ol>"},{"location":"developer-guide/setup/common-issues/#migrations-falham","title":"Migrations falham","text":"<p>Erro: <pre><code>relation \"table_name\" does not exist\n</code></pre></p> <p>Solu\u00e7\u00e3o: <pre><code># Reset completo\ndocker-compose down -v\ndocker-compose up -d\npoetry run python manage.py migrate\n</code></pre></p>"},{"location":"developer-guide/setup/common-issues/#typesense","title":"TypeSense","text":""},{"location":"developer-guide/setup/common-issues/#connection-refused_1","title":"Connection refused","text":"<p>Erro: <pre><code>typesense.exceptions.RequestUnauthorized\n</code></pre></p> <p>Solu\u00e7\u00e3o:</p> <ol> <li>Verificar se container est\u00e1 rodando</li> <li>Verificar <code>TYPESENSE_API_KEY</code> no <code>.env</code></li> <li>Testar conex\u00e3o: <pre><code>curl -H \"X-TYPESENSE-API-KEY: xyz\" \\\n  http://localhost:8108/health\n</code></pre></li> </ol>"},{"location":"developer-guide/setup/common-issues/#collection-nao-existe","title":"Collection n\u00e3o existe","text":"<p>Erro: <pre><code>ObjectNotFound: Collection 'hymns' not found\n</code></pre></p> <p>Solu\u00e7\u00e3o: <pre><code>poetry run python manage.py reindex_typesense\n</code></pre></p>"},{"location":"developer-guide/setup/common-issues/#redis","title":"Redis","text":""},{"location":"developer-guide/setup/common-issues/#connection-refused_2","title":"Connection refused","text":"<p>Erro: <pre><code>redis.exceptions.ConnectionError\n</code></pre></p> <p>Solu\u00e7\u00e3o: <pre><code># Verificar container\ndocker-compose ps redis\n\n# Testar conex\u00e3o\nredis-cli ping\n</code></pre></p>"},{"location":"developer-guide/setup/common-issues/#testes","title":"Testes","text":""},{"location":"developer-guide/setup/common-issues/#testes-e2e-falham","title":"Testes E2E falham","text":"<p>Erro: <pre><code>playwright._impl._errors.Error: Browser not found\n</code></pre></p> <p>Solu\u00e7\u00e3o: <pre><code>poetry run playwright install chromium\n</code></pre></p>"},{"location":"developer-guide/setup/common-issues/#servidor-nao-esta-rodando","title":"Servidor n\u00e3o est\u00e1 rodando","text":"<p>Erro: <pre><code>ConnectionRefusedError: [Errno 111] Connection refused\n</code></pre></p> <p>Solu\u00e7\u00e3o: <pre><code># Em um terminal\npoetry run python manage.py runserver 9000\n\n# Em outro terminal\npoetry run pytest tests/e2e/ -v\n</code></pre></p>"},{"location":"developer-guide/setup/common-issues/#coverage-baixa","title":"Coverage baixa","text":"<p>Problema: Coverage &lt; 80%</p> <p>Solu\u00e7\u00e3o: <pre><code># Ver arquivos n\u00e3o cobertos\npoetry run pytest --cov=apps --cov-report=html\nopen htmlcov/index.html\n</code></pre></p>"},{"location":"developer-guide/setup/common-issues/#geral","title":"Geral","text":""},{"location":"developer-guide/setup/common-issues/#import-error","title":"Import error","text":"<p>Erro: <pre><code>ModuleNotFoundError: No module named 'apps'\n</code></pre></p> <p>Solu\u00e7\u00e3o: <pre><code># Certificar que est\u00e1 no diret\u00f3rio correto\ncd hyms-plat\n\n# Reinstalar depend\u00eancias\npoetry install\n</code></pre></p>"},{"location":"developer-guide/setup/common-issues/#settings-nao-encontradas","title":"Settings n\u00e3o encontradas","text":"<p>Erro: <pre><code>django.core.exceptions.ImproperlyConfigured\n</code></pre></p> <p>Solu\u00e7\u00e3o: <pre><code>export DJANGO_SETTINGS_MODULE=config.settings.local\n</code></pre></p>"},{"location":"developer-guide/setup/common-issues/#arquivo-env-nao-carrega","title":"Arquivo .env n\u00e3o carrega","text":"<p>Problema: Vari\u00e1veis undefined</p> <p>Solu\u00e7\u00e3o:</p> <ol> <li> <p>Verificar se <code>.env</code> existe: <pre><code>ls -la .env\n</code></pre></p> </li> <li> <p>Verificar formato: <pre><code># Correto\nDATABASE_URL=postgres://...\n\n# Errado (n\u00e3o use aspas)\nDATABASE_URL=\"postgres://...\"\n</code></pre></p> </li> </ol>"},{"location":"developer-guide/setup/common-issues/#ainda-com-problemas","title":"Ainda com problemas?","text":"<ol> <li>Verifique os Issues no GitHub</li> <li>Abra um novo issue com:</li> <li>Descri\u00e7\u00e3o do problema</li> <li>Mensagem de erro completa</li> <li>Sistema operacional</li> <li>Vers\u00f5es (Python, Docker, etc.)</li> </ol>"},{"location":"developer-guide/setup/docker-services/","title":"Docker Services","text":"<p>Servi\u00e7os externos gerenciados via Docker.</p>"},{"location":"developer-guide/setup/docker-services/#visao-geral","title":"Vis\u00e3o Geral","text":"<p>O projeto usa tr\u00eas servi\u00e7os principais:</p> Servi\u00e7o Imagem Porta PostgreSQL postgres:16-alpine 5432 Redis redis:7-alpine 6379 TypeSense typesense/typesense:27.1 8108"},{"location":"developer-guide/setup/docker-services/#docker-compose","title":"Docker Compose","text":"<pre><code># docker-compose.yml\nversion: '3.8'\n\nservices:\n  postgres:\n    image: postgres:16-alpine\n    environment:\n      POSTGRES_DB: hymnplat\n      POSTGRES_USER: hymnplat\n      POSTGRES_PASSWORD: hymnplat\n    ports:\n      - \"5432:5432\"\n    volumes:\n      - postgres_data:/var/lib/postgresql/data\n    healthcheck:\n      test: [\"CMD-SHELL\", \"pg_isready -U hymnplat\"]\n      interval: 10s\n      timeout: 5s\n      retries: 5\n\n  redis:\n    image: redis:7-alpine\n    ports:\n      - \"6379:6379\"\n    volumes:\n      - redis_data:/data\n    healthcheck:\n      test: [\"CMD\", \"redis-cli\", \"ping\"]\n      interval: 10s\n      timeout: 5s\n      retries: 5\n\n  typesense:\n    image: typesense/typesense:27.1\n    ports:\n      - \"8108:8108\"\n    environment:\n      TYPESENSE_API_KEY: xyz\n      TYPESENSE_DATA_DIR: /data\n    volumes:\n      - typesense_data:/data\n\nvolumes:\n  postgres_data:\n  redis_data:\n  typesense_data:\n</code></pre>"},{"location":"developer-guide/setup/docker-services/#comandos","title":"Comandos","text":""},{"location":"developer-guide/setup/docker-services/#iniciar-todos","title":"Iniciar Todos","text":"<pre><code>docker-compose up -d\n</code></pre>"},{"location":"developer-guide/setup/docker-services/#parar-todos","title":"Parar Todos","text":"<pre><code>docker-compose down\n</code></pre>"},{"location":"developer-guide/setup/docker-services/#ver-logs","title":"Ver Logs","text":"<pre><code># Todos os servi\u00e7os\ndocker-compose logs -f\n\n# Servi\u00e7o espec\u00edfico\ndocker-compose logs -f postgres\n</code></pre>"},{"location":"developer-guide/setup/docker-services/#reiniciar-servico","title":"Reiniciar Servi\u00e7o","text":"<pre><code>docker-compose restart postgres\n</code></pre>"},{"location":"developer-guide/setup/docker-services/#limpar-dados","title":"Limpar Dados","text":"<pre><code># Para e remove volumes\ndocker-compose down -v\n</code></pre>"},{"location":"developer-guide/setup/docker-services/#postgresql","title":"PostgreSQL","text":""},{"location":"developer-guide/setup/docker-services/#conexao","title":"Conex\u00e3o","text":"<pre><code># Via psql\ndocker-compose exec postgres psql -U hymnplat\n\n# Via Django\npoetry run python manage.py dbshell\n</code></pre>"},{"location":"developer-guide/setup/docker-services/#backup","title":"Backup","text":"<pre><code>docker-compose exec postgres pg_dump -U hymnplat hymnplat &gt; backup.sql\n</code></pre>"},{"location":"developer-guide/setup/docker-services/#restore","title":"Restore","text":"<pre><code>cat backup.sql | docker-compose exec -T postgres psql -U hymnplat\n</code></pre>"},{"location":"developer-guide/setup/docker-services/#redis","title":"Redis","text":""},{"location":"developer-guide/setup/docker-services/#conexao_1","title":"Conex\u00e3o","text":"<pre><code>docker-compose exec redis redis-cli\n</code></pre>"},{"location":"developer-guide/setup/docker-services/#comandos-uteis","title":"Comandos \u00dateis","text":"<pre><code># Ping\nredis-cli ping\n\n# Ver todas as keys\nredis-cli keys '*'\n\n# Limpar cache\nredis-cli flushall\n</code></pre>"},{"location":"developer-guide/setup/docker-services/#typesense","title":"TypeSense","text":""},{"location":"developer-guide/setup/docker-services/#health-check","title":"Health Check","text":"<pre><code>curl http://localhost:8108/health\n</code></pre>"},{"location":"developer-guide/setup/docker-services/#ver-collections","title":"Ver Collections","text":"<pre><code>curl -H \"X-TYPESENSE-API-KEY: xyz\" \\\n  http://localhost:8108/collections\n</code></pre>"},{"location":"developer-guide/setup/docker-services/#ver-estatisticas","title":"Ver Estat\u00edsticas","text":"<pre><code>curl -H \"X-TYPESENSE-API-KEY: xyz\" \\\n  http://localhost:8108/collections/hymns\n</code></pre>"},{"location":"developer-guide/setup/docker-services/#troubleshooting","title":"Troubleshooting","text":""},{"location":"developer-guide/setup/docker-services/#container-nao-inicia","title":"Container n\u00e3o inicia","text":"<pre><code># Ver logs\ndocker-compose logs postgres\n\n# Verificar recursos\ndocker stats\n</code></pre>"},{"location":"developer-guide/setup/docker-services/#porta-ja-em-uso","title":"Porta j\u00e1 em uso","text":"<pre><code># Encontrar processo\nlsof -i :5432\n\n# Matar processo\nkill -9 &lt;PID&gt;\n\n# Ou mude a porta no docker-compose.yml\nports:\n  - \"5433:5432\"\n</code></pre>"},{"location":"developer-guide/setup/docker-services/#dados-persistentes","title":"Dados persistentes","text":"<p>Os dados s\u00e3o persistidos em Docker volumes:</p> <pre><code># Listar volumes\ndocker volume ls\n\n# Inspecionar volume\ndocker volume inspect hyms-plat_postgres_data\n</code></pre>"},{"location":"developer-guide/setup/environment-variables/","title":"Vari\u00e1veis de Ambiente","text":"<p>Todas as vari\u00e1veis de ambiente usadas no projeto.</p>"},{"location":"developer-guide/setup/environment-variables/#arquivo-env","title":"Arquivo .env","text":"<p>Copie o exemplo:</p> <pre><code>cp .env.example .env\n</code></pre>"},{"location":"developer-guide/setup/environment-variables/#variaveis-obrigatorias","title":"Vari\u00e1veis Obrigat\u00f3rias","text":""},{"location":"developer-guide/setup/environment-variables/#django","title":"Django","text":"Vari\u00e1vel Descri\u00e7\u00e3o Exemplo <code>SECRET_KEY</code> Chave secreta Django <code>sua-chave-muito-secreta-aqui</code> <code>DEBUG</code> Modo debug <code>True</code> / <code>False</code> <code>ALLOWED_HOSTS</code> Hosts permitidos <code>localhost,127.0.0.1</code>"},{"location":"developer-guide/setup/environment-variables/#database","title":"Database","text":"Vari\u00e1vel Descri\u00e7\u00e3o Exemplo <code>DATABASE_URL</code> URL de conex\u00e3o <code>postgres://user:pass@host:5432/db</code> <p>Ou separadamente:</p> Vari\u00e1vel Descri\u00e7\u00e3o Exemplo <code>DATABASE_NAME</code> Nome do banco <code>hymnplat</code> <code>DATABASE_USER</code> Usu\u00e1rio <code>hymnplat</code> <code>DATABASE_PASSWORD</code> Senha <code>hymnplat</code> <code>DATABASE_HOST</code> Host <code>localhost</code> <code>DATABASE_PORT</code> Porta <code>5432</code>"},{"location":"developer-guide/setup/environment-variables/#typesense","title":"TypeSense","text":"Vari\u00e1vel Descri\u00e7\u00e3o Exemplo <code>TYPESENSE_API_KEY</code> Chave da API <code>xyz</code> <code>TYPESENSE_HOST</code> Host <code>localhost</code> <code>TYPESENSE_PORT</code> Porta <code>8108</code> <code>TYPESENSE_PROTOCOL</code> Protocolo <code>http</code> / <code>https</code>"},{"location":"developer-guide/setup/environment-variables/#redis","title":"Redis","text":"Vari\u00e1vel Descri\u00e7\u00e3o Exemplo <code>REDIS_URL</code> URL de conex\u00e3o <code>redis://localhost:6379/0</code>"},{"location":"developer-guide/setup/environment-variables/#variaveis-opcionais","title":"Vari\u00e1veis Opcionais","text":""},{"location":"developer-guide/setup/environment-variables/#email","title":"Email","text":"Vari\u00e1vel Descri\u00e7\u00e3o Default <code>EMAIL_BACKEND</code> Backend de email <code>console</code> <code>EMAIL_HOST</code> Servidor SMTP - <code>EMAIL_PORT</code> Porta SMTP <code>587</code> <code>EMAIL_USE_TLS</code> Usar TLS <code>True</code> <code>EMAIL_HOST_USER</code> Usu\u00e1rio SMTP - <code>EMAIL_HOST_PASSWORD</code> Senha SMTP -"},{"location":"developer-guide/setup/environment-variables/#oauth-google","title":"OAuth (Google)","text":"Vari\u00e1vel Descri\u00e7\u00e3o <code>GOOGLE_CLIENT_ID</code> Client ID do Google <code>GOOGLE_CLIENT_SECRET</code> Client Secret"},{"location":"developer-guide/setup/environment-variables/#celery","title":"Celery","text":"Vari\u00e1vel Descri\u00e7\u00e3o Default <code>CELERY_BROKER_URL</code> Broker URL <code>redis://localhost:6379/0</code> <code>CELERY_RESULT_BACKEND</code> Backend <code>redis://localhost:6379/0</code>"},{"location":"developer-guide/setup/environment-variables/#logging","title":"Logging","text":"Vari\u00e1vel Descri\u00e7\u00e3o Default <code>LOG_LEVEL</code> N\u00edvel de log <code>INFO</code>"},{"location":"developer-guide/setup/environment-variables/#exemplo-completo","title":"Exemplo Completo","text":"<pre><code># .env\n\n# Django\nSECRET_KEY=django-insecure-change-this-in-production\nDEBUG=True\nALLOWED_HOSTS=localhost,127.0.0.1\n\n# Database\nDATABASE_URL=postgres://hymnplat:hymnplat@localhost:5432/hymnplat\n\n# TypeSense\nTYPESENSE_API_KEY=xyz\nTYPESENSE_HOST=localhost\nTYPESENSE_PORT=8108\nTYPESENSE_PROTOCOL=http\n\n# Redis\nREDIS_URL=redis://localhost:6379/0\n\n# Email (desenvolvimento)\nEMAIL_BACKEND=django.core.mail.backends.console.EmailBackend\n</code></pre>"},{"location":"developer-guide/setup/environment-variables/#por-ambiente","title":"Por Ambiente","text":""},{"location":"developer-guide/setup/environment-variables/#desenvolvimento","title":"Desenvolvimento","text":"<pre><code>DEBUG=True\nEMAIL_BACKEND=django.core.mail.backends.console.EmailBackend\n</code></pre>"},{"location":"developer-guide/setup/environment-variables/#producao","title":"Produ\u00e7\u00e3o","text":"<pre><code>DEBUG=False\nALLOWED_HOSTS=seudominio.com\nSECRET_KEY=chave-muito-segura-gerada-aleatoriamente\n\n# Email real\nEMAIL_BACKEND=django.core.mail.backends.smtp.EmailBackend\nEMAIL_HOST=smtp.seudominio.com\n</code></pre>"},{"location":"developer-guide/setup/environment-variables/#acessando-no-codigo","title":"Acessando no C\u00f3digo","text":"<pre><code>import os\nfrom django.conf import settings\n\n# Via os.environ\napi_key = os.environ.get('TYPESENSE_API_KEY')\n\n# Via django-environ\nfrom config.settings.base import env\napi_key = env('TYPESENSE_API_KEY')\n\n# Via settings\nfrom django.conf import settings\ndebug = settings.DEBUG\n</code></pre>"},{"location":"developer-guide/setup/environment-variables/#seguranca","title":"Seguran\u00e7a","text":"<p>Importante</p> <ul> <li>Nunca commite <code>.env</code> no reposit\u00f3rio</li> <li>Use senhas fortes em produ\u00e7\u00e3o</li> <li>Rotacione <code>SECRET_KEY</code> periodicamente</li> <li>Use vari\u00e1veis de ambiente do sistema em produ\u00e7\u00e3o</li> </ul>"},{"location":"developer-guide/setup/local-development/","title":"Setup Local","text":"<p>Guia completo para configurar o ambiente de desenvolvimento.</p>"},{"location":"developer-guide/setup/local-development/#pre-requisitos","title":"Pr\u00e9-requisitos","text":"<ul> <li>Python 3.11+</li> <li>Poetry 1.8+</li> <li>Docker e Docker Compose</li> <li>Git</li> </ul>"},{"location":"developer-guide/setup/local-development/#passo-a-passo","title":"Passo a Passo","text":""},{"location":"developer-guide/setup/local-development/#1-clone-o-repositorio","title":"1. Clone o Reposit\u00f3rio","text":"<pre><code>git clone https://github.com/nitai-bezerra/hyms-plat.git\ncd hyms-plat\n</code></pre>"},{"location":"developer-guide/setup/local-development/#2-instale-dependencias","title":"2. Instale Depend\u00eancias","text":"<pre><code># Instalar Poetry (se n\u00e3o tiver)\ncurl -sSL https://install.python-poetry.org | python3 -\n\n# Instalar depend\u00eancias\npoetry install\n</code></pre>"},{"location":"developer-guide/setup/local-development/#3-inicie-os-servicos-docker","title":"3. Inicie os Servi\u00e7os Docker","text":"<pre><code>docker-compose up -d\n</code></pre> <p>Isso inicia:</p> <ul> <li>PostgreSQL 16 (porta 5432)</li> <li>Redis 7 (porta 6379)</li> <li>TypeSense 27.1 (porta 8108)</li> </ul>"},{"location":"developer-guide/setup/local-development/#4-configure-variaveis-de-ambiente","title":"4. Configure Vari\u00e1veis de Ambiente","text":"<pre><code>cp .env.example .env\n</code></pre> <p>Edite <code>.env</code> com suas configura\u00e7\u00f5es:</p> <pre><code># Database\nDATABASE_URL=postgres://hymnplat:hymnplat@localhost:5432/hymnplat\n\n# TypeSense\nTYPESENSE_API_KEY=xyz\nTYPESENSE_HOST=localhost\nTYPESENSE_PORT=8108\nTYPESENSE_PROTOCOL=http\n\n# Redis\nREDIS_URL=redis://localhost:6379/0\n\n# Django\nSECRET_KEY=sua-chave-secreta-aqui\nDEBUG=True\nALLOWED_HOSTS=localhost,127.0.0.1\n</code></pre>"},{"location":"developer-guide/setup/local-development/#5-execute-migrations","title":"5. Execute Migrations","text":"<pre><code>poetry run python manage.py migrate\n</code></pre>"},{"location":"developer-guide/setup/local-development/#6-crie-superusuario","title":"6. Crie Superusu\u00e1rio","text":"<pre><code>poetry run python manage.py createsuperuser\n</code></pre>"},{"location":"developer-guide/setup/local-development/#7-importe-dados-de-teste-opcional","title":"7. Importe Dados de Teste (Opcional)","text":"<pre><code>poetry run python manage.py import_yaml tests/fixtures/test_hymnbook.yaml\n</code></pre>"},{"location":"developer-guide/setup/local-development/#8-indexe-no-typesense","title":"8. Indexe no TypeSense","text":"<pre><code>poetry run python manage.py reindex_typesense\n</code></pre>"},{"location":"developer-guide/setup/local-development/#9-inicie-o-servidor","title":"9. Inicie o Servidor","text":"<pre><code>poetry run python manage.py runserver\n</code></pre> <p>Acesse: http://localhost:8000</p>"},{"location":"developer-guide/setup/local-development/#comandos-uteis","title":"Comandos \u00dateis","text":"<pre><code># Servidor Django\npoetry run python manage.py runserver\n\n# Shell Django\npoetry run python manage.py shell\n\n# Rodar testes\npoetry run pytest\n\n# Rodar testes com coverage\npoetry run pytest --cov=apps\n\n# Formatar c\u00f3digo\npoetry run black .\npoetry run isort .\n\n# Lint\npoetry run ruff check .\n\n# Reindexar busca\npoetry run python manage.py reindex_typesense\n</code></pre>"},{"location":"developer-guide/setup/local-development/#verificacao","title":"Verifica\u00e7\u00e3o","text":""},{"location":"developer-guide/setup/local-development/#tudo-funcionando","title":"Tudo funcionando?","text":"<ul> <li>[ ] <code>http://localhost:8000</code> - Django rodando</li> <li>[ ] <code>http://localhost:8000/admin/</code> - Admin acess\u00edvel</li> <li>[ ] <code>http://localhost:8108/health</code> - TypeSense saud\u00e1vel</li> <li>[ ] <code>docker ps</code> - 3 containers rodando</li> </ul>"},{"location":"developer-guide/setup/local-development/#rodar-testes","title":"Rodar testes","text":"<pre><code>poetry run pytest\n</code></pre> <p>Todos os testes devem passar.</p>"},{"location":"developer-guide/setup/local-development/#proximos-passos","title":"Pr\u00f3ximos Passos","text":"<ul> <li>Docker Services - Detalhes dos containers</li> <li>Vari\u00e1veis de Ambiente - Todas as vari\u00e1veis</li> <li>Problemas Comuns - Troubleshooting</li> </ul>"},{"location":"developer-guide/testing/coverage/","title":"Coverage","text":"<p>Medindo e melhorando cobertura de testes.</p>"},{"location":"developer-guide/testing/coverage/#visao-geral","title":"Vis\u00e3o Geral","text":"<p>Coverage mede quais linhas de c\u00f3digo s\u00e3o executadas pelos testes.</p> <p>Meta do projeto: 80%+</p>"},{"location":"developer-guide/testing/coverage/#ferramentas","title":"Ferramentas","text":""},{"location":"developer-guide/testing/coverage/#pytest-cov","title":"pytest-cov","text":"<pre><code># Rodar com coverage\npoetry run pytest --cov=apps\n\n# Com relat\u00f3rio HTML\npoetry run pytest --cov=apps --cov-report=html\n\n# Abrir relat\u00f3rio\nopen htmlcov/index.html\n</code></pre>"},{"location":"developer-guide/testing/coverage/#configuracao","title":"Configura\u00e7\u00e3o","text":"<pre><code># pyproject.toml\n[tool.coverage.run]\nsource = [\"apps\"]\nomit = [\n    \"*/migrations/*\",\n    \"*/tests/*\",\n    \"*/__init__.py\",\n]\nbranch = true\n\n[tool.coverage.report]\nexclude_lines = [\n    \"pragma: no cover\",\n    \"def __repr__\",\n    \"raise NotImplementedError\",\n    \"if TYPE_CHECKING:\",\n]\nfail_under = 80\nshow_missing = true\n</code></pre>"},{"location":"developer-guide/testing/coverage/#relatorios","title":"Relat\u00f3rios","text":""},{"location":"developer-guide/testing/coverage/#terminal","title":"Terminal","text":"<pre><code>---------- coverage: platform darwin, python 3.11.0 -----------\nName                          Stmts   Miss  Cover\n-------------------------------------------------\napps/core/__init__.py             0      0   100%\napps/core/models.py              15      2    87%\napps/hymns/models.py             82      5    94%\napps/hymns/views.py              45      8    82%\napps/search/client.py            32      4    88%\napps/users/models.py             28      3    89%\napps/users/views.py              67     12    82%\n-------------------------------------------------\nTOTAL                           269     34    87%\n</code></pre>"},{"location":"developer-guide/testing/coverage/#html","title":"HTML","text":"<p>O relat\u00f3rio HTML mostra:</p> <ul> <li>Arquivos ordenados por coverage</li> <li>Linhas cobertas (verde)</li> <li>Linhas n\u00e3o cobertas (vermelho)</li> <li>Branch coverage</li> </ul>"},{"location":"developer-guide/testing/coverage/#xml-ci","title":"XML (CI)","text":"<pre><code>poetry run pytest --cov=apps --cov-report=xml\n</code></pre> <p>Para upload ao Codecov:</p> <pre><code>- name: Upload coverage\n  uses: codecov/codecov-action@v4\n  with:\n    file: ./coverage.xml\n</code></pre>"},{"location":"developer-guide/testing/coverage/#analisando-gaps","title":"Analisando Gaps","text":""},{"location":"developer-guide/testing/coverage/#encontrar-codigo-nao-coberto","title":"Encontrar c\u00f3digo n\u00e3o coberto","text":"<pre><code># Relat\u00f3rio com linhas faltando\npoetry run pytest --cov=apps --cov-report=term-missing\n</code></pre> <p>Output: <pre><code>apps/hymns/views.py    45    8   82%   34-38, 67-70\n</code></pre></p> <p>Linhas 34-38 e 67-70 n\u00e3o est\u00e3o cobertas.</p>"},{"location":"developer-guide/testing/coverage/#analisar-arquivo-especifico","title":"Analisar arquivo espec\u00edfico","text":"<pre><code># Coverage de um arquivo\npoetry run pytest tests/unit/test_views.py --cov=apps.hymns.views\n</code></pre>"},{"location":"developer-guide/testing/coverage/#melhorando-coverage","title":"Melhorando Coverage","text":""},{"location":"developer-guide/testing/coverage/#identificar-gaps","title":"Identificar Gaps","text":"<ol> <li>Rodar <code>pytest --cov-report=html</code></li> <li>Abrir <code>htmlcov/index.html</code></li> <li>Clicar em arquivos com baixa cobertura</li> <li>Ver linhas vermelhas</li> </ol>"},{"location":"developer-guide/testing/coverage/#adicionar-testes","title":"Adicionar Testes","text":"<pre><code># C\u00f3digo n\u00e3o coberto\ndef some_view(request):\n    if request.method == 'POST':  # Linha coberta\n        return handle_post(request)\n    elif request.method == 'PUT':  # Linha N\u00c3O coberta\n        return handle_put(request)  # Linha N\u00c3O coberta\n    return handle_get(request)  # Linha coberta\n\n# Adicionar teste\ndef test_put_request(client):\n    response = client.put('/endpoint/')\n    assert response.status_code == 200\n</code></pre>"},{"location":"developer-guide/testing/coverage/#codigo-que-nao-precisa-testar","title":"C\u00f3digo que N\u00e3o Precisa Testar","text":"<pre><code># Marcar como n\u00e3o-test\u00e1vel\ndef debug_function():  # pragma: no cover\n    \"\"\"Fun\u00e7\u00e3o apenas para debug.\"\"\"\n    print(\"Debug info\")\n</code></pre>"},{"location":"developer-guide/testing/coverage/#branch-coverage","title":"Branch Coverage","text":"<p>Mede se ambos os caminhos de um <code>if</code> s\u00e3o testados.</p> <pre><code>def check_value(x):\n    if x &gt; 0:  # Branch 1: True\n        return \"positive\"\n    return \"non-positive\"  # Branch 2: False\n\n# Teste incompleto (s\u00f3 cobre Branch 1)\ndef test_positive():\n    assert check_value(5) == \"positive\"\n\n# Teste completo (cobre ambos)\ndef test_positive_and_negative():\n    assert check_value(5) == \"positive\"\n    assert check_value(-5) == \"non-positive\"\n</code></pre>"},{"location":"developer-guide/testing/coverage/#cicd","title":"CI/CD","text":""},{"location":"developer-guide/testing/coverage/#fail-se-coverage-baixa","title":"Fail se Coverage Baixa","text":"<pre><code># pyproject.toml\n[tool.coverage.report]\nfail_under = 80\n</code></pre> <pre><code># Falha se &lt; 80%\npoetry run pytest --cov=apps --cov-fail-under=80\n</code></pre>"},{"location":"developer-guide/testing/coverage/#codecov-badge","title":"Codecov Badge","text":"<pre><code>[![codecov](https://codecov.io/gh/user/repo/branch/main/graph/badge.svg)](https://codecov.io/gh/user/repo)\n</code></pre>"},{"location":"developer-guide/testing/coverage/#metricas-atuais","title":"M\u00e9tricas Atuais","text":"M\u00f3dulo Coverage apps.hymns 90% apps.search 85% apps.users 82% apps.cms 78% apps.core 95% Total 83%"},{"location":"developer-guide/testing/coverage/#boas-praticas","title":"Boas Pr\u00e1ticas","text":""},{"location":"developer-guide/testing/coverage/#nao-persiga-100","title":"N\u00e3o Persiga 100%","text":"<ul> <li>80-90% \u00e9 geralmente suficiente</li> <li>C\u00f3digo trivial n\u00e3o precisa de teste</li> <li>Foque em c\u00f3digo cr\u00edtico</li> </ul>"},{"location":"developer-guide/testing/coverage/#qualidade-quantidade","title":"Qualidade &gt; Quantidade","text":"<pre><code># Ruim: teste que s\u00f3 aumenta coverage\ndef test_model_str():\n    obj = Model()\n    str(obj)  # N\u00e3o verifica nada!\n\n# Bom: teste que verifica comportamento\ndef test_model_str_format():\n    obj = Model(name=\"Test\")\n    assert str(obj) == \"Test\"\n    assert \"Test\" in repr(obj)\n</code></pre>"},{"location":"developer-guide/testing/coverage/#teste-edge-cases","title":"Teste Edge Cases","text":"<pre><code>def test_edge_cases():\n    # Valores limites\n    assert function(0) == expected\n    assert function(-1) == expected\n    assert function(MAX_VALUE) == expected\n\n    # Casos especiais\n    assert function(None) raises ValueError\n    assert function(\"\") == default\n</code></pre>"},{"location":"developer-guide/testing/e2e-tests/","title":"Testes E2E","text":"<p>Testes end-to-end com Playwright.</p>"},{"location":"developer-guide/testing/e2e-tests/#visao-geral","title":"Vis\u00e3o Geral","text":"<p>Testes E2E simulam usu\u00e1rios reais navegando pelo site.</p> <pre><code>def test_user_can_search(page, base_url):\n    page.goto(base_url)\n    page.fill('input[name=\"q\"]', \"lua\")\n    page.click('button[type=\"submit\"]')\n\n    expect(page.locator(\".card\")).to_be_visible()\n</code></pre>"},{"location":"developer-guide/testing/e2e-tests/#setup","title":"Setup","text":""},{"location":"developer-guide/testing/e2e-tests/#instalacao","title":"Instala\u00e7\u00e3o","text":"<pre><code># Depend\u00eancia (j\u00e1 no pyproject.toml)\npoetry add playwright --group dev\n\n# Instalar browsers\npoetry run playwright install chromium\n</code></pre>"},{"location":"developer-guide/testing/e2e-tests/#configuracao","title":"Configura\u00e7\u00e3o","text":"<pre><code># tests/e2e/conftest.py\nimport pytest\nfrom playwright.sync_api import sync_playwright, Page, Browser\n\n\n@pytest.fixture(scope=\"session\")\ndef browser():\n    \"\"\"Browser instance compartilhada.\"\"\"\n    with sync_playwright() as p:\n        browser = p.chromium.launch(headless=True)\n        yield browser\n        browser.close()\n\n\n@pytest.fixture\ndef page(browser: Browser):\n    \"\"\"Nova p\u00e1gina para cada teste.\"\"\"\n    context = browser.new_context(\n        viewport={\"width\": 1280, \"height\": 720}\n    )\n    page = context.new_page()\n    yield page\n    page.close()\n    context.close()\n\n\n@pytest.fixture\ndef base_url():\n    \"\"\"URL do servidor de testes.\"\"\"\n    return \"http://localhost:9000\"\n\n\n@pytest.fixture\ndef authenticated_page(page: Page, base_url: str):\n    \"\"\"P\u00e1gina com usu\u00e1rio logado.\"\"\"\n    page.goto(f\"{base_url}/accounts/login/\")\n    page.fill('input[name=\"login\"]', \"teste2e@example.com\")\n    page.fill('input[name=\"password\"]', \"testpass123\")\n    page.click('button[type=\"submit\"]')\n    page.wait_for_url(f\"{base_url}/**\")\n    return page\n</code></pre>"},{"location":"developer-guide/testing/e2e-tests/#estrutura","title":"Estrutura","text":"<pre><code>tests/e2e/\n\u251c\u2500\u2500 conftest.py           # Fixtures E2E\n\u251c\u2500\u2500 test_navigation.py    # Navega\u00e7\u00e3o p\u00fablica\n\u251c\u2500\u2500 test_auth.py          # Autentica\u00e7\u00e3o\n\u251c\u2500\u2500 test_upload.py        # Upload de hin\u00e1rios\n\u2514\u2500\u2500 test_social.py        # Features sociais\n</code></pre>"},{"location":"developer-guide/testing/e2e-tests/#exemplos","title":"Exemplos","text":""},{"location":"developer-guide/testing/e2e-tests/#navegacao","title":"Navega\u00e7\u00e3o","text":"<pre><code># tests/e2e/test_navigation.py\nimport pytest\nfrom playwright.sync_api import Page, expect\n\n\n@pytest.mark.e2e\nclass TestPublicNavigation:\n    def test_home_page_loads(self, page: Page, base_url: str):\n        page.goto(base_url)\n\n        expect(page.locator(\"h1\")).to_be_visible()\n        title = page.title()\n        assert \"Portal\" in title or \"Hin\u00e1rio\" in title\n\n    def test_hymnbook_list(self, page: Page, base_url: str):\n        page.goto(f\"{base_url}/hinarios/\")\n\n        expect(page.get_by_role(\"heading\", name=\"Hin\u00e1rios\")).to_be_visible()\n        expect(page.locator(\".card\").first).to_be_visible()\n\n    def test_search_works(self, page: Page, base_url: str):\n        page.goto(f\"{base_url}/busca/\")\n        page.fill('input[name=\"q\"]', \"lua\")\n        page.click('button[type=\"submit\"]')\n\n        page.wait_for_load_state(\"networkidle\")\n        # Verifica resultados ou mensagem de n\u00e3o encontrado\n</code></pre>"},{"location":"developer-guide/testing/e2e-tests/#autenticacao","title":"Autentica\u00e7\u00e3o","text":"<pre><code># tests/e2e/test_auth.py\n@pytest.mark.e2e\nclass TestAuthentication:\n    def test_login_page_loads(self, page: Page, base_url: str):\n        page.goto(f\"{base_url}/accounts/login/\")\n\n        expect(page.locator('input[name=\"login\"]')).to_be_visible()\n        expect(page.locator('input[name=\"password\"]')).to_be_visible()\n\n    def test_invalid_login_shows_error(self, page: Page, base_url: str):\n        page.goto(f\"{base_url}/accounts/login/\")\n        page.fill('input[name=\"login\"]', \"wrong@example.com\")\n        page.fill('input[name=\"password\"]', \"wrongpass\")\n        page.click('button[type=\"submit\"]')\n\n        page.wait_for_load_state(\"networkidle\")\n        # Deve mostrar erro ou permanecer na p\u00e1gina\n        assert \"/accounts/login/\" in page.url\n\n    def test_protected_page_redirects(self, page: Page, base_url: str):\n        page.goto(f\"{base_url}/contribuir/\")\n\n        page.wait_for_load_state(\"networkidle\")\n        assert \"/accounts/login/\" in page.url\n</code></pre>"},{"location":"developer-guide/testing/e2e-tests/#upload","title":"Upload","text":"<pre><code># tests/e2e/test_upload.py\n@pytest.mark.e2e\nclass TestUpload:\n    def test_upload_requires_auth(self, page: Page, base_url: str):\n        page.goto(f\"{base_url}/contribuir/\")\n\n        assert \"/accounts/login/\" in page.url\n\n    def test_upload_page_loads(self, authenticated_page: Page, base_url: str):\n        authenticated_page.goto(f\"{base_url}/contribuir/\")\n\n        expect(authenticated_page.locator('input[name=\"yaml_file\"]')).to_be_visible()\n\n    def test_invalid_yaml_shows_error(self, authenticated_page: Page, base_url: str, tmp_path):\n        # Criar YAML inv\u00e1lido\n        yaml_file = tmp_path / \"invalid.yaml\"\n        yaml_file.write_text(\"invalid: true\\nno_name: here\")\n\n        authenticated_page.goto(f\"{base_url}/contribuir/\")\n        authenticated_page.set_input_files('input[name=\"yaml_file\"]', str(yaml_file))\n        authenticated_page.click('button[type=\"submit\"]')\n\n        page.wait_for_load_state(\"networkidle\")\n        expect(authenticated_page.locator(\".errorlist, .error\")).to_be_visible()\n</code></pre>"},{"location":"developer-guide/testing/e2e-tests/#rodando","title":"Rodando","text":""},{"location":"developer-guide/testing/e2e-tests/#pre-requisitos","title":"Pr\u00e9-requisitos","text":"<pre><code># 1. Servidor rodando\npoetry run python manage.py runserver 9000\n\n# 2. Usu\u00e1rio de teste criado\npoetry run python manage.py shell -c \"\nfrom apps.users.models import User\nif not User.objects.filter(email='teste2e@example.com').exists():\n    User.objects.create_user('teste2e', 'teste2e@example.com', 'testpass123')\n\"\n\n# 3. Dados de exemplo\npoetry run python manage.py import_yaml tests/fixtures/test_hymnbook.yaml\n</code></pre>"},{"location":"developer-guide/testing/e2e-tests/#comandos","title":"Comandos","text":"<pre><code># Rodar E2E\npoetry run pytest tests/e2e/ -v\n\n# Com browser vis\u00edvel\npoetry run pytest tests/e2e/ -v --headed\n\n# Teste espec\u00edfico\npoetry run pytest tests/e2e/test_navigation.py::TestPublicNavigation::test_home_page_loads -v\n\n# Slow motion (debug)\npoetry run pytest tests/e2e/ --slowmo=500\n</code></pre>"},{"location":"developer-guide/testing/e2e-tests/#boas-praticas","title":"Boas Pr\u00e1ticas","text":""},{"location":"developer-guide/testing/e2e-tests/#esperar-por-estado","title":"Esperar por Estado","text":"<pre><code># Bom: espera expl\u00edcito\npage.wait_for_load_state(\"networkidle\")\npage.wait_for_selector(\".card\")\n\n# Evitar: sleep fixo\nimport time\ntime.sleep(2)  # N\u00e3o fa\u00e7a isso\n</code></pre>"},{"location":"developer-guide/testing/e2e-tests/#seletores-robustos","title":"Seletores Robustos","text":"<pre><code># Bom: seletores espec\u00edficos\npage.locator('[data-testid=\"search-button\"]')\npage.get_by_role(\"button\", name=\"Buscar\")\npage.locator('button[type=\"submit\"]')\n\n# Evitar: seletores fr\u00e1geis\npage.locator(\"div &gt; div &gt; button\")\npage.locator(\".btn-primary\")  # Pode mudar\n</code></pre>"},{"location":"developer-guide/testing/e2e-tests/#screenshots-em-falha","title":"Screenshots em Falha","text":"<pre><code>@pytest.fixture\ndef page(browser):\n    context = browser.new_context()\n    page = context.new_page()\n    yield page\n\n    # Screenshot se falhou\n    if hasattr(page, '_test_failed'):\n        page.screenshot(path=f\"tests/e2e/screenshots/{test_name}.png\")\n\n    page.close()\n</code></pre>"},{"location":"developer-guide/testing/e2e-tests/#ci","title":"CI","text":"<pre><code># .github/workflows/ci.yml\ne2e-tests:\n  runs-on: ubuntu-latest\n  services:\n    postgres:\n      image: postgres:16-alpine\n    typesense:\n      image: typesense/typesense:27.1\n    redis:\n      image: redis:7-alpine\n\n  steps:\n    - name: Install Playwright\n      run: poetry run playwright install chromium --with-deps\n\n    - name: Start server\n      run: |\n        poetry run python manage.py migrate\n        poetry run python manage.py runserver 9000 &amp;\n        sleep 5\n\n    - name: Run E2E tests\n      run: poetry run pytest tests/e2e/ -v\n</code></pre>"},{"location":"developer-guide/testing/integration-tests/","title":"Testes de Integra\u00e7\u00e3o","text":"<p>Testando componentes integrados.</p>"},{"location":"developer-guide/testing/integration-tests/#o-que-sao","title":"O que S\u00e3o","text":"<p>Testes de integra\u00e7\u00e3o verificam que m\u00faltiplos componentes funcionam juntos:</p> <ul> <li>Django + Database</li> <li>Views + Templates</li> <li>Django + TypeSense</li> <li>Django + Redis/Celery</li> </ul>"},{"location":"developer-guide/testing/integration-tests/#diferenca-de-unitarios","title":"Diferen\u00e7a de Unit\u00e1rios","text":"Aspecto Unit\u00e1rio Integra\u00e7\u00e3o Escopo Uma fun\u00e7\u00e3o/classe M\u00faltiplos componentes Database Mockado/Memory Real (test DB) Velocidade Muito r\u00e1pido Mais lento Isolamento Total Parcial"},{"location":"developer-guide/testing/integration-tests/#exemplos","title":"Exemplos","text":""},{"location":"developer-guide/testing/integration-tests/#django-database","title":"Django + Database","text":"<pre><code># tests/unit/test_integration_db.py\nimport pytest\nfrom django.db import transaction\nfrom apps.hymns.models import HymnBook, Hymn\n\n\nclass TestDatabaseIntegration:\n    def test_cascade_delete(self, hymnbook_with_hymns):\n        \"\"\"Verifica que hinos s\u00e3o deletados com hin\u00e1rio.\"\"\"\n        hymnbook_id = hymnbook_with_hymns.id\n        hymn_ids = list(hymnbook_with_hymns.hymns.values_list('id', flat=True))\n\n        hymnbook_with_hymns.delete()\n\n        assert not HymnBook.objects.filter(id=hymnbook_id).exists()\n        assert not Hymn.objects.filter(id__in=hymn_ids).exists()\n\n    def test_transaction_rollback(self, hymnbook):\n        \"\"\"Verifica rollback em erro.\"\"\"\n        initial_count = Hymn.objects.count()\n\n        try:\n            with transaction.atomic():\n                Hymn.objects.create(\n                    hymn_book=hymnbook,\n                    number=1,\n                    title=\"Test\",\n                    text=\"Text\"\n                )\n                raise Exception(\"Simulated error\")\n        except Exception:\n            pass\n\n        assert Hymn.objects.count() == initial_count\n</code></pre>"},{"location":"developer-guide/testing/integration-tests/#views-templates","title":"Views + Templates","text":"<pre><code>class TestViewsIntegration:\n    def test_hymnbook_list_shows_all_books(self, client, hymnbook_factory):\n        \"\"\"Lista mostra todos os hin\u00e1rios.\"\"\"\n        books = [hymnbook_factory() for _ in range(5)]\n\n        response = client.get(reverse('hymnbook_list'))\n\n        for book in books:\n            assert book.name.encode() in response.content\n\n    def test_search_results_clickable(self, client, hymn):\n        \"\"\"Resultados de busca linkam para detalhes.\"\"\"\n        response = client.get(reverse('search'), {'q': hymn.title})\n\n        assert f'/hino/{hymn.pk}/' in response.content.decode()\n</code></pre>"},{"location":"developer-guide/testing/integration-tests/#django-typesense","title":"Django + TypeSense","text":"<pre><code># tests/unit/test_integration_search.py\nimport pytest\nfrom apps.search.indexer import index_hymn, search_hymns\n\n\n@pytest.mark.integration\nclass TestSearchIntegration:\n    @pytest.fixture(autouse=True)\n    def setup_typesense(self, typesense_client):\n        \"\"\"Setup TypeSense para testes.\"\"\"\n        # Limpar antes do teste\n        try:\n            typesense_client.collections['hymns'].delete()\n        except:\n            pass\n        typesense_client.collections.create(HYMNS_SCHEMA)\n\n    def test_index_and_search(self, hymn):\n        \"\"\"Indexa e busca um hino.\"\"\"\n        index_hymn(hymn)\n\n        results = search_hymns(hymn.title)\n\n        assert results['found'] == 1\n        assert results['hits'][0]['document']['id'] == str(hymn.id)\n\n    def test_search_by_text_content(self, hymn):\n        \"\"\"Busca por conte\u00fado da letra.\"\"\"\n        hymn.text = \"Lua branca da luz serena\"\n        hymn.save()\n        index_hymn(hymn)\n\n        results = search_hymns(\"luz serena\")\n\n        assert results['found'] == 1\n\n    def test_typo_tolerance(self, hymn):\n        \"\"\"Toler\u00e2ncia a erros de digita\u00e7\u00e3o.\"\"\"\n        hymn.title = \"Lua Branca\"\n        hymn.save()\n        index_hymn(hymn)\n\n        # Erro de digita\u00e7\u00e3o\n        results = search_hymns(\"Lua Bramca\")\n\n        assert results['found'] == 1\n</code></pre>"},{"location":"developer-guide/testing/integration-tests/#django-celery","title":"Django + Celery","text":"<pre><code># tests/unit/test_integration_celery.py\nimport pytest\nfrom unittest.mock import patch\n\n\n@pytest.mark.integration\nclass TestCeleryIntegration:\n    @patch('apps.hymns.tasks.reindex_typesense_task.delay')\n    def test_upload_triggers_reindex(self, mock_task, authenticated_client, valid_yaml):\n        \"\"\"Upload dispara task de reindexa\u00e7\u00e3o.\"\"\"\n        response = authenticated_client.post(\n            reverse('upload'),\n            {'yaml_file': valid_yaml}\n        )\n\n        mock_task.assert_called_once()\n\n    def test_task_actual_execution(self, celery_app, hymn):\n        \"\"\"Task executa corretamente (eager mode).\"\"\"\n        # Com CELERY_TASK_ALWAYS_EAGER=True\n        from apps.hymns.tasks import reindex_typesense_task\n\n        result = reindex_typesense_task()\n\n        assert 'Indexed' in result\n</code></pre>"},{"location":"developer-guide/testing/integration-tests/#fixtures-de-integracao","title":"Fixtures de Integra\u00e7\u00e3o","text":"<pre><code># tests/conftest.py\nimport pytest\nimport typesense\n\n\n@pytest.fixture(scope='session')\ndef typesense_client():\n    \"\"\"Cliente TypeSense para testes.\"\"\"\n    return typesense.Client({\n        'nodes': [{'host': 'localhost', 'port': 8108, 'protocol': 'http'}],\n        'api_key': 'xyz',\n        'connection_timeout_seconds': 2\n    })\n\n\n@pytest.fixture\ndef clean_search_index(typesense_client):\n    \"\"\"Limpa \u00edndice antes de cada teste.\"\"\"\n    try:\n        typesense_client.collections['hymns'].delete()\n    except:\n        pass\n    typesense_client.collections.create(HYMNS_SCHEMA)\n    yield\n    typesense_client.collections['hymns'].delete()\n</code></pre>"},{"location":"developer-guide/testing/integration-tests/#markers","title":"Markers","text":"<pre><code># pytest.ini\n[pytest]\nmarkers =\n    integration: mark test as integration test\n    slow: mark test as slow\n</code></pre> <pre><code># Uso\n@pytest.mark.integration\ndef test_something_integrated():\n    pass\n\n# Rodar apenas integra\u00e7\u00e3o\n# poetry run pytest -m integration\n</code></pre>"},{"location":"developer-guide/testing/integration-tests/#boas-praticas","title":"Boas Pr\u00e1ticas","text":""},{"location":"developer-guide/testing/integration-tests/#isolamento","title":"Isolamento","text":"<pre><code>@pytest.fixture(autouse=True)\ndef reset_state():\n    \"\"\"Limpa estado entre testes.\"\"\"\n    yield\n    # Cleanup\n    cache.clear()\n</code></pre>"},{"location":"developer-guide/testing/integration-tests/#timeouts","title":"Timeouts","text":"<pre><code>@pytest.mark.timeout(10)\ndef test_slow_integration():\n    pass\n</code></pre>"},{"location":"developer-guide/testing/integration-tests/#skip-condicional","title":"Skip Condicional","text":"<pre><code>import pytest\n\ntypesense_available = check_typesense_connection()\n\n@pytest.mark.skipif(not typesense_available, reason=\"TypeSense not available\")\ndef test_search():\n    pass\n</code></pre>"},{"location":"developer-guide/testing/overview/","title":"Testes - Vis\u00e3o Geral","text":"<p>Estrat\u00e9gia de testes do projeto.</p>"},{"location":"developer-guide/testing/overview/#filosofia","title":"Filosofia","text":"<ul> <li>Testes s\u00e3o documenta\u00e7\u00e3o - Mostram como o c\u00f3digo funciona</li> <li>Testes r\u00e1pidos - Feedback imediato</li> <li>Alta cobertura - Meta m\u00ednima 80%</li> <li>Testes E2E para fluxos cr\u00edticos - Validam integra\u00e7\u00e3o completa</li> </ul>"},{"location":"developer-guide/testing/overview/#tipos-de-testes","title":"Tipos de Testes","text":""},{"location":"developer-guide/testing/overview/#piramide-de-testes","title":"Pir\u00e2mide de Testes","text":"<pre><code>        \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n        \u2502   E2E     \u2502  &lt;- Poucos, lentos, cr\u00edticos\n        \u2502  (15)     \u2502\n       \u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\n       \u2502 Integration \u2502  &lt;- M\u00e9dio, testam integra\u00e7\u00f5es\n       \u2502    (50)     \u2502\n      \u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\n      \u2502    Unit       \u2502  &lt;- Muitos, r\u00e1pidos, focados\n      \u2502   (240+)      \u2502\n     \u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\n</code></pre>"},{"location":"developer-guide/testing/overview/#unitarios","title":"Unit\u00e1rios","text":"<p>Testam fun\u00e7\u00f5es/classes isoladas:</p> <pre><code>def test_hymn_book_str_returns_name():\n    hymnbook = HymnBook(name=\"Test\")\n    assert str(hymnbook) == \"Test\"\n</code></pre>"},{"location":"developer-guide/testing/overview/#integracao","title":"Integra\u00e7\u00e3o","text":"<p>Testam componentes juntos:</p> <pre><code>def test_search_returns_indexed_hymns(db, typesense):\n    hymn = HymnFactory()\n    index_hymn(hymn)\n\n    results = search_hymns(hymn.title)\n    assert results['found'] == 1\n</code></pre>"},{"location":"developer-guide/testing/overview/#e2e","title":"E2E","text":"<p>Testam fluxos completos via browser:</p> <pre><code>def test_user_can_search_and_view_hymn(page, base_url):\n    page.goto(base_url)\n    page.fill('input[name=\"q\"]', \"lua\")\n    page.click('button[type=\"submit\"]')\n    page.click(\".card a\")\n\n    expect(page.locator(\".hymn-text\")).to_be_visible()\n</code></pre>"},{"location":"developer-guide/testing/overview/#estrutura","title":"Estrutura","text":"<pre><code>tests/\n\u251c\u2500\u2500 conftest.py           # Fixtures globais\n\u251c\u2500\u2500 factories.py          # Factory Boy factories\n\u251c\u2500\u2500 fixtures/             # Arquivos de teste\n\u2502   \u2514\u2500\u2500 test_hymnbook.yaml\n\u251c\u2500\u2500 unit/                 # Testes unit\u00e1rios\n\u2502   \u251c\u2500\u2500 test_models.py\n\u2502   \u251c\u2500\u2500 test_views.py\n\u2502   \u251c\u2500\u2500 test_forms.py\n\u2502   \u2514\u2500\u2500 ...\n\u2514\u2500\u2500 e2e/                  # Testes E2E\n    \u251c\u2500\u2500 conftest.py       # Fixtures E2E\n    \u251c\u2500\u2500 test_navigation.py\n    \u251c\u2500\u2500 test_auth.py\n    \u2514\u2500\u2500 ...\n</code></pre>"},{"location":"developer-guide/testing/overview/#ferramentas","title":"Ferramentas","text":"Ferramenta Uso pytest Framework principal pytest-django Integra\u00e7\u00e3o Django pytest-cov Coverage factory-boy Test factories Playwright Testes E2E"},{"location":"developer-guide/testing/overview/#comandos","title":"Comandos","text":"<pre><code># Todos os testes\npoetry run pytest\n\n# Apenas unit\u00e1rios\npoetry run pytest tests/unit/\n\n# Apenas E2E\npoetry run pytest tests/e2e/ -v\n\n# Com coverage\npoetry run pytest --cov=apps --cov-report=html\n\n# Teste espec\u00edfico\npoetry run pytest tests/unit/test_models.py::TestHymnBook -v\n\n# Watch mode (com pytest-watch)\npoetry run ptw\n</code></pre>"},{"location":"developer-guide/testing/overview/#configuracao","title":"Configura\u00e7\u00e3o","text":"<pre><code># pytest.ini\n[pytest]\nDJANGO_SETTINGS_MODULE = config.settings.test\npython_files = test_*.py *_test.py\naddopts = -v --tb=short --strict-markers\ntestpaths = tests\nmarkers =\n    e2e: mark test as end-to-end\n</code></pre>"},{"location":"developer-guide/testing/overview/#ci","title":"CI","text":"<p>Testes rodam automaticamente:</p> <ol> <li>Push/PR \u2192 CI dispara</li> <li>Lint \u2192 Black, isort, Ruff</li> <li>Unit Tests \u2192 pytest tests/unit/</li> <li>E2E Tests \u2192 pytest tests/e2e/</li> </ol> <p>Merge bloqueado se falhar.</p>"},{"location":"developer-guide/testing/overview/#metricas-atuais","title":"M\u00e9tricas Atuais","text":"M\u00e9trica Valor Testes unit\u00e1rios 291 Testes E2E 15 Cobertura 83%+ Tempo CI ~5 min"},{"location":"developer-guide/testing/overview/#links","title":"Links","text":"<ul> <li>Testes Unit\u00e1rios</li> <li>Testes de Integra\u00e7\u00e3o</li> <li>Testes E2E</li> <li>Coverage</li> </ul>"},{"location":"developer-guide/testing/unit-tests/","title":"Testes Unit\u00e1rios","text":"<p>Guia para escrever testes unit\u00e1rios.</p>"},{"location":"developer-guide/testing/unit-tests/#convencoes","title":"Conven\u00e7\u00f5es","text":""},{"location":"developer-guide/testing/unit-tests/#nomenclatura","title":"Nomenclatura","text":"<pre><code># Arquivo: test_&lt;module&gt;.py\n# tests/unit/test_models.py\n\n# Classe: Test&lt;ClasseName&gt;\nclass TestHymnBook:\n    # M\u00e9todo: test_&lt;behavior&gt;\n    def test_str_returns_name(self):\n        pass\n</code></pre>"},{"location":"developer-guide/testing/unit-tests/#estrutura-aaa","title":"Estrutura AAA","text":"<pre><code>def test_hymn_creation(self, hymnbook):\n    # Arrange - Preparar dados\n    title = \"Lua Branca\"\n    text = \"Lua branca...\"\n\n    # Act - Executar a\u00e7\u00e3o\n    hymn = Hymn.objects.create(\n        hymn_book=hymnbook,\n        number=1,\n        title=title,\n        text=text\n    )\n\n    # Assert - Verificar resultado\n    assert hymn.title == title\n    assert hymn.hymn_book == hymnbook\n</code></pre>"},{"location":"developer-guide/testing/unit-tests/#fixtures","title":"Fixtures","text":""},{"location":"developer-guide/testing/unit-tests/#basicas","title":"B\u00e1sicas","text":"<pre><code># tests/conftest.py\nimport pytest\nfrom apps.hymns.models import HymnBook, Hymn\n\n\n@pytest.fixture\ndef hymnbook(db):\n    \"\"\"Cria um HymnBook simples.\"\"\"\n    return HymnBook.objects.create(\n        name=\"Test Hymnbook\",\n        owner_name=\"Test Owner\"\n    )\n\n\n@pytest.fixture\ndef hymn(hymnbook):\n    \"\"\"Cria um Hymn simples.\"\"\"\n    return Hymn.objects.create(\n        hymn_book=hymnbook,\n        number=1,\n        title=\"Test Hymn\",\n        text=\"Test lyrics\"\n    )\n</code></pre>"},{"location":"developer-guide/testing/unit-tests/#compostas","title":"Compostas","text":"<pre><code>@pytest.fixture\ndef hymnbook_with_hymns(hymnbook):\n    \"\"\"Cria HymnBook com m\u00faltiplos hinos.\"\"\"\n    for i in range(1, 6):\n        Hymn.objects.create(\n            hymn_book=hymnbook,\n            number=i,\n            title=f\"Hymn {i}\",\n            text=f\"Lyrics {i}\"\n        )\n    return hymnbook\n</code></pre>"},{"location":"developer-guide/testing/unit-tests/#fixtures-de-requisicao","title":"Fixtures de Requisi\u00e7\u00e3o","text":"<pre><code>@pytest.fixture\ndef authenticated_client(client, user):\n    \"\"\"Client autenticado.\"\"\"\n    client.force_login(user)\n    return client\n</code></pre>"},{"location":"developer-guide/testing/unit-tests/#factories","title":"Factories","text":"<pre><code># tests/factories.py\nimport factory\nfrom apps.hymns.models import HymnBook, Hymn\nfrom apps.users.models import User\n\n\nclass UserFactory(factory.django.DjangoModelFactory):\n    class Meta:\n        model = User\n\n    username = factory.Sequence(lambda n: f\"user{n}\")\n    email = factory.LazyAttribute(lambda obj: f\"{obj.username}@example.com\")\n    password = factory.PostGenerationMethodCall('set_password', 'password123')\n\n\nclass HymnBookFactory(factory.django.DjangoModelFactory):\n    class Meta:\n        model = HymnBook\n\n    name = factory.Sequence(lambda n: f\"Hymnbook {n}\")\n    owner_name = factory.Faker('name')\n\n\nclass HymnFactory(factory.django.DjangoModelFactory):\n    class Meta:\n        model = Hymn\n\n    hymn_book = factory.SubFactory(HymnBookFactory)\n    number = factory.Sequence(lambda n: n + 1)\n    title = factory.Faker('sentence', nb_words=3)\n    text = factory.Faker('paragraph', nb_sentences=5)\n</code></pre>"},{"location":"developer-guide/testing/unit-tests/#exemplos-por-tipo","title":"Exemplos por Tipo","text":""},{"location":"developer-guide/testing/unit-tests/#models","title":"Models","text":"<pre><code># tests/unit/test_models.py\nimport pytest\nfrom apps.hymns.models import HymnBook, Hymn\n\n\nclass TestHymnBook:\n    def test_str_returns_name(self, hymnbook):\n        assert str(hymnbook) == hymnbook.name\n\n    def test_hymn_count_property(self, hymnbook_with_hymns):\n        assert hymnbook_with_hymns.hymn_count == 5\n\n    def test_slug_auto_generated(self, db):\n        hb = HymnBook.objects.create(\n            name=\"O Cruzeiro\",\n            owner_name=\"Mestre Irineu\"\n        )\n        assert hb.slug == \"o-cruzeiro\"\n\n\nclass TestHymn:\n    def test_unique_number_per_hymnbook(self, hymn):\n        with pytest.raises(IntegrityError):\n            Hymn.objects.create(\n                hymn_book=hymn.hymn_book,\n                number=hymn.number,  # Mesmo n\u00famero!\n                title=\"Duplicate\",\n                text=\"Text\"\n            )\n</code></pre>"},{"location":"developer-guide/testing/unit-tests/#views","title":"Views","text":"<pre><code># tests/unit/test_views.py\nimport pytest\nfrom django.urls import reverse\n\n\nclass TestHomeView:\n    def test_home_returns_200(self, client):\n        response = client.get(reverse('home'))\n        assert response.status_code == 200\n\n    def test_home_shows_stats(self, client, hymnbook_with_hymns):\n        response = client.get(reverse('home'))\n        assert b'hin\u00e1rios' in response.content.lower()\n\n\nclass TestHymnDetailView:\n    def test_returns_404_for_invalid_id(self, client):\n        response = client.get(reverse('hymn_detail', args=['invalid-uuid']))\n        assert response.status_code == 404\n\n    def test_shows_hymn_text(self, client, hymn):\n        response = client.get(reverse('hymn_detail', args=[hymn.pk]))\n        assert hymn.text.encode() in response.content\n</code></pre>"},{"location":"developer-guide/testing/unit-tests/#forms","title":"Forms","text":"<pre><code># tests/unit/test_forms.py\nimport pytest\nfrom apps.users.forms import UploadForm\n\n\nclass TestUploadForm:\n    def test_valid_yaml_accepted(self, valid_yaml_file):\n        form = UploadForm(files={'yaml_file': valid_yaml_file})\n        assert form.is_valid()\n\n    def test_invalid_yaml_rejected(self, invalid_yaml_file):\n        form = UploadForm(files={'yaml_file': invalid_yaml_file})\n        assert not form.is_valid()\n        assert 'yaml_file' in form.errors\n</code></pre>"},{"location":"developer-guide/testing/unit-tests/#services","title":"Services","text":"<pre><code># tests/unit/test_disambiguation.py\nimport pytest\nfrom apps.hymns.disambiguation import calculate_string_similarity\n\n\nclass TestStringSimlarity:\n    def test_identical_strings(self):\n        assert calculate_string_similarity(\"abc\", \"abc\") == 1.0\n\n    def test_different_strings(self):\n        score = calculate_string_similarity(\"abc\", \"xyz\")\n        assert score &lt; 0.5\n\n    def test_handles_none(self):\n        assert calculate_string_similarity(None, \"abc\") == 0.0\n        assert calculate_string_similarity(\"abc\", None) == 0.0\n</code></pre>"},{"location":"developer-guide/testing/unit-tests/#mocking","title":"Mocking","text":"<pre><code>from unittest.mock import patch, MagicMock\n\n\nclass TestSearchView:\n    @patch('apps.search.client.search_hymns')\n    def test_search_calls_typesense(self, mock_search, client):\n        mock_search.return_value = {'hits': [], 'found': 0}\n\n        client.get(reverse('search'), {'q': 'lua'})\n\n        mock_search.assert_called_once_with('lua')\n\n    @patch('apps.search.client.search_hymns')\n    def test_search_handles_error(self, mock_search, client):\n        mock_search.side_effect = Exception(\"Connection error\")\n\n        response = client.get(reverse('search'), {'q': 'lua'})\n\n        assert response.status_code == 200  # Graceful degradation\n</code></pre>"},{"location":"developer-guide/testing/unit-tests/#rodando","title":"Rodando","text":"<pre><code># Todos unit\u00e1rios\npoetry run pytest tests/unit/\n\n# Arquivo espec\u00edfico\npoetry run pytest tests/unit/test_models.py\n\n# Teste espec\u00edfico\npoetry run pytest tests/unit/test_models.py::TestHymnBook::test_str_returns_name -v\n\n# Com output verbose\npoetry run pytest -v -s\n</code></pre>"},{"location":"user-guide/","title":"Guia do Usu\u00e1rio","text":"<p>Bem-vindo ao Portal de Hin\u00e1rios do Santo Daime!</p> <p>Este guia vai ajudar voc\u00ea a navegar pelo portal, buscar hinos, visualizar letras e contribuir com a comunidade.</p>"},{"location":"user-guide/#o-que-voce-pode-fazer","title":"O que voc\u00ea pode fazer","text":""},{"location":"user-guide/#sem-conta-visitante","title":"Sem conta (visitante)","text":"<ul> <li> Buscar hinos por t\u00edtulo, letra ou hin\u00e1rio</li> <li> Navegar hin\u00e1rios completos</li> <li> Visualizar letras de todos os hinos</li> </ul>"},{"location":"user-guide/#com-conta-usuario-registrado","title":"Com conta (usu\u00e1rio registrado)","text":"<ul> <li> Fazer upload de novos hin\u00e1rios</li> <li> Favoritar hinos para acesso r\u00e1pido</li> <li> Comentar em hinos</li> <li> Seguir outros contribuidores</li> <li> Receber notifica\u00e7\u00f5es de atividades</li> </ul>"},{"location":"user-guide/#navegacao-rapida","title":"Navega\u00e7\u00e3o R\u00e1pida","text":"<ul> <li> <p> Primeiros Passos</p> <p>Aprenda a navegar pela interface do portal</p> </li> <li> <p> Buscar Hinos</p> <p>T\u00e9cnicas de busca para encontrar hinos</p> </li> <li> <p> Navegar Hin\u00e1rios</p> <p>Como explorar hin\u00e1rios completos</p> </li> <li> <p> Visualizar Hinos</p> <p>Detalhes da p\u00e1gina de hinos</p> </li> </ul>"},{"location":"user-guide/#para-contribuidores","title":"Para Contribuidores","text":"<ul> <li> <p> Criar Conta</p> <p>Registro e login no portal</p> </li> <li> <p> Upload de Hin\u00e1rios</p> <p>Como enviar novos hin\u00e1rios</p> </li> <li> <p> Recursos de \u00c1udio</p> <p>Player e upload de \u00e1udios</p> </li> <li> <p> Recursos Sociais</p> <p>Favoritos, coment\u00e1rios, seguidores</p> </li> </ul>"},{"location":"user-guide/#ajuda","title":"Ajuda","text":"<ul> <li>FAQ - Perguntas frequentes</li> <li>Solu\u00e7\u00e3o de Problemas - Quando algo n\u00e3o funciona</li> </ul>"},{"location":"user-guide/#contato","title":"Contato","text":"<p>Precisa de ajuda adicional?</p> <ul> <li> Reportar problema</li> </ul>"},{"location":"user-guide/audio-features/","title":"Recursos de \u00c1udio","text":"<p>O portal suporta \u00e1udios para os hinos.</p> <p>Em Desenvolvimento</p> <p>O player de \u00e1udio completo est\u00e1 sendo desenvolvido. Esta p\u00e1gina descreve as funcionalidades planejadas.</p>"},{"location":"user-guide/audio-features/#player-de-audio","title":"Player de \u00c1udio","text":"<p>Quando um hino tem \u00e1udio dispon\u00edvel, voc\u00ea ver\u00e1 um player na p\u00e1gina.</p>"},{"location":"user-guide/audio-features/#controles","title":"Controles","text":"<ul> <li> Play/Pause - Tocar ou pausar</li> <li> Anterior - Hino anterior no hin\u00e1rio</li> <li> Pr\u00f3ximo - Pr\u00f3ximo hino</li> <li> Volume - Ajustar volume</li> <li> Repetir - Repetir hino atual</li> <li> Download - Baixar \u00e1udio (se permitido)</li> </ul>"},{"location":"user-guide/audio-features/#formatos-suportados","title":"Formatos Suportados","text":"Formato Qualidade MP3 At\u00e9 320kbps OGG Vorbis - FLAC Lossless"},{"location":"user-guide/audio-features/#contribuir-com-audio","title":"Contribuir com \u00c1udio","text":"<p>Voc\u00ea pode enviar \u00e1udios para hinos existentes.</p>"},{"location":"user-guide/audio-features/#requisitos","title":"Requisitos","text":"<ul> <li> Qualidade m\u00ednima: 128kbps</li> <li> Formato: MP3, OGG ou FLAC</li> <li> Tamanho m\u00e1ximo: 25 MB por arquivo</li> <li> Ter direitos para compartilhar</li> </ul>"},{"location":"user-guide/audio-features/#como-enviar","title":"Como Enviar","text":"<ol> <li>V\u00e1 para a p\u00e1gina do hino</li> <li>Clique em Adicionar \u00c1udio</li> <li>Arraste o arquivo ou selecione</li> <li>Adicione informa\u00e7\u00f5es:</li> <li>Fonte - Onde foi gravado</li> <li>Data - Quando foi gravado</li> <li>Cr\u00e9ditos - Quem cantou/gravou</li> <li>Clique em Enviar</li> </ol>"},{"location":"user-guide/audio-features/#moderacao","title":"Modera\u00e7\u00e3o","text":"<p>\u00c1udios passam por verifica\u00e7\u00e3o:</p> <ul> <li>Valida\u00e7\u00e3o de formato e qualidade</li> <li>Verifica\u00e7\u00e3o de correspond\u00eancia com o hino</li> <li>Aprova\u00e7\u00e3o por moderador</li> </ul>"},{"location":"user-guide/audio-features/#playlists","title":"Playlists","text":"<p>Crie playlists personalizadas:</p> <ol> <li>Navegue pelos hinos</li> <li>Clique no  ao lado do player</li> <li>Selecione playlist ou crie nova</li> <li>Acesse suas playlists no perfil</li> </ol>"},{"location":"user-guide/audio-features/#gerenciar-playlists","title":"Gerenciar Playlists","text":"<p>No seu perfil voc\u00ea pode:</p> <ul> <li>Criar novas playlists</li> <li>Editar nome e descri\u00e7\u00e3o</li> <li>Reordenar hinos</li> <li>Deletar playlists</li> </ul>"},{"location":"user-guide/audio-features/#download","title":"Download","text":"<p>Alguns \u00e1udios permitem download:</p> <ul> <li> Download individual - Um hino por vez</li> <li> Download do hin\u00e1rio - ZIP com todos os \u00e1udios</li> </ul> <p>Direitos Autorais</p> <p>Respeite os direitos autorais. Downloads s\u00e3o apenas para uso pessoal.</p>"},{"location":"user-guide/audio-features/#problemas-com-audio","title":"Problemas com \u00c1udio?","text":"<p>Se o \u00e1udio n\u00e3o tocar:</p> <ol> <li>Verifique volume do sistema e do player</li> <li>Tente outro navegador</li> <li>Verifique conex\u00e3o de internet</li> <li>Limpe cache do navegador</li> </ol> <p>Veja Solu\u00e7\u00e3o de Problemas para mais detalhes.</p>"},{"location":"user-guide/browsing-hymnbooks/","title":"Navegar por Hin\u00e1rios","text":"<p>Explore hin\u00e1rios completos navegando pela lista.</p>"},{"location":"user-guide/browsing-hymnbooks/#lista-de-hinarios","title":"Lista de Hin\u00e1rios","text":"<p>Acesse Hin\u00e1rios no menu para ver todos os hin\u00e1rios dispon\u00edveis.</p>"},{"location":"user-guide/browsing-hymnbooks/#informacoes-exibidas","title":"Informa\u00e7\u00f5es Exibidas","text":"<p>Para cada hin\u00e1rio voc\u00ea v\u00ea:</p> <ul> <li> Capa (quando dispon\u00edvel)</li> <li> Nome do hin\u00e1rio</li> <li> Dono (quem recebeu)</li> <li> Quantidade de hinos</li> <li> Descri\u00e7\u00e3o resumida</li> </ul>"},{"location":"user-guide/browsing-hymnbooks/#ordenacao","title":"Ordena\u00e7\u00e3o","text":"<p>Os hin\u00e1rios s\u00e3o ordenados alfabeticamente por nome.</p>"},{"location":"user-guide/browsing-hymnbooks/#paginacao","title":"Pagina\u00e7\u00e3o","text":"<p>A lista mostra 20 hin\u00e1rios por p\u00e1gina. Use os bot\u00f5es de navega\u00e7\u00e3o:</p> <ul> <li>Primeira - Ir para primeira p\u00e1gina</li> <li>Anterior - P\u00e1gina anterior</li> <li>Pr\u00f3xima - Pr\u00f3xima p\u00e1gina</li> <li>\u00daltima - \u00daltima p\u00e1gina</li> </ul>"},{"location":"user-guide/browsing-hymnbooks/#detalhes-do-hinario","title":"Detalhes do Hin\u00e1rio","text":"<p>Clique em Ver Hin\u00e1rio para ver todos os hinos.</p>"},{"location":"user-guide/browsing-hymnbooks/#informacoes-completas","title":"Informa\u00e7\u00f5es Completas","text":"<p>A p\u00e1gina de detalhes mostra:</p> <ul> <li> Capa grande (300x400)</li> <li> Nome completo e nome curto</li> <li> Dono do hin\u00e1rio</li> <li> Descri\u00e7\u00e3o completa</li> <li> Total de hinos</li> </ul>"},{"location":"user-guide/browsing-hymnbooks/#tabela-de-hinos","title":"Tabela de Hinos","text":"<p>Todos os hinos s\u00e3o listados em uma tabela:</p> N\u00famero T\u00edtulo Estilo 1 Lua Branca Valsa 2 Tuperci Marcha 3 Ripi Mazurca <p>Clique em qualquer linha para ver a letra completa do hino.</p>"},{"location":"user-guide/browsing-hymnbooks/#navegacao-entre-hinos","title":"Navega\u00e7\u00e3o entre Hinos","text":"<p>Quando estiver na p\u00e1gina de um hino, voc\u00ea pode:</p> <ul> <li>Clicar no nome do hin\u00e1rio para voltar \u00e0 lista de hinos</li> <li>Usar os links de navega\u00e7\u00e3o (anterior/pr\u00f3ximo)</li> </ul>"},{"location":"user-guide/browsing-hymnbooks/#hinarios-populares","title":"Hin\u00e1rios Populares","text":"<p>Na p\u00e1gina inicial, voc\u00ea ver\u00e1 os hin\u00e1rios mais acessados e os adicionados recentemente.</p> <p>Dica</p> <p>Use a busca se voc\u00ea j\u00e1 sabe qual hino procura. Use a navega\u00e7\u00e3o para explorar hin\u00e1rios completos.</p>"},{"location":"user-guide/faq/","title":"Perguntas Frequentes","text":"<p>Respostas para as d\u00favidas mais comuns.</p>"},{"location":"user-guide/faq/#geral","title":"Geral","text":""},{"location":"user-guide/faq/#o-que-e-o-portal-de-hinarios","title":"O que \u00e9 o Portal de Hin\u00e1rios?","text":"<p>\u00c9 uma plataforma para pesquisa, visualiza\u00e7\u00e3o e compartilhamento de hin\u00e1rios do Santo Daime.</p>"},{"location":"user-guide/faq/#o-portal-e-gratuito","title":"O portal \u00e9 gratuito?","text":"<p>Sim, 100% gratuito e sem an\u00fancios.</p>"},{"location":"user-guide/faq/#preciso-de-conta-para-buscar-hinos","title":"Preciso de conta para buscar hinos?","text":"<p>N\u00e3o. Busca e visualiza\u00e7\u00e3o s\u00e3o p\u00fablicas. Conta \u00e9 necess\u00e1ria apenas para contribuir, favoritar e comentar.</p>"},{"location":"user-guide/faq/#quantos-hinarios-existem-no-portal","title":"Quantos hin\u00e1rios existem no portal?","text":"<p>O portal est\u00e1 em crescimento constante. Veja as estat\u00edsticas na p\u00e1gina inicial.</p>"},{"location":"user-guide/faq/#busca","title":"Busca","text":""},{"location":"user-guide/faq/#nao-encontrei-o-hino-que-procuro","title":"N\u00e3o encontrei o hino que procuro","text":"<p>Algumas dicas:</p> <ul> <li>Verifique a ortografia</li> <li>Tente palavras mais curtas</li> <li>Use sin\u00f4nimos ou varia\u00e7\u00f5es</li> <li>Navegue manualmente pelo hin\u00e1rio</li> <li>O hino pode ainda n\u00e3o estar no portal</li> </ul>"},{"location":"user-guide/faq/#a-busca-considera-acentos","title":"A busca considera acentos?","text":"<p>Sim, mas de forma inteligente. \"jose\" encontra \"Jos\u00e9\" e vice-versa.</p>"},{"location":"user-guide/faq/#posso-buscar-por-trecho-da-letra","title":"Posso buscar por trecho da letra?","text":"<p>Sim! Digite qualquer parte da letra na busca.</p>"},{"location":"user-guide/faq/#conteudo","title":"Conte\u00fado","text":""},{"location":"user-guide/faq/#posso-baixar-os-hinarios","title":"Posso baixar os hin\u00e1rios?","text":"<p>Voc\u00ea pode visualizar e copiar as letras. Download em PDF est\u00e1 planejado para vers\u00f5es futuras.</p>"},{"location":"user-guide/faq/#posso-imprimir-os-hinos","title":"Posso imprimir os hinos?","text":"<p>Sim! Use a fun\u00e7\u00e3o de impress\u00e3o do navegador (Ctrl+P ou Cmd+P) na p\u00e1gina do hino.</p>"},{"location":"user-guide/faq/#como-sei-se-o-conteudo-e-correto","title":"Como sei se o conte\u00fado \u00e9 correto?","text":"<p>Hin\u00e1rios verificados t\u00eam o badge . Qualquer usu\u00e1rio pode sugerir corre\u00e7\u00f5es.</p>"},{"location":"user-guide/faq/#contribuicao","title":"Contribui\u00e7\u00e3o","text":""},{"location":"user-guide/faq/#como-envio-um-hinario","title":"Como envio um hin\u00e1rio?","text":"<ol> <li>Crie uma conta</li> <li>Prepare o arquivo YAML</li> <li>Acesse Contribuir</li> <li>Fa\u00e7a upload</li> </ol> <p>Veja o guia completo em Upload de Hin\u00e1rios.</p>"},{"location":"user-guide/faq/#meu-upload-foi-rejeitado-por-que","title":"Meu upload foi rejeitado, por qu\u00ea?","text":"<p>Poss\u00edveis raz\u00f5es:</p> <ul> <li>Formato YAML inv\u00e1lido</li> <li>Campos obrigat\u00f3rios faltando</li> <li>Duplicata de hin\u00e1rio existente</li> <li>Conte\u00fado incompleto</li> </ul>"},{"location":"user-guide/faq/#posso-editar-um-hinario-existente","title":"Posso editar um hin\u00e1rio existente?","text":"<p>Sim, atrav\u00e9s do sistema de versionamento. Suas edi\u00e7\u00f5es criam uma nova vers\u00e3o que passa por revis\u00e3o.</p>"},{"location":"user-guide/faq/#quem-pode-aprovar-uploads","title":"Quem pode aprovar uploads?","text":"<p>Moderadores volunt\u00e1rios da comunidade.</p>"},{"location":"user-guide/faq/#conta","title":"Conta","text":""},{"location":"user-guide/faq/#esqueci-minha-senha","title":"Esqueci minha senha","text":"<ol> <li>Na p\u00e1gina de login, clique em \"Esqueci a senha\"</li> <li>Digite seu email</li> <li>Verifique sua caixa de entrada</li> <li>Clique no link e crie nova senha</li> </ol>"},{"location":"user-guide/faq/#posso-mudar-meu-nome-de-usuario","title":"Posso mudar meu nome de usu\u00e1rio?","text":"<p>Sim, nas configura\u00e7\u00f5es do perfil.</p>"},{"location":"user-guide/faq/#posso-deletar-minha-conta","title":"Posso deletar minha conta?","text":"<p>Sim. Acesse Configura\u00e7\u00f5es \u2192 Deletar conta. Esta a\u00e7\u00e3o \u00e9 irrevers\u00edvel.</p>"},{"location":"user-guide/faq/#tecnico","title":"T\u00e9cnico","text":""},{"location":"user-guide/faq/#quais-navegadores-sao-suportados","title":"Quais navegadores s\u00e3o suportados?","text":"<ul> <li>Chrome/Edge (recomendado)</li> <li>Firefox</li> <li>Safari</li> <li>Mobile: Chrome, Safari iOS</li> </ul>"},{"location":"user-guide/faq/#o-site-funciona-em-celular","title":"O site funciona em celular?","text":"<p>Sim, \u00e9 totalmente responsivo e otimizado para mobile.</p>"},{"location":"user-guide/faq/#ha-um-app","title":"H\u00e1 um app?","text":"<p>Ainda n\u00e3o, mas o site mobile oferece experi\u00eancia similar a um app.</p>"},{"location":"user-guide/faq/#o-site-esta-lento","title":"O site est\u00e1 lento","text":"<p>Pode ser:</p> <ul> <li>Conex\u00e3o de internet lenta</li> <li>Muitas abas abertas</li> <li>Cache desatualizado (limpe com Ctrl+Shift+Del)</li> </ul>"},{"location":"user-guide/faq/#privacidade","title":"Privacidade","text":""},{"location":"user-guide/faq/#meus-dados-sao-compartilhados","title":"Meus dados s\u00e3o compartilhados?","text":"<p>N\u00e3o compartilhamos dados pessoais com terceiros.</p>"},{"location":"user-guide/faq/#o-portal-rastreia-minha-navegacao","title":"O portal rastreia minha navega\u00e7\u00e3o?","text":"<p>Usamos apenas cookies essenciais para funcionamento do site.</p>"},{"location":"user-guide/faq/#posso-deletar-meus-dados","title":"Posso deletar meus dados?","text":"<p>Sim, ao deletar sua conta todos os dados pessoais s\u00e3o removidos.</p>"},{"location":"user-guide/faq/#outras-duvidas","title":"Outras D\u00favidas","text":"<p>N\u00e3o encontrou sua resposta?</p> <ul> <li>Veja Solu\u00e7\u00e3o de Problemas</li> <li>Abra um issue no GitHub</li> </ul>"},{"location":"user-guide/getting-started/","title":"Primeiros Passos","text":"<p>Este guia vai ajudar voc\u00ea a entender a interface do Portal de Hin\u00e1rios.</p>"},{"location":"user-guide/getting-started/#interface-principal","title":"Interface Principal","text":""},{"location":"user-guide/getting-started/#pagina-inicial","title":"P\u00e1gina Inicial","text":"<p>Ao acessar o portal, voc\u00ea ver\u00e1:</p> <ol> <li>Barra de navega\u00e7\u00e3o - Menu com links para as principais se\u00e7\u00f5es</li> <li>Barra de busca - Encontre hinos rapidamente</li> <li>Estat\u00edsticas - Total de hin\u00e1rios e hinos no portal</li> <li>Hin\u00e1rios em destaque - \u00daltimos hin\u00e1rios adicionados</li> </ol>"},{"location":"user-guide/getting-started/#menu-de-navegacao","title":"Menu de Navega\u00e7\u00e3o","text":"<p>O menu principal cont\u00e9m:</p> Link Descri\u00e7\u00e3o Home P\u00e1gina inicial com estat\u00edsticas Hin\u00e1rios Lista completa de hin\u00e1rios Buscar P\u00e1gina de busca avan\u00e7ada Entrar Login ou criar conta"},{"location":"user-guide/getting-started/#funcionalidades-basicas","title":"Funcionalidades B\u00e1sicas","text":""},{"location":"user-guide/getting-started/#buscar-hinos","title":"Buscar Hinos","text":"<p>A barra de busca est\u00e1 dispon\u00edvel em todas as p\u00e1ginas. Para buscar:</p> <ol> <li>Digite o termo de busca (t\u00edtulo, trecho da letra, nome do hin\u00e1rio)</li> <li>Pressione ++enter++ ou clique no \u00edcone de lupa</li> <li>Veja os resultados ordenados por relev\u00e2ncia</li> </ol> <p>Dica</p> <p>A busca \u00e9 inteligente e encontra resultados mesmo com pequenos erros de digita\u00e7\u00e3o.</p>"},{"location":"user-guide/getting-started/#navegar-por-hinarios","title":"Navegar por Hin\u00e1rios","text":"<p>Para explorar um hin\u00e1rio completo:</p> <ol> <li>Clique em Hin\u00e1rios no menu</li> <li>Encontre o hin\u00e1rio desejado na lista</li> <li>Clique em Ver Hin\u00e1rio para ver todos os hinos</li> <li>Clique em qualquer hino para ver a letra completa</li> </ol>"},{"location":"user-guide/getting-started/#visualizar-letras","title":"Visualizar Letras","text":"<p>A p\u00e1gina do hino mostra:</p> <ul> <li>T\u00edtulo e n\u00famero do hino</li> <li>Nome do hin\u00e1rio (link para voltar)</li> <li>Letra completa formatada</li> <li>Metadados (estilo, data, etc.)</li> <li>Bot\u00f5es sociais (se logado)</li> </ul>"},{"location":"user-guide/getting-started/#proximos-passos","title":"Pr\u00f3ximos Passos","text":"<p>Agora que voc\u00ea conhece a interface, aprenda:</p> <ul> <li>Como buscar eficientemente</li> <li>Navegar por hin\u00e1rios</li> <li>Visualizar letras</li> </ul>"},{"location":"user-guide/getting-started/#criar-conta","title":"Criar Conta","text":"<p>Para contribuir com o portal (upload, favoritos, coment\u00e1rios), voc\u00ea precisa criar uma conta:</p> <ol> <li>Clique em Entrar no menu</li> <li>Clique em Criar conta</li> <li>Preencha seus dados ou use login social</li> </ol> <p>Veja mais em Contas de Usu\u00e1rio.</p>"},{"location":"user-guide/searching-hymns/","title":"Como Buscar Hinos","text":"<p>O Portal de Hin\u00e1rios usa o TypeSense, um motor de busca moderno e r\u00e1pido.</p>"},{"location":"user-guide/searching-hymns/#busca-simples","title":"Busca Simples","text":"<p>Para buscar hinos:</p> <ol> <li>Digite o termo na barra de busca</li> <li>Pressione ++enter++ ou clique no \u00edcone de lupa</li> <li>Veja os resultados ordenados por relev\u00e2ncia</li> </ol>"},{"location":"user-guide/searching-hymns/#o-que-voce-pode-buscar","title":"O que Voc\u00ea Pode Buscar","text":"<p>A busca encontra correspond\u00eancias em:</p> Campo Exemplo T\u00edtulo do hino \"Lua Branca\" Letra do hino \"da luz serena\" Nome do hin\u00e1rio \"Cruzeiro\" Nome do dono \"Mestre Irineu\""},{"location":"user-guide/searching-hymns/#dicas-de-busca","title":"Dicas de Busca","text":""},{"location":"user-guide/searching-hymns/#busca-com-erro-de-digitacao","title":"Busca com Erro de Digita\u00e7\u00e3o","text":"<p>O sistema tolera pequenos erros:</p> <pre><code>\"Irineu\" \u2192 encontra \"Mestre Irineu\"\n\"lua bramca\" \u2192 encontra \"Lua Branca\"\n</code></pre>"},{"location":"user-guide/searching-hymns/#busca-parcial","title":"Busca Parcial","text":"<p>Digite pelo menos 3 caracteres:</p> <pre><code>\"luz\" \u2192 encontra \"Lua Branca da luz serena\"\n</code></pre>"},{"location":"user-guide/searching-hymns/#acentos","title":"Acentos","text":"<p>A busca ignora diferen\u00e7as de acentua\u00e7\u00e3o:</p> <pre><code>\"jose\" \u2192 encontra \"Jos\u00e9\"\n\"irmandade\" \u2192 encontra \"Irmandade\"\n</code></pre>"},{"location":"user-guide/searching-hymns/#multiplas-palavras","title":"M\u00faltiplas Palavras","text":"<p>Buscar por v\u00e1rias palavras retorna resultados que contenham todas:</p> <pre><code>\"lua branca irineu\" \u2192 hinos com \"lua\", \"branca\" E \"irineu\"\n</code></pre>"},{"location":"user-guide/searching-hymns/#resultados-da-busca","title":"Resultados da Busca","text":"<p>Cada resultado mostra:</p> <ul> <li>N\u00famero e T\u00edtulo do hino</li> <li>Hin\u00e1rio (nome e dono)</li> <li>Preview da letra (primeiras 40 palavras)</li> <li>Estilo musical (se dispon\u00edvel)</li> </ul> <p>Os resultados s\u00e3o ordenados por relev\u00e2ncia - os mais relevantes aparecem primeiro.</p>"},{"location":"user-guide/searching-hymns/#quando-nao-encontrar","title":"Quando N\u00e3o Encontrar","text":"<p>Se a busca retornar vazio:</p> <ol> <li> Verifique a ortografia</li> <li> Use palavras mais curtas</li> <li> Tente sin\u00f4nimos ou varia\u00e7\u00f5es</li> <li> Navegue manualmente pelos Hin\u00e1rios</li> </ol> <p>O hino n\u00e3o existe?</p> <p>Se voc\u00ea tem o hino em formato digital, considere contribuir com o portal!</p>"},{"location":"user-guide/searching-hymns/#busca-avancada","title":"Busca Avan\u00e7ada","text":"<p>Na p\u00e1gina de busca (<code>/busca/</code>), voc\u00ea pode:</p> <ul> <li>Filtrar por hin\u00e1rio</li> <li>Filtrar por estilo musical</li> <li>Ordenar resultados</li> </ul> <p>Em desenvolvimento</p> <p>Filtros avan\u00e7ados ser\u00e3o adicionados em vers\u00f5es futuras.</p>"},{"location":"user-guide/social-features/","title":"Recursos Sociais","text":"<p>Interaja com a comunidade do Portal de Hin\u00e1rios.</p>"},{"location":"user-guide/social-features/#favoritar-hinos","title":"Favoritar Hinos","text":"<p>Salve seus hinos favoritos para acesso r\u00e1pido.</p>"},{"location":"user-guide/social-features/#como-favoritar","title":"Como Favoritar","text":"<ol> <li>V\u00e1 para a p\u00e1gina do hino</li> <li>Clique no  Favoritar</li> <li>O \u00edcone muda para  indicando que foi favoritado</li> </ol>"},{"location":"user-guide/social-features/#ver-favoritos","title":"Ver Favoritos","text":"<ol> <li>Acesse seu Perfil</li> <li>Clique em Favoritos</li> <li>Veja todos os hinos favoritados</li> </ol>"},{"location":"user-guide/social-features/#desfavoritar","title":"Desfavoritar","text":"<ol> <li>Na p\u00e1gina do hino OU na lista de favoritos</li> <li>Clique no  novamente</li> <li>O hino \u00e9 removido dos favoritos</li> </ol>"},{"location":"user-guide/social-features/#comentarios","title":"Coment\u00e1rios","text":"<p>Deixe coment\u00e1rios nos hinos.</p>"},{"location":"user-guide/social-features/#adicionar-comentario","title":"Adicionar Coment\u00e1rio","text":"<ol> <li>Na p\u00e1gina do hino, role at\u00e9 Coment\u00e1rios</li> <li>Digite seu coment\u00e1rio na caixa de texto</li> <li>Clique em Enviar</li> </ol>"},{"location":"user-guide/social-features/#editar-comentario","title":"Editar Coment\u00e1rio","text":"<p>Voc\u00ea pode editar coment\u00e1rios nas primeiras 15 minutos:</p> <ol> <li>Clique em  no seu coment\u00e1rio</li> <li>Fa\u00e7a as altera\u00e7\u00f5es</li> <li>Clique em Salvar</li> </ol>"},{"location":"user-guide/social-features/#deletar-comentario","title":"Deletar Coment\u00e1rio","text":"<ol> <li>Clique em  no seu coment\u00e1rio</li> <li>Confirme a exclus\u00e3o</li> </ol>"},{"location":"user-guide/social-features/#regras-de-comentarios","title":"Regras de Coment\u00e1rios","text":"<p> Fazer</p> <ul> <li>Ser respeitoso</li> <li>Contribuir construtivamente</li> <li>Compartilhar conhecimento</li> </ul> <p> Evitar</p> <ul> <li>Spam</li> <li>Conte\u00fado ofensivo</li> <li>Informa\u00e7\u00f5es falsas</li> </ul>"},{"location":"user-guide/social-features/#reportar-abuso","title":"Reportar Abuso","text":"<p>Se encontrar um coment\u00e1rio inadequado:</p> <ol> <li>Clique em  ao lado do coment\u00e1rio</li> <li>Selecione o motivo</li> <li>O moderador ser\u00e1 notificado</li> </ol>"},{"location":"user-guide/social-features/#seguir-usuarios","title":"Seguir Usu\u00e1rios","text":"<p>Acompanhe outros contribuidores.</p>"},{"location":"user-guide/social-features/#seguir","title":"Seguir","text":"<ol> <li>V\u00e1 para o perfil do usu\u00e1rio</li> <li>Clique em Seguir</li> <li>Voc\u00ea receber\u00e1 notifica\u00e7\u00f5es de novos uploads</li> </ol>"},{"location":"user-guide/social-features/#deixar-de-seguir","title":"Deixar de Seguir","text":"<ol> <li>No perfil do usu\u00e1rio OU em \"Seguindo\"</li> <li>Clique em Deixar de seguir</li> </ol>"},{"location":"user-guide/social-features/#ver-quem-voce-segue","title":"Ver Quem Voc\u00ea Segue","text":"<ol> <li>Acesse seu Perfil</li> <li>Clique em Seguindo</li> <li>Veja a lista de usu\u00e1rios</li> </ol>"},{"location":"user-guide/social-features/#ver-seguidores","title":"Ver Seguidores","text":"<ol> <li>Acesse seu Perfil</li> <li>Clique em Seguidores</li> <li>Veja quem segue voc\u00ea</li> </ol>"},{"location":"user-guide/social-features/#notificacoes","title":"Notifica\u00e7\u00f5es","text":"<p>Fique por dentro das atividades.</p>"},{"location":"user-guide/social-features/#tipos-de-notificacoes","title":"Tipos de Notifica\u00e7\u00f5es","text":"Tipo Descri\u00e7\u00e3o Resposta ao seu coment\u00e1rio Algu\u00e9m curtiu seu upload Novo seguidor Usu\u00e1rio que voc\u00ea segue fez upload Seu upload foi aprovado"},{"location":"user-guide/social-features/#ver-notificacoes","title":"Ver Notifica\u00e7\u00f5es","text":"<ol> <li>Clique no  no menu</li> <li>Veja todas as notifica\u00e7\u00f5es</li> <li>Clique em uma para ir ao conte\u00fado</li> </ol>"},{"location":"user-guide/social-features/#gerenciar-notificacoes","title":"Gerenciar Notifica\u00e7\u00f5es","text":"<p>Voc\u00ea pode escolher quais notifica\u00e7\u00f5es receber:</p> <ol> <li>Acesse Configura\u00e7\u00f5es</li> <li>Clique em Notifica\u00e7\u00f5es</li> <li>Ative/desative cada tipo</li> </ol>"},{"location":"user-guide/social-features/#marcar-como-lida","title":"Marcar como Lida","text":"<ul> <li>Clique em uma notifica\u00e7\u00e3o para marc\u00e1-la como lida</li> <li>Ou clique em Marcar todas como lidas</li> </ul>"},{"location":"user-guide/social-features/#privacidade","title":"Privacidade","text":"<p>Suas intera\u00e7\u00f5es sociais respeitam sua privacidade:</p> <ul> <li>Favoritos s\u00e3o p\u00fablicos por padr\u00e3o (pode mudar nas configura\u00e7\u00f5es)</li> <li>Coment\u00e1rios s\u00e3o sempre p\u00fablicos</li> <li>Voc\u00ea controla quem pode ver seu perfil</li> </ul>"},{"location":"user-guide/troubleshooting/","title":"Solu\u00e7\u00e3o de Problemas","text":"<p>Encontrou um problema? Veja as solu\u00e7\u00f5es abaixo.</p>"},{"location":"user-guide/troubleshooting/#problemas-comuns","title":"Problemas Comuns","text":""},{"location":"user-guide/troubleshooting/#busca-nao-retorna-resultados","title":"Busca n\u00e3o retorna resultados","text":"<p>Sintoma: Busca vazia ou \"Nenhum resultado encontrado\"</p> <p>Solu\u00e7\u00f5es:</p> <ol> <li> Verifique a ortografia</li> <li> Use 3+ caracteres</li> <li> Tente palavras diferentes</li> <li> Limpe o cache do navegador</li> <li> Recarregue a p\u00e1gina</li> </ol> <p>Problema tempor\u00e1rio?</p> <p>Se o problema persistir, pode ser uma quest\u00e3o tempor\u00e1ria de indexa\u00e7\u00e3o. Aguarde alguns minutos.</p>"},{"location":"user-guide/troubleshooting/#pagina-nao-carrega","title":"P\u00e1gina n\u00e3o carrega","text":"<p>Sintoma: Tela branca ou erro 500</p> <p>Solu\u00e7\u00f5es:</p> <ol> <li> Recarregue a p\u00e1gina (++ctrl+r++ ou ++cmd+r++)</li> <li> Limpe o cache: ++ctrl+shift+del++</li> <li> Tente outro navegador</li> <li> Desative extens\u00f5es (modo an\u00f4nimo)</li> <li> Verifique sua conex\u00e3o de internet</li> </ol>"},{"location":"user-guide/troubleshooting/#imagens-nao-aparecem","title":"Imagens n\u00e3o aparecem","text":"<p>Sintoma: Capas de hin\u00e1rios n\u00e3o carregam</p> <p>Solu\u00e7\u00f5es:</p> <ol> <li> Aguarde carregamento completo</li> <li> Recarregue a p\u00e1gina</li> <li> Verifique se extens\u00f5es bloqueiam imagens (AdBlock)</li> <li> Limpe o cache</li> </ol>"},{"location":"user-guide/troubleshooting/#login-nao-funciona","title":"Login n\u00e3o funciona","text":"<p>Sintoma: \"Email ou senha incorretos\"</p> <p>Solu\u00e7\u00f5es:</p> <ol> <li> Verifique o Caps Lock</li> <li> Tente recuperar senha</li> <li> Use login social (Google)</li> <li> Limpe cookies do site</li> </ol>"},{"location":"user-guide/troubleshooting/#upload-falha","title":"Upload falha","text":"<p>Sintoma: Erro ao fazer upload de YAML</p> <p>Solu\u00e7\u00f5es:</p> <ol> <li> Verifique tamanho do arquivo (m\u00e1ximo 10MB)</li> <li> Valide a estrutura do YAML em yamllint.com</li> <li> Verifique campos obrigat\u00f3rios</li> <li> Tente navegador diferente</li> </ol> <p>Erros comuns no YAML:</p> <pre><code># ERRADO - falta campo name\nowner_name: \"Jo\u00e3o\"\nhymns: []\n\n# CORRETO\nname: \"Hin\u00e1rio do Jo\u00e3o\"\nowner_name: \"Jo\u00e3o\"\nhymns: []\n</code></pre>"},{"location":"user-guide/troubleshooting/#audio-nao-toca","title":"\u00c1udio n\u00e3o toca","text":"<p>Sintoma: Player n\u00e3o reproduz</p> <p>Solu\u00e7\u00f5es:</p> <ol> <li> Verifique volume do sistema e do player</li> <li> Tente outro navegador</li> <li> Verifique se h\u00e1 bloqueador de \u00e1udio</li> <li> Recarregue a p\u00e1gina</li> <li> Limpe o cache</li> </ol>"},{"location":"user-guide/troubleshooting/#favoritos-nao-salvam","title":"Favoritos n\u00e3o salvam","text":"<p>Sintoma: Clico em favoritar mas n\u00e3o funciona</p> <p>Solu\u00e7\u00f5es:</p> <ol> <li> Verifique se est\u00e1 logado</li> <li> Recarregue a p\u00e1gina e tente novamente</li> <li> Verifique console do navegador (F12)</li> </ol>"},{"location":"user-guide/troubleshooting/#notificacoes-nao-aparecem","title":"Notifica\u00e7\u00f5es n\u00e3o aparecem","text":"<p>Sintoma: N\u00e3o recebo notifica\u00e7\u00f5es</p> <p>Solu\u00e7\u00f5es:</p> <ol> <li> Verifique configura\u00e7\u00f5es de notifica\u00e7\u00e3o no perfil</li> <li> Verifique se o navegador permite notifica\u00e7\u00f5es</li> <li> Limpe o cache</li> </ol>"},{"location":"user-guide/troubleshooting/#reportar-problema","title":"Reportar Problema","text":"<p>Se nenhuma solu\u00e7\u00e3o funcionou:</p>"},{"location":"user-guide/troubleshooting/#1-verifique-issues-existentes","title":"1. Verifique Issues Existentes","text":"<p>Acesse GitHub Issues e busque pelo problema.</p>"},{"location":"user-guide/troubleshooting/#2-crie-novo-issue","title":"2. Crie Novo Issue","text":"<p>Se n\u00e3o encontrou, crie um novo issue com:</p> <p>Informa\u00e7\u00f5es necess\u00e1rias:</p> <ul> <li>[ ] Descri\u00e7\u00e3o clara do problema</li> <li>[ ] Passos para reproduzir</li> <li>[ ] Comportamento esperado vs. atual</li> <li>[ ] Screenshots (se aplic\u00e1vel)</li> <li>[ ] Navegador e vers\u00e3o</li> <li>[ ] Sistema operacional</li> </ul> <p>Template:</p> <pre><code>## Descri\u00e7\u00e3o\n[Descreva o problema]\n\n## Passos para Reproduzir\n1. V\u00e1 para '...'\n2. Clique em '...'\n3. Veja o erro\n\n## Comportamento Esperado\n[O que deveria acontecer]\n\n## Comportamento Atual\n[O que est\u00e1 acontecendo]\n\n## Screenshots\n[Anexe imagens se relevante]\n\n## Ambiente\n- Navegador: Chrome 120\n- Sistema: macOS 14.0\n</code></pre>"},{"location":"user-guide/troubleshooting/#contato-direto","title":"Contato Direto","text":"<p>Para problemas urgentes:</p> <ul> <li> GitHub Issues (preferencial)</li> </ul>"},{"location":"user-guide/troubleshooting/#dicas-gerais","title":"Dicas Gerais","text":""},{"location":"user-guide/troubleshooting/#limpar-cache","title":"Limpar Cache","text":"ChromeFirefoxSafari <p>++ctrl+shift+del++ \u2192 Selecione \"Imagens e arquivos em cache\" \u2192 Limpar</p> <p>++ctrl+shift+del++ \u2192 Selecione \"Cache\" \u2192 Limpar</p> <p>Develop \u2192 Empty Caches</p>"},{"location":"user-guide/troubleshooting/#modo-anonimo","title":"Modo An\u00f4nimo","text":"<p>Testar em modo an\u00f4nimo ajuda a identificar se o problema \u00e9 causado por extens\u00f5es:</p> ChromeFirefoxSafari <p>++ctrl+shift+n++</p> <p>++ctrl+shift+p++</p> <p>++cmd+shift+n++</p>"},{"location":"user-guide/uploading-hymnbooks/","title":"Upload de Hin\u00e1rios","text":"<p>Contribua com o portal enviando novos hin\u00e1rios.</p>"},{"location":"user-guide/uploading-hymnbooks/#pre-requisitos","title":"Pr\u00e9-requisitos","text":"<p>Para fazer upload, voc\u00ea precisa:</p> <ul> <li> Ter uma conta criada</li> <li> Estar logado</li> <li> Ter o hin\u00e1rio em formato YAML</li> </ul>"},{"location":"user-guide/uploading-hymnbooks/#formato-yaml","title":"Formato YAML","text":"<p>O portal aceita hin\u00e1rios em formato YAML. Veja a estrutura:</p> <pre><code>name: \"Nome do Hin\u00e1rio\"\nowner_name: \"Nome do Dono\"\nintro_name: \"Nome Curto\"  # opcional\ndescription: \"Descri\u00e7\u00e3o completa do hin\u00e1rio\"\n\nhymns:\n  - number: 1\n    title: \"T\u00edtulo do Primeiro Hino\"\n    text: |\n      Primeira estrofe do hino\n      Com quebras de linha\n\n      Segunda estrofe\n      Tamb\u00e9m com quebras\n    style: \"Valsa\"  # opcional\n    received_at: \"1930-07-15\"  # opcional\n    offered_to: \"Nome\"  # opcional\n\n  - number: 2\n    title: \"Segundo Hino\"\n    text: |\n      Letra do segundo hino...\n</code></pre>"},{"location":"user-guide/uploading-hymnbooks/#campos-obrigatorios","title":"Campos Obrigat\u00f3rios","text":"Campo Descri\u00e7\u00e3o <code>name</code> Nome completo do hin\u00e1rio <code>owner_name</code> Pessoa que recebeu o hin\u00e1rio <code>hymns</code> Lista de hinos <code>hymns[].number</code> N\u00famero sequencial <code>hymns[].title</code> T\u00edtulo do hino <code>hymns[].text</code> Letra completa"},{"location":"user-guide/uploading-hymnbooks/#campos-opcionais","title":"Campos Opcionais","text":"Campo Descri\u00e7\u00e3o <code>intro_name</code> Nome curto para exibi\u00e7\u00e3o <code>description</code> Descri\u00e7\u00e3o do hin\u00e1rio <code>hymns[].style</code> Valsa, Marcha, Mazurca, etc. <code>hymns[].received_at</code> Data no formato YYYY-MM-DD <code>hymns[].offered_to</code> Pessoa dedicat\u00e1ria <code>hymns[].repetitions</code> Ex: \"1-4, 5-8\" <code>hymns[].extra_instructions</code> Instru\u00e7\u00f5es de canto"},{"location":"user-guide/uploading-hymnbooks/#fazendo-upload","title":"Fazendo Upload","text":""},{"location":"user-guide/uploading-hymnbooks/#passo-1-acessar-a-pagina","title":"Passo 1: Acessar a P\u00e1gina","text":"<ol> <li>Fa\u00e7a login</li> <li>Clique em Contribuir no menu</li> </ol>"},{"location":"user-guide/uploading-hymnbooks/#passo-2-selecionar-arquivo","title":"Passo 2: Selecionar Arquivo","text":"<ol> <li>Clique em Escolher arquivo ou arraste o YAML</li> <li>O sistema valida o formato automaticamente</li> </ol>"},{"location":"user-guide/uploading-hymnbooks/#passo-3-preview","title":"Passo 3: Preview","text":"<p>Ap\u00f3s o upload, voc\u00ea ver\u00e1 um preview com:</p> <ul> <li>Nome do hin\u00e1rio</li> <li>Quantidade de hinos</li> <li>Lista de hinos detectados</li> </ul> <p>Revisar</p> <p>Verifique se todos os hinos foram detectados corretamente antes de confirmar.</p>"},{"location":"user-guide/uploading-hymnbooks/#passo-4-verificacao-de-duplicatas","title":"Passo 4: Verifica\u00e7\u00e3o de Duplicatas","text":"<p>O sistema detecta automaticamente se o hin\u00e1rio j\u00e1 existe:</p> <ul> <li>Se for novo, vai direto para confirma\u00e7\u00e3o</li> <li>Se for similar a um existente, mostra op\u00e7\u00f5es</li> </ul>"},{"location":"user-guide/uploading-hymnbooks/#passo-5-confirmar","title":"Passo 5: Confirmar","text":"<ol> <li>Revise as informa\u00e7\u00f5es</li> <li>Clique em Confirmar Upload</li> <li>O hin\u00e1rio \u00e9 salvo e indexado</li> </ol>"},{"location":"user-guide/uploading-hymnbooks/#desambiguacao","title":"Desambigua\u00e7\u00e3o","text":"<p>Se o sistema detectar um hin\u00e1rio similar:</p>"},{"location":"user-guide/uploading-hymnbooks/#opcoes-disponiveis","title":"Op\u00e7\u00f5es Dispon\u00edveis","text":"<ol> <li>Criar novo - Trata como hin\u00e1rio diferente</li> <li>Atualizar existente - Substitui o hin\u00e1rio atual</li> <li>Criar nova vers\u00e3o - Mant\u00e9m ambos como vers\u00f5es</li> </ol>"},{"location":"user-guide/uploading-hymnbooks/#criterios-de-similaridade","title":"Crit\u00e9rios de Similaridade","text":"<p>O sistema compara:</p> <ul> <li>Nome do hin\u00e1rio</li> <li>Nome do dono</li> <li>Quantidade de hinos</li> </ul> <p>Threshold</p> <p>Similaridade &gt; 80% dispara a verifica\u00e7\u00e3o de duplicata.</p>"},{"location":"user-guide/uploading-hymnbooks/#versionamento","title":"Versionamento","text":"<p>Hin\u00e1rios podem ter m\u00faltiplas vers\u00f5es:</p> <ul> <li>Vers\u00e3o atual - A mais recente</li> <li>Vers\u00f5es anteriores - Hist\u00f3rico completo</li> <li>Compara\u00e7\u00e3o - Ver diferen\u00e7as entre vers\u00f5es</li> </ul>"},{"location":"user-guide/uploading-hymnbooks/#diretrizes-de-qualidade","title":"Diretrizes de Qualidade","text":""},{"location":"user-guide/uploading-hymnbooks/#fazer","title":"Fazer","text":"<ul> <li>Use ortografia correta</li> <li>Preserve formata\u00e7\u00e3o original</li> <li>Inclua metadados quando dispon\u00edveis</li> <li>Verifique n\u00fameros duplicados</li> </ul>"},{"location":"user-guide/uploading-hymnbooks/#evitar","title":"Evitar","text":"<ul> <li>Copiar de fontes protegidas sem permiss\u00e3o</li> <li>Informa\u00e7\u00f5es falsas ou incorretas</li> <li>Conte\u00fado incompleto</li> </ul>"},{"location":"user-guide/uploading-hymnbooks/#apos-o-upload","title":"Ap\u00f3s o Upload","text":"<p>Seu hin\u00e1rio:</p> <ol> <li>\u00c9 salvo no banco de dados</li> <li>\u00c9 indexado para busca</li> <li>Aparece na lista de hin\u00e1rios</li> <li>Voc\u00ea \u00e9 creditado como contribuidor</li> </ol>"},{"location":"user-guide/uploading-hymnbooks/#problemas-no-upload","title":"Problemas no Upload?","text":"<p>Se o upload falhar:</p> <ul> <li>Verifique o formato do YAML</li> <li>Use um validador de YAML online</li> <li>Veja Solu\u00e7\u00e3o de Problemas</li> </ul>"},{"location":"user-guide/user-accounts/","title":"Contas de Usu\u00e1rio","text":"<p>Para contribuir com o portal, voc\u00ea precisa criar uma conta.</p>"},{"location":"user-guide/user-accounts/#por-que-criar-conta","title":"Por que Criar Conta?","text":"<p>Com uma conta voc\u00ea pode:</p> <ul> <li> Fazer upload de hin\u00e1rios</li> <li> Favoritar hinos</li> <li> Comentar em hinos</li> <li> Seguir outros usu\u00e1rios</li> <li> Receber notifica\u00e7\u00f5es</li> </ul>"},{"location":"user-guide/user-accounts/#criando-uma-conta","title":"Criando uma Conta","text":""},{"location":"user-guide/user-accounts/#via-email","title":"Via Email","text":"<ol> <li>Clique em Entrar no menu</li> <li>Clique em Criar conta</li> <li>Preencha seus dados:</li> <li>Nome de usu\u00e1rio</li> <li>Email</li> <li>Senha (m\u00ednimo 8 caracteres)</li> <li>Clique em Cadastrar</li> <li>Verifique seu email e clique no link de confirma\u00e7\u00e3o</li> </ol>"},{"location":"user-guide/user-accounts/#via-login-social","title":"Via Login Social","text":"<p>Para criar conta rapidamente:</p> <ol> <li>Clique em Entrar no menu</li> <li>Clique em Continuar com Google</li> <li>Autorize o acesso</li> <li>Sua conta ser\u00e1 criada automaticamente</li> </ol> <p>Dados do Login Social</p> <p>Ao usar login social, importamos apenas seu nome e email. Voc\u00ea pode alterar depois.</p>"},{"location":"user-guide/user-accounts/#fazendo-login","title":"Fazendo Login","text":"<ol> <li>Clique em Entrar no menu</li> <li>Digite seu email e senha OU use login social</li> <li>Clique em Entrar</li> </ol>"},{"location":"user-guide/user-accounts/#recuperar-senha","title":"Recuperar Senha","text":"<p>Esqueceu a senha?</p> <ol> <li>Na p\u00e1gina de login, clique em Esqueci a senha</li> <li>Digite seu email</li> <li>Verifique sua caixa de entrada</li> <li>Clique no link recebido</li> <li>Crie uma nova senha</li> </ol>"},{"location":"user-guide/user-accounts/#seu-perfil","title":"Seu Perfil","text":"<p>Ap\u00f3s criar conta, voc\u00ea pode editar seu perfil:</p>"},{"location":"user-guide/user-accounts/#informacoes-editaveis","title":"Informa\u00e7\u00f5es Edit\u00e1veis","text":"<ul> <li> Nome de exibi\u00e7\u00e3o</li> <li> Avatar (foto de perfil)</li> <li> Biografia</li> </ul>"},{"location":"user-guide/user-accounts/#como-editar","title":"Como Editar","text":"<ol> <li>Clique no seu nome no menu</li> <li>Clique em Editar Perfil</li> <li>Fa\u00e7a as altera\u00e7\u00f5es</li> <li>Clique em Salvar</li> </ol>"},{"location":"user-guide/user-accounts/#perfil-publico","title":"Perfil P\u00fablico","text":"<p>Outros usu\u00e1rios podem ver:</p> <ul> <li>Seu nome de exibi\u00e7\u00e3o</li> <li>Seu avatar</li> <li>Sua biografia</li> <li>Hin\u00e1rios que voc\u00ea contribuiu</li> <li>Quantos seguidores voc\u00ea tem</li> </ul>"},{"location":"user-guide/user-accounts/#configuracoes-da-conta","title":"Configura\u00e7\u00f5es da Conta","text":""},{"location":"user-guide/user-accounts/#alterar-email","title":"Alterar Email","text":"<ol> <li>Acesse Configura\u00e7\u00f5es</li> <li>Clique em Alterar email</li> <li>Digite o novo email</li> <li>Confirme via link</li> </ol>"},{"location":"user-guide/user-accounts/#alterar-senha","title":"Alterar Senha","text":"<ol> <li>Acesse Configura\u00e7\u00f5es</li> <li>Clique em Alterar senha</li> <li>Digite a senha atual</li> <li>Digite a nova senha</li> <li>Confirme</li> </ol>"},{"location":"user-guide/user-accounts/#deletar-conta","title":"Deletar Conta","text":"<p>Aten\u00e7\u00e3o</p> <p>Esta a\u00e7\u00e3o \u00e9 irrevers\u00edvel!</p> <ol> <li>Acesse Configura\u00e7\u00f5es</li> <li>Clique em Deletar conta</li> <li>Confirme digitando sua senha</li> <li>Sua conta e dados ser\u00e3o removidos</li> </ol>"},{"location":"user-guide/user-accounts/#privacidade","title":"Privacidade","text":"<ul> <li>Seu email n\u00e3o \u00e9 exibido publicamente</li> <li>Voc\u00ea controla quais informa\u00e7\u00f5es compartilhar</li> <li>Veja nossa Pol\u00edtica de Privacidade</li> </ul>"},{"location":"user-guide/viewing-hymns/","title":"Visualizar Letra de Hinos","text":"<p>Aprenda sobre a p\u00e1gina de detalhes de um hino.</p>"},{"location":"user-guide/viewing-hymns/#pagina-do-hino","title":"P\u00e1gina do Hino","text":"<p>Quando voc\u00ea clica em um hino, v\u00ea a letra completa formatada.</p>"},{"location":"user-guide/viewing-hymns/#informacoes-do-hino","title":"Informa\u00e7\u00f5es do Hino","text":""},{"location":"user-guide/viewing-hymns/#cabecalho","title":"Cabe\u00e7alho","text":"<p>No topo da p\u00e1gina voc\u00ea encontra:</p> <ul> <li>N\u00famero do hino no hin\u00e1rio</li> <li>T\u00edtulo em destaque</li> <li>Breadcrumb - Link para voltar ao hin\u00e1rio</li> </ul>"},{"location":"user-guide/viewing-hymns/#letra-completa","title":"Letra Completa","text":"<p>A letra \u00e9 exibida preservando a formata\u00e7\u00e3o original:</p> <ul> <li> Quebras de linha originais</li> <li> Estrofes separadas</li> <li> Espa\u00e7amento correto</li> </ul>"},{"location":"user-guide/viewing-hymns/#metadados","title":"Metadados","text":"<p>Quando dispon\u00edveis, voc\u00ea ver\u00e1:</p> Campo Descri\u00e7\u00e3o Estilo Valsa, Marcha, Mazurca, etc. Recebido em Data em que o hino foi recebido Oferecido para Pessoa dedicat\u00e1ria Repeti\u00e7\u00f5es Ex: \"1-4, 5-8\" Instru\u00e7\u00f5es extras Instru\u00e7\u00f5es especiais de canto"},{"location":"user-guide/viewing-hymns/#botoes-sociais","title":"Bot\u00f5es Sociais","text":"<p>Se voc\u00ea estiver logado, ver\u00e1 bot\u00f5es para:</p> <ul> <li> Favoritar - Adiciona aos seus favoritos</li> <li> Comentar - Deixar um coment\u00e1rio</li> </ul> <p>Veja mais em Recursos Sociais.</p>"},{"location":"user-guide/viewing-hymns/#navegacao","title":"Navega\u00e7\u00e3o","text":""},{"location":"user-guide/viewing-hymns/#voltar-ao-hinario","title":"Voltar ao Hin\u00e1rio","text":"<p>Clique no nome do hin\u00e1rio no breadcrumb para voltar \u00e0 lista de hinos.</p>"},{"location":"user-guide/viewing-hymns/#buscar-outro-hino","title":"Buscar Outro Hino","text":"<p>Use a barra de busca no topo para encontrar outro hino.</p>"},{"location":"user-guide/viewing-hymns/#imprimir","title":"Imprimir","text":"<p>Para imprimir a letra de um hino:</p> <ol> <li>Use a fun\u00e7\u00e3o de impress\u00e3o do navegador (++ctrl+p++ ou ++cmd+p++)</li> <li>O portal otimiza a p\u00e1gina para impress\u00e3o</li> </ol> <p>Dica</p> <p>No modo de impress\u00e3o, apenas a letra \u00e9 impressa, sem menus ou bot\u00f5es.</p>"},{"location":"user-guide/viewing-hymns/#compartilhar","title":"Compartilhar","text":"<p>Cada hino tem uma URL \u00fanica que voc\u00ea pode compartilhar:</p> <pre><code>https://portal-hinarios.com.br/hino/uuid-do-hino/\n</code></pre> <p>Copie a URL da barra de endere\u00e7o do navegador para compartilhar.</p>"}]}